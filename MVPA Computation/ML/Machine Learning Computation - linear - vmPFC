{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"0q0cnNSixB9u"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MRb0FZftSf1k"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tKtiW9P0o7fM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Cs4vCXzHXrFL"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from numpy import array\n","import matplotlib.pyplot as plt\n","\n","from sklearn.feature_selection import f_classif, mutual_info_classif, SelectFdr\n","\n","from sklearn.feature_selection import GenericUnivariateSelect\n","from sklearn.svm import LinearSVC, NuSVC\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier \n","\n","from scipy.stats import uniform, randint\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from sklearn.naive_bayes import GaussianNB\n","from sklearn.svm import SVC\n","from sklearn.datasets import load_digits\n","from sklearn.model_selection import learning_curve\n","from sklearn.model_selection import ShuffleSplit\n","from sklearn.model_selection import cross_val_score\n","\n","import xgboost as xgb\n","from sklearn.metrics import auc, accuracy_score, confusion_matrix, mean_squared_error\n","from sklearn.model_selection import cross_val_score, GridSearchCV, KFold, RandomizedSearchCV, train_test_split\n","\n","from warnings import filterwarnings\n","filterwarnings('ignore')\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F9rXqu8pJW8o"},"outputs":[],"source":["\n","def plot_learning_curve(estimator, title, X, y, axes=None, ylim=None, cv=None,\n","                        n_jobs=None, train_sizes=np.linspace(.1, 1.0, 5)):\n","    \"\"\"\n","    Generate 3 plots: the test and training learning curve, the training\n","    samples vs fit times curve, the fit times vs score curve.\n","\n","    Parameters\n","    ----------\n","    estimator : object type that implements the \"fit\" and \"predict\" methods\n","        An object of that type which is cloned for each validation.\n","\n","    title : string\n","        Title for the chart.\n","\n","    X : array-like, shape (n_samples, n_features)\n","        Training vector, where n_samples is the number of samples and\n","        n_features is the number of features.\n","\n","    y : array-like, shape (n_samples) or (n_samples, n_features), optional\n","        Target relative to X for classification or regression;\n","        None for unsupervised learning.\n","\n","    axes : array of 3 axes, optional (default=None)\n","        Axes to use for plotting the curves.\n","\n","    ylim : tuple, shape (ymin, ymax), optional\n","        Defines minimum and maximum yvalues plotted.\n","\n","    cv : int, cross-validation generator or an iterable, optional\n","        Determines the cross-validation splitting strategy.\n","        Possible inputs for cv are:\n","\n","          - None, to use the default 5-fold cross-validation,\n","          - integer, to specify the number of folds.\n","          - :term:`CV splitter`,\n","          - An iterable yielding (train, test) splits as arrays of indices.\n","\n","        For integer/None inputs, if ``y`` is binary or multiclass,\n","        :class:`StratifiedKFold` used. If the estimator is not a classifier\n","        or if ``y`` is neither binary nor multiclass, :class:`KFold` is used.\n","\n","        Refer :ref:`User Guide \u003ccross_validation\u003e` for the various\n","        cross-validators that can be used here.\n","\n","    n_jobs : int or None, optional (default=None)\n","        Number of jobs to run in parallel.\n","        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n","        ``-1`` means using all processors. See :term:`Glossary \u003cn_jobs\u003e`\n","        for more details.\n","\n","    train_sizes : array-like, shape (n_ticks,), dtype float or int\n","        Relative or absolute numbers of training examples that will be used to\n","        generate the learning curve. If the dtype is float, it is regarded as a\n","        fraction of the maximum size of the training set (that is determined\n","        by the selected validation method), i.e. it has to be within (0, 1].\n","        Otherwise it is interpreted as absolute sizes of the training sets.\n","        Note that for classification the number of samples usually have to\n","        be big enough to contain at least one sample from each class.\n","        (default: np.linspace(0.1, 1.0, 5))\n","    \"\"\"\n","    if axes is None:\n","        _, axes = plt.subplots(1, 3, figsize=(20, 5))\n","\n","    axes[0].set_title(title)\n","    if ylim is not None:\n","        axes[0].set_ylim(*ylim)\n","    axes[0].set_xlabel(\"Training examples\")\n","    axes[0].set_ylabel(\"Score\")\n","\n","    train_sizes, train_scores, test_scores, fit_times, _ = \\\n","        learning_curve(estimator, X, y, cv=cv, n_jobs=n_jobs,\n","                       train_sizes=train_sizes,\n","                       return_times=True)\n","    train_scores_mean = np.mean(train_scores, axis=1)\n","    train_scores_std = np.std(train_scores, axis=1)\n","    test_scores_mean = np.mean(test_scores, axis=1)\n","    test_scores_std = np.std(test_scores, axis=1)\n","    fit_times_mean = np.mean(fit_times, axis=1)\n","    fit_times_std = np.std(fit_times, axis=1)\n","\n","    # Plot learning curve\n","    axes[0].grid()\n","    axes[0].fill_between(train_sizes, train_scores_mean - train_scores_std,\n","                         train_scores_mean + train_scores_std, alpha=0.1,\n","                         color=\"r\")\n","    axes[0].fill_between(train_sizes, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1,\n","                         color=\"g\")\n","    axes[0].plot(train_sizes, train_scores_mean, 'o-', color=\"r\",\n","                 label=\"Training score\")\n","    axes[0].plot(train_sizes, test_scores_mean, 'o-', color=\"g\",\n","                 label=\"Cross-validation score\")\n","    axes[0].legend(loc=\"best\")\n","\n","    # Plot n_samples vs fit_times\n","    axes[1].grid()\n","    axes[1].plot(train_sizes, fit_times_mean, 'o-')\n","    axes[1].fill_between(train_sizes, fit_times_mean - fit_times_std,\n","                         fit_times_mean + fit_times_std, alpha=0.1)\n","    axes[1].set_xlabel(\"Training examples\")\n","    axes[1].set_ylabel(\"fit_times\")\n","    axes[1].set_title(\"Scalability of the model\")\n","\n","    # Plot fit_time vs score\n","    axes[2].grid()\n","    axes[2].plot(fit_times_mean, test_scores_mean, 'o-')\n","    axes[2].fill_between(fit_times_mean, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1)\n","    axes[2].set_xlabel(\"fit_times\")\n","    axes[2].set_ylabel(\"Score\")\n","    axes[2].set_title(\"Performance of the model\")\n","\n","    return plt"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0KzSKSrn_INa"},"outputs":[],"source":["def hyper_opt_procedure(model_object,params,cv,perf_df,X,y):\n","\n","\n","  model = model_object()\n","\n","  # Initial Model Fit with stock hyper_params\n","\n","  init_score = np.mean(cross_val_score(model,X,y,cv=cv))\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Stock Params',\n","                              'Score':init_score}, ignore_index=True)\n","\n","  print('Initial Model with Stock Params Score : {}'.format(init_score))\n","\n","  # Random Search Cross Validation\n","\n","\n","  search_model = RandomizedSearchCV(model,\n","                                         param_distributions=params,\n","                                         random_state=42, \n","                                         n_iter=300, \n","                                         cv=cv, \n","                                         verbose=1, \n","                                         n_jobs=1, \n","                                         return_train_score=True)\n","\n","  search_model.fit(X,y)\n","\n","  best_search_model = search_model.best_estimator_\n","\n","  best_search_model_score = search_model.best_score_\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Random HP Search Best Model',\n","                      'Score':best_search_model_score}, ignore_index=True)\n","\n","  rd_score_improv = ((best_search_model_score - init_score)/init_score) * 100\n","\n","  print('Random HP Search Best Model Score : {}'.format(best_search_model_score))\n","\n","  print('Improvement of {}% relative to the initial model'.format(rd_score_improv))\n","  \n","  \n","\n","\n","  return model, best_search_model\n","   \n","\n","\n","\n","class hyper_model:\n","    \n","    def __init__(self,model_name,validation_approach,X,y):\n","        \n","        self.model_name = model_name\n","        self.X = X\n","        self.y = y\n","        self.validation_approach= validation_approach\n","        self.best_model = None\n","        self.best_params = None\n","        self.all_models_perf = pd.DataFrame(None,columns=['Model Iteration','Score'])\n","        self.stock_model = None\n","        self.rd_model = None\n","\n","\n","    def fit(self):\n","\n","\n","      if self.validation_approach == 'leave-one-run-out':\n","\n","        cv = KFold(n_splits=8, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-run-out-shuffled':\n","\n","        cv = KFold(n_splits=8, shuffle=True, random_state=42)\n","\n","      elif self.validation_approach == 'leave-one-task-out':\n","\n","        cv = KFold(n_splits=4, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-task-out-shuffled':\n","\n","        cv = KFold(n_splits=4, shuffle=True, random_state=42)    \n","\n","\n"," \n","        \n","        # Linear SVM\n","\n","      if self.model_name == 'linear_svm':\n","\n","        params = {'C': [0.1, 1, 10, 100, 1000]} \n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=LinearSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","         \n","\n","      # Non Linear SVM\n","\n","\n","      elif self.model_name == 'non_linear_svm':\n","\n","        params = {'nu': [0.01, 0.3, 0.5, 0.7, 1],  \n","                        'gamma': [1, 0.1, 0.01, 0.001, 0.0001], \n","                        'kernel': ['rbf','poly','sigmoid']\n","                       }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=NuSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","          \n","      # Random Forest Classifier\n","\n","\n","      elif self.model_name == 'random_forest_classifier':\n","\n","\n","        params = {'bootstrap': [True, False],\n","                    'max_depth': [50, 60, 70, 80, 90, 100],\n","                    'max_features': ['auto', 'sqrt'],\n","                    'min_samples_leaf': [1, 2, 4],\n","                    'min_samples_split': [2, 5, 10],\n","                    'n_estimators': [1000, 1200, 1400, 1600, 1800, 2000]\n","                   }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=RandomForestClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","          \n","\n","\n","\n","      # XG Boost Classifier\n","\n","\n","      elif self.model_name == 'xg_boost':\n","\n","        params = {\n","              \"colsample_bytree\": uniform(0.7, 0.3),\n","              \"gamma\": uniform(0, 0.5),\n","              \"learning_rate\": uniform(0.03, 0.3), \n","              \"max_depth\": randint(2, 6), \n","              \"n_estimators\": randint(100, 150),\n","              \"subsample\": uniform(0.6, 0.4)\n","              }\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=xgb.XGBClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)  \n","\n","                \n","                "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1923,"status":"ok","timestamp":1606853291838,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hO1Z8nwls9_Y","outputId":"5ae03fd9-463e-46f5-d0b2-2849ee3d4d76"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive/\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive/',force_remount=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":846,"status":"ok","timestamp":1606853300175,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AU6YvpHup87A","outputId":"f5a9a4ea-8af2-46b2-aac3-62febf9458b8"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[0m\u001b[01;34mdrive\u001b[0m/  \u001b[01;34msample_data\u001b[0m/\n"]}],"source":["ls"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":956,"status":"ok","timestamp":1606853301316,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jtOjcM89tPUT","outputId":"4f1c41b7-0047-42af-853d-cbffc76d0389"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CEA\n"]}],"source":["cd drive/MyDrive/CEA/"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1494,"status":"ok","timestamp":1606853321101,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"pOq7fp1q66b_","outputId":"1df27fdb-707d-4bed-ad94-a321a650f7ab"},"outputs":[{"name":"stdout","output_type":"stream","text":["X_pref_fbr_shift_quadratic_full.npy   y_pref_fbr_shift_quadratic_full.npy\n","X_pref_lss_shift_constant_full.npy    y_pref_lss_shift_constant_full.npy\n","X_pref_lss_shift_constant_vmpfc.npy   y_pref_lss_shift_constant_vmpfc.npy\n","X_pref_lss_shift_linear_full.npy      y_pref_lss_shift_linear_full.npy\n","X_pref_lss_shift_linear_vmpfc.npy     y_pref_lss_shift_linear_vmpfc.npy\n","X_pref_lss_shift_quadratic_full.npy   y_pref_lss_shift_quadratic_full.npy\n","X_pref_lss_shift_quadratic_vmpfc.npy  y_pref_lss_shift_quadratic_vmpfc.npy\n"]}],"source":["ls data/"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mK0bYtMjvknM"},"outputs":[],"source":["X = np.load('data/X_pref_lss_shift_linear_vmpfc.npy')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":659,"status":"ok","timestamp":1606853363194,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uqbxJx6gxbey","outputId":"5ccfa958-1554-4c7e-f91f-ea8003bf0bbd"},"outputs":[{"data":{"text/plain":["(480, 3)"]},"execution_count":13,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Iojp3abFv1W0"},"outputs":[],"source":["y = np.load('data/y_pref_lss_shift_linear_vmpfc.npy')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":993,"status":"ok","timestamp":1606853388647,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HRfd5YRExl6M","outputId":"ee8316f1-7fdc-44ae-a7d5-7a8e8470de84"},"outputs":[{"data":{"text/plain":["(480, 1)"]},"execution_count":15,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["y.shape"]},{"cell_type":"markdown","metadata":{"id":"-eDis182XeSE"},"source":["## Features Selection"]},{"cell_type":"markdown","metadata":{"id":"G7d7JTJmXgwj"},"source":["### Filter"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Kexq1fnyXkRY"},"outputs":[],"source":["transformer = GenericUnivariateSelect(mutual_info_classif, mode='k_best', param=3)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FAZkKRmhXnPo"},"outputs":[],"source":["X_trans = transformer.fit_transform(X, y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6024,"status":"ok","timestamp":1606853974986,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BKKN66taXoz0","outputId":"25751734-06bd-4022-8172-d91a98f70541"},"outputs":[{"data":{"text/plain":["(480, 3)"]},"execution_count":18,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X_trans.shape"]},{"cell_type":"markdown","metadata":{"id":"cC_RDtVZYwG0"},"source":["### Data Preparation"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8OmeM2TuYzDd"},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10, random_state=42)"]},{"cell_type":"markdown","metadata":{"id":"3rxGDdS1Y2A6"},"source":["## Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"3e6kNyHGxE_w"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"oK0OX_9xnzWv"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"P0slq_QtT_P1"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"url-dxiyoJsT"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11963,"status":"ok","timestamp":1606854493929,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"MATeUxpJo9DC","outputId":"1ca05971-c8f4-490c-f508-be86d1a5e77a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4166666666666667\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55625\n","Improvement of 33.5% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    0.5s finished\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":11899,"status":"ok","timestamp":1606854493929,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-LuUfzJYuZ5c","outputId":"c2e0d7c3-0355-4ec6-d829-8c9a20b5ef59"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":25,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hlwfN3l9XDr-"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"WnDMByUhXMfO"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"obSzi-BEXMfO"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12415,"status":"ok","timestamp":1606854494479,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aPPDOaCxXMfO","outputId":"d41c41b6-86f7-489c-9ab8-631980c69a27"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":27,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12405,"status":"ok","timestamp":1606854494480,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9l85G4epXMfO","outputId":"a7fc0766-1437-41bf-99eb-b2720d6ec552"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":28,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nZiTeY6mXMfO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12382,"status":"ok","timestamp":1606854494480,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Imp-qfZeXMfO","outputId":"ccd94522-780f-4d94-f467-2d5571cd7ab6"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.49166667, 0.525     , 0.53333333])"]},"execution_count":30,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12372,"status":"ok","timestamp":1606854494481,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y6HNpYl_XMfO","outputId":"b6006e5c-420a-437d-d915-430752dbf674"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":31,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"osKpbfvyXMfO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w2SlhLffXMfO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13303,"status":"ok","timestamp":1606854495447,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FqjIqTD1XMfO","outputId":"7f50f4c1-b381-4be4-926e-f5fdd0cbff68"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":33,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13292,"status":"ok","timestamp":1606854495448,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yZVtOibiXMfO","outputId":"870459ee-468c-419c-ad91-d66539d21ed5"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":34,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oajU1LQ3XMfP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13265,"status":"ok","timestamp":1606854495449,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ADNditLZXMfP","outputId":"4ff145ce-ddeb-4e49-b13f-f3ccb763ac62"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.45      , 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":36,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13253,"status":"ok","timestamp":1606854495450,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"goo-B_3cXMfP","outputId":"953d6150-ffab-49f7-c03b-cababc0266e9"},"outputs":[{"data":{"text/plain":["0.5416666666666666"]},"execution_count":37,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"P-5MwWHhXMfP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Gb-Qqwn8oJ7d"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"R4mMDLPsWAmE"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Cee0jzzPIFx"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13218,"status":"ok","timestamp":1606854495451,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JGJS_yz6PIFy","outputId":"2b688da2-e1a5-4493-c37e-0381e008ae03"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5166666666666666\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5291666666666667\n","Improvement of 2.4193548387096904% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    0.3s finished\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":13207,"status":"ok","timestamp":1606854495452,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JAf3le69PIFy","outputId":"091c10c7-140a-4a7e-f74b-152e205c2f46"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":41,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WIsSLawaoR-_"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"CMPrOUDoWFWr"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Vd_umY9HWFWr"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13169,"status":"ok","timestamp":1606854495453,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tpxUGequWFWr","outputId":"961bbaa1-c78c-4e84-f347-394a0da756b9"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":43,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13157,"status":"ok","timestamp":1606854495454,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LCzQufNtWFWr","outputId":"32444bf4-2099-4c28-8fe2-aef4a5173d23"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":44,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pSmKo3hZWFWr"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13910,"status":"ok","timestamp":1606854496235,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7hn8vbGCWFWr","outputId":"f15635a1-0786-4bab-f4f1-91368429de9c"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.49166667, 0.525     , 0.53333333])"]},"execution_count":46,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13899,"status":"ok","timestamp":1606854496236,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PxVtKHfUWFWr","outputId":"20686a0e-5871-42dd-a975-ce39980edc24"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":47,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ChZvGrkeWFWr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3uCFUnE0WFWr"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13860,"status":"ok","timestamp":1606854496237,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8CGhPtsfWFWr","outputId":"bdcab165-39f7-42ed-b199-3218019c7ba9"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":49,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13848,"status":"ok","timestamp":1606854496237,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"D0iWmziUWFWr","outputId":"45b760c9-6a5f-4037-dad2-9f02dac7c0de"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":50,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xdhCavSlWFWr"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13825,"status":"ok","timestamp":1606854496238,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1JmYYZIwWFWr","outputId":"75784cb8-8cc3-44d4-f60e-a3619d47299a"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.43333333, 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":52,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13815,"status":"ok","timestamp":1606854496240,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9JDZ-36UWFWr","outputId":"0d079d04-868f-4060-def0-b15be9902b62"},"outputs":[{"data":{"text/plain":["0.5395833333333333"]},"execution_count":53,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nbRpu_f0WFWr"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"yk1VAnOFoSCu"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qK7ud6-dWV9T"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BjBXz_jRPPJO"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14726,"status":"ok","timestamp":1606854497187,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CnbTertnPPJO","outputId":"c8b0428a-3209-41db-98bb-e89917846099"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.55\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 0.0% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:    0.8s finished\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":14715,"status":"ok","timestamp":1606854497188,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sHMdRLUsPPJP","outputId":"8281fa60-ec42-4b05-b892-0c5574e029a7"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":57,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VhkTeBlsoSGf"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ffRmE2HzXfw2"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xjJzKwpEXfw2"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14673,"status":"ok","timestamp":1606854497189,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FfqjXtzaXfw2","outputId":"68ddbe4d-02d6-4efb-8a97-532de3d124dc"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":59,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14662,"status":"ok","timestamp":1606854497190,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XCi4tf0uXfw2","outputId":"96d46a2f-7fd8-4569-c379-30c8b7ac92b9"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":60,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f4rrkYJUXfw2"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14638,"status":"ok","timestamp":1606854497191,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ldUaBM8oXfw2","outputId":"e31925c2-a7fb-4853-dd70-aafecf272ce4"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.49166667, 0.525     , 0.53333333])"]},"execution_count":62,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14594,"status":"ok","timestamp":1606854497191,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kiw1b1y8Xfw2","outputId":"542bcdf3-7f18-4c28-cdff-7729e5f608f5"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":63,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bNAQZX5ZXfw2"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RYc1l8DXXfw2"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15130,"status":"ok","timestamp":1606854497795,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"69s38be1Xfw2","outputId":"339b5ec0-f9df-4543-dbf0-96aa90f933ae"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":65,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15094,"status":"ok","timestamp":1606854497795,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"nVk4MjlQXfw2","outputId":"2d11ac63-6da8-42f3-9fa9-dc3f84ad1950"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":66,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"88KOXS3VXfw2"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15056,"status":"ok","timestamp":1606854497796,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"bImXksWpXfw2","outputId":"63ba7a3f-a1c3-4020-ad28-6fb4e82b95f2"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.43333333, 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":68,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15041,"status":"ok","timestamp":1606854497796,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QWbqk81KXfw2","outputId":"babc4504-cbaf-4cae-e682-86fa4c159901"},"outputs":[{"data":{"text/plain":["0.5395833333333333"]},"execution_count":69,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gvhldUdEXfw2"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ryKXIhosWkY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LuqDNEUVXem2"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8Z7a-FGHoSKO"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Wjkj4swhXhgq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eWJfI5YnPPzE"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15721,"status":"ok","timestamp":1606854498540,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-QFW2J0HPPzE","outputId":"541d6c1f-62f5-4958-fbce-80c4c887d016"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5395833333333333\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5416666666666667\n","Improvement of 0.3861003861004053% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:    0.8s finished\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":15710,"status":"ok","timestamp":1606854498541,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Diwlgrr6PPzE","outputId":"8f0302fb-ebe1-4be2-9919-e6cea9d34a9e"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":73,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p_zezBW2SWjz"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"rjvf3p9eXkKN"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Nic0nOPtXkKN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16246,"status":"ok","timestamp":1606854499113,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"J-OqyJx4XkKO","outputId":"70060ffa-713a-4306-bbbf-dc25a518c406"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":75,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16228,"status":"ok","timestamp":1606854499113,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"I2V919yeXkKO","outputId":"182c45ed-1fae-4ca0-aaf4-3e188db9aaab"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":76,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CQo-9ubKXkKO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16197,"status":"ok","timestamp":1606854499114,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YTzKNz4rXkKO","outputId":"b87221a3-2210-470c-ff0f-b52e2d1920d2"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.49166667, 0.525     , 0.53333333])"]},"execution_count":78,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16180,"status":"ok","timestamp":1606854499115,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"2GWAFm_6XkKO","outputId":"ae172d96-0d8f-41b3-e616-637d70ab3099"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":79,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-c5IHn17XkKO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Okf-45vIXkKO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16134,"status":"ok","timestamp":1606854499116,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HfQ03o7aXkKO","outputId":"d4921108-61a7-41ea-e772-5c97f026c544"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":81,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16672,"status":"ok","timestamp":1606854499668,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5XRG6jEEXkKO","outputId":"62ed4d80-49af-4c7b-feb8-f787bdd92c86"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":82,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7-0CnEaYXkKO"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16646,"status":"ok","timestamp":1606854499669,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-0quuBcgXkKO","outputId":"d12d7e5e-cf86-4890-fee6-b2f42152880c"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.43333333, 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":84,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16623,"status":"ok","timestamp":1606854499670,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"X16n6fn-XkKO","outputId":"4bcaf3c9-9226-430f-c418-b56c6391dcca"},"outputs":[{"data":{"text/plain":["0.5395833333333333"]},"execution_count":85,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UDRY8j-5XkKO"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Lja4q_wLTg0R"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"stZ6DO2sThIc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"TTW32YjnxcFK"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"mvKVuHmJxcFL"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"JYV5csm3xcFL"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OzOIKjnrxcFL"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17105,"status":"ok","timestamp":1606854500221,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ugzTVwdBxcFL","outputId":"dc03fb31-76e7-4241-80f5-ce472ab373d7"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4166666666666667\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.4791666666666667\n","Improvement of 15.0% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    0.3s finished\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":17093,"status":"ok","timestamp":1606854500222,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BcoF6XGAxcFL","outputId":"7a0eab9e-30d9-4d27-da74-935d4c680fea"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":89,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gz3DAOnAxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"MU1PmbLuxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R_IY4nR0xcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17056,"status":"ok","timestamp":1606854500223,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LXgqGhMMxcFM","outputId":"d6ffe107-bff5-4979-e901-66f0f5a89134"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.36666667, 0.51666667, 0.35833333])"]},"execution_count":91,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17045,"status":"ok","timestamp":1606854500224,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cQSax0c_xcFM","outputId":"c9eb070c-d153-40e9-9619-e293dff0178e"},"outputs":[{"data":{"text/plain":["0.44791666666666674"]},"execution_count":92,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B6QFFuZoxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17022,"status":"ok","timestamp":1606854500225,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jpdF-f29xcFM","outputId":"01964b3b-d697-411c-a23d-2404c83ac923"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.44166667, 0.46666667, 0.53333333])"]},"execution_count":94,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17008,"status":"ok","timestamp":1606854500225,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tWt6NvLnxcFM","outputId":"e8b384ef-b8b9-4d33-df3d-ccb4e221e2a9"},"outputs":[{"data":{"text/plain":["0.47916666666666663"]},"execution_count":95,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mrvkWQG2xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f6ono8bWxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17630,"status":"ok","timestamp":1606854500882,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"opbGpr4qxcFM","outputId":"54021d5a-984a-4a98-d84f-5d1770b33f9d"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.55      , 0.36666667, 0.38333333, 0.51666667,\n","       0.51666667, 0.46666667, 0.55      ])"]},"execution_count":97,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17617,"status":"ok","timestamp":1606854500882,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"K1ZpmNBAxcFM","outputId":"0278b9e8-9a59-4cf8-9427-3993ef8027b0"},"outputs":[{"data":{"text/plain":["0.4770833333333333"]},"execution_count":98,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jm7mkIIdxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17594,"status":"ok","timestamp":1606854500883,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"pvspMz5zxcFM","outputId":"9db7de42-352a-4cdc-8b58-6a96f5ffcca6"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.46666667, 0.38333333, 0.53333333, 0.51666667,\n","       0.48333333, 0.5       , 0.63333333])"]},"execution_count":100,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17583,"status":"ok","timestamp":1606854500884,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xBjz_G5TxcFM","outputId":"a216988d-25dd-420d-c8ad-e3acad177446"},"outputs":[{"data":{"text/plain":["0.5"]},"execution_count":101,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dC9pWR3WxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"XedkRZHwxcFM"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"9HiVDnozxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uwuuHEYlxcFM"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18144,"status":"ok","timestamp":1606854501482,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"l-XinugXxcFM","outputId":"4bcd1bc0-ecd3-41b7-bbb0-9beae2797e25"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5208333333333333\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.525\n","Improvement of 0.8000000000000186% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    0.4s finished\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":18131,"status":"ok","timestamp":1606854501482,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7tvjFgLoxcFM","outputId":"8e543111-44af-4813-e626-a71bf4d04df8"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":105,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EbZRWXTwxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qEfs8n21xcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QGT0CuzPxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18081,"status":"ok","timestamp":1606854501484,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"O65IF5P6xcFM","outputId":"09760dfa-6b88-4b85-f013-81ca17d8ed16"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":107,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18067,"status":"ok","timestamp":1606854501484,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"g135jDm3xcFM","outputId":"bbd15341-c0af-461c-e3ee-882af5e5362d"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":108,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"U4ZzCpkwxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18041,"status":"ok","timestamp":1606854501485,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ghEGnajnxcFM","outputId":"6cd3bd07-dc4d-439b-b17d-b98edf0cf9c6"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.5       , 0.55      , 0.53333333])"]},"execution_count":110,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":18030,"status":"ok","timestamp":1606854501486,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1dQIJEXixcFM","outputId":"37c2509b-7a82-4cf0-cca0-a8b7db4a5e30"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":111,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Bx9r41ixcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_PSdLsDqxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17990,"status":"ok","timestamp":1606854501487,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"r1C0gBd-xcFM","outputId":"bbcfcbce-0d62-4599-e260-704f1381c655"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":113,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17976,"status":"ok","timestamp":1606854501487,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sd_600a3xcFM","outputId":"617e7c7c-cb13-4ce2-9b33-afea3eebd8fa"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":114,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NTsPzbnSxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17951,"status":"ok","timestamp":1606854501488,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jb5RMb-pxcFM","outputId":"dcc3eb73-e24c-4cb1-9f5c-a08c9d38d1a9"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.45      , 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":116,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17937,"status":"ok","timestamp":1606854501489,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sdOno854xcFM","outputId":"d16e2729-29ec-446e-ee20-5ccc2fa96e98"},"outputs":[{"data":{"text/plain":["0.5416666666666666"]},"execution_count":117,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"awfIV9pZxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"3Km95QOvxcFM"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"4HGGgdeIxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oaYNByAsxcFM"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19242,"status":"ok","timestamp":1606854502832,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"G63hlZ4kxcFM","outputId":"6d38556a-ae18-4e69-cf47-0df26061cfc7"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.55\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 0.0% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:    0.8s finished\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":19230,"status":"ok","timestamp":1606854502833,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PpMulicsxcFM","outputId":"9ec3b20e-ab9e-453e-d109-7ef68522fbf4"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":121,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gtkUY73bxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"4ad7FRzfxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5Pi0us0CxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19194,"status":"ok","timestamp":1606854502837,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"P2ReLTMmxcFM","outputId":"a86ec00a-94db-4ba5-d8c4-d29f5e4540cf"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":123,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19182,"status":"ok","timestamp":1606854502837,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zQe_P4vtxcFM","outputId":"98dc1404-6518-4384-cb0b-10b896db30e7"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":124,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-fLvGqsBxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19159,"status":"ok","timestamp":1606854502839,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vH6BJYeCxcFM","outputId":"237799ef-e243-4463-b2df-47b06f988df0"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.5       , 0.55      , 0.53333333])"]},"execution_count":126,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19148,"status":"ok","timestamp":1606854502840,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"iWKygSBFxcFM","outputId":"26f13696-b91c-4683-d228-9afff600101d"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":127,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H89-Ubk1xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jystqc68xcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19111,"status":"ok","timestamp":1606854502843,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"me7J6W3jxcFM","outputId":"bc61996a-3fe0-4e96-9058-a78c4919d78e"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":129,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19096,"status":"ok","timestamp":1606854502843,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"b4GFz5MExcFM","outputId":"47cd8215-db4c-4927-a8d8-4cb10a91473e"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":130,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xuQVuhiQxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19984,"status":"ok","timestamp":1606854503754,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"laTiM7yyxcFM","outputId":"44a8fd29-8832-46f9-ee05-918461c1f61c"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.45      , 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":132,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19972,"status":"ok","timestamp":1606854503754,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5YEpQA8MxcFM","outputId":"1167c452-ed5b-4950-842d-d96e65743b23"},"outputs":[{"data":{"text/plain":["0.5416666666666666"]},"execution_count":133,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e9j2dV-0xcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"In9JIEELxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QBdhZ-WaxcFN"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"M_bDhah3xcFN"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"SB0mgXXvxcFN"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BqKnbg_JxcFN"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21258,"status":"ok","timestamp":1606854505104,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DdLP80jqxcFN","outputId":"f273fe1f-e085-4a1e-9f81-980ecd5e2740"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.54375\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5416666666666666\n","Improvement of -0.38314176245210596% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:    0.8s finished\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":21246,"status":"ok","timestamp":1606854505105,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"O-pGzTR8xcFN","outputId":"d88d36f0-ac68-4ec8-9cac-3cd40834b719"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":137,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mm_UBr-JxcFN"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"37SLrvJMxcFN"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UOiflGaYxcFN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21206,"status":"ok","timestamp":1606854505106,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uSGfcU8QxcFN","outputId":"91cdbe2f-802b-454f-86a3-e5320818531e"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":139,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21193,"status":"ok","timestamp":1606854505107,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xoi4Bd7NxcFN","outputId":"d9cbda7f-351c-43dc-810c-52649b54b75b"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":140,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wNJLv2rYxcFN"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21168,"status":"ok","timestamp":1606854505108,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"V7rgWJWOxcFN","outputId":"49f00077-7903-44fe-c9c7-1d9219ca7d58"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.5       , 0.55      , 0.53333333])"]},"execution_count":142,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21156,"status":"ok","timestamp":1606854505109,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VDh6BucmxcFN","outputId":"7849cbf9-8cc5-4ce0-d356-6d396f74a49e"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":143,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HUaF3tqAxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EuutIIFXxcFN"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21121,"status":"ok","timestamp":1606854505110,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RAi3g167xcFN","outputId":"4d8df71f-7501-4a88-a7b7-13d53747958d"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":145,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21109,"status":"ok","timestamp":1606854505110,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"qRf2KlHuxcFN","outputId":"ea590dec-83fc-4856-9daf-d7237a28ee38"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":146,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vc_-n4csxcFN"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21085,"status":"ok","timestamp":1606854505111,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Jln-g212xcFN","outputId":"41b0274a-ef73-4d07-aa45-c65078419003"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.45      , 0.56666667, 0.63333333,\n","       0.58333333, 0.53333333, 0.53333333])"]},"execution_count":148,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21073,"status":"ok","timestamp":1606854505112,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tlOVYKDCxcFN","outputId":"26d23b48-b9e8-4235-b2fb-551f5ad9e865"},"outputs":[{"data":{"text/plain":["0.5416666666666666"]},"execution_count":149,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VIaGLGWLxcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"i80BGb95xcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eo8YKpR5ThY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oqugS205TiTt"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qeEgWCblzQnP"},"source":["## Non Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"5GSv6mzky38n"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"7oULTVbEPi_U"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"0Cne7taDXqB-"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dq07br9mPi_U"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189966,"status":"ok","timestamp":1606854674079,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1V8keujMPi_U","outputId":"69abef0d-9479-4083-ab73-e2789d423f73"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5479166666666666\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.6166666666666667\n","Improvement of 12.547528517110285% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  2.8min finished\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":189958,"status":"ok","timestamp":1606854674085,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0gD5AkJMPi_U","outputId":"6fefee3e-f8f0-440e-fead-af7b5fc674c3"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":153,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XxxGNCDDPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"R-4wu13DXt7S"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2zxO36oNXt7S"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189919,"status":"ok","timestamp":1606854674091,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fsWhol8YXt7S","outputId":"863d91b5-b61a-451b-fa1a-7cb005273e25"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.6       , 0.50833333, 0.55833333])"]},"execution_count":155,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189907,"status":"ok","timestamp":1606854674092,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ymPirDLmXt7S","outputId":"b026750c-4ea1-4b7b-8240-389fe2fac052"},"outputs":[{"data":{"text/plain":["0.5479166666666666"]},"execution_count":156,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"T0ta4ssHXt7S"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189883,"status":"ok","timestamp":1606854674094,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1RjKwn0pXt7S","outputId":"a4dcca4c-1e95-4fa9-8bbd-34aeface9058"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.51666667, 0.55833333, 0.525     ])"]},"execution_count":158,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189872,"status":"ok","timestamp":1606854674095,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CIBOvXeDXt7S","outputId":"3ebc9888-4d2e-4f02-e286-4defb5a2d582"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":159,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1aTV6PZfXt7S"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NNnTNmeiXt7S"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189837,"status":"ok","timestamp":1606854674098,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XPMCwPjQXt7S","outputId":"86ef02c5-c4bc-4924-876b-150596251cf4"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.46666667, 0.56666667, 0.41666667, 0.41666667,\n","       0.46666667, 0.56666667, 0.45      ])"]},"execution_count":161,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":189826,"status":"ok","timestamp":1606854674099,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DRVwsyQLXt7S","outputId":"32b7dd03-357b-4a93-8fef-526547bdcdae"},"outputs":[{"data":{"text/plain":["0.48333333333333334"]},"execution_count":162,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vinSE87gXt7S"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":190578,"status":"ok","timestamp":1606854674875,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xOuNRJLdXt7S","outputId":"1e49fe41-94f0-4b37-f011-6979d7645b03"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.58333333, 0.43333333, 0.46666667,\n","       0.55      , 0.58333333, 0.63333333])"]},"execution_count":164,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":190565,"status":"ok","timestamp":1606854674875,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"d4xnl7FcXt7S","outputId":"dcc8a28b-4e53-4740-c516-309b415bba38"},"outputs":[{"data":{"text/plain":["0.5375"]},"execution_count":165,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eFy5EJT0Xt7S"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l0KvHb0QXogu"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0Zs6BKtdPi_U"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"8EAYpz-HXvUg"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CL0ybWLcPi_U"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":387071,"status":"ok","timestamp":1606854871430,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IktxzifQPi_U","outputId":"21ce14c7-6922-4b57-a4a6-eb8daeed2653"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.51875\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5666666666666667\n","Improvement of 9.236947791164646% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  3.3min finished\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":387060,"status":"ok","timestamp":1606854871431,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_P-nox5XPi_U","outputId":"f38995c8-836b-4640-a691-a95372001e74"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":169,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tWvOHDWQPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0198Uz5fXzwU"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RyahliyLXzwU"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":387028,"status":"ok","timestamp":1606854871437,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zehjkRXnXzwU","outputId":"154a9e98-d5ba-4bac-84b3-ad3ef4136cf3"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.6       , 0.50833333, 0.55833333])"]},"execution_count":171,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":387016,"status":"ok","timestamp":1606854871438,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WuJ2osi6XzwU","outputId":"dd12745c-b78c-4592-c72d-642e7be7c300"},"outputs":[{"data":{"text/plain":["0.5479166666666666"]},"execution_count":172,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ci44W-T2XzwU"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":386994,"status":"ok","timestamp":1606854871442,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vK4IjAABXzwU","outputId":"f8556ea4-8df0-41f9-de7d-ce8e700326e8"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.51666667, 0.55833333, 0.525     ])"]},"execution_count":174,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":386981,"status":"ok","timestamp":1606854871443,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xhWy-ohdXzwU","outputId":"429471c6-9384-4712-b658-985748781fc9"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":175,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CF7JcIMjXzwU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2oIQ_WXQXzwU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":388290,"status":"ok","timestamp":1606854872792,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"UzV889JxXzwU","outputId":"4c0b9dbb-8b91-45f3-f76d-dfd439659e2d"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.46666667, 0.56666667, 0.41666667, 0.41666667,\n","       0.46666667, 0.56666667, 0.45      ])"]},"execution_count":177,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":388278,"status":"ok","timestamp":1606854872792,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yL2hPRGYXzwU","outputId":"ed42f869-97b6-4539-e14f-cf1d6415f900"},"outputs":[{"data":{"text/plain":["0.48333333333333334"]},"execution_count":178,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-66NgtuSXzwU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":388254,"status":"ok","timestamp":1606854872793,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WuB0T_n2XzwU","outputId":"25ac6c7d-6fae-4c79-c854-bdadc5401b4c"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.58333333, 0.43333333, 0.46666667,\n","       0.55      , 0.58333333, 0.63333333])"]},"execution_count":180,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":388242,"status":"ok","timestamp":1606854872794,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tKTaDJrDXzwU","outputId":"1e69724b-5020-4173-dc7b-5888419c4136"},"outputs":[{"data":{"text/plain":["0.5375"]},"execution_count":181,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cn3af9g-XzwU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uDs9TYKhPi_U"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"egAIdkvWX28i"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TC4Zs4C_Pi_U"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1242009,"status":"ok","timestamp":1606855726597,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yYH5CASnPi_U","outputId":"f898a20d-a093-4179-cf54-365f896e631d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48333333333333334\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5770833333333334\n","Improvement of 19.396551724137943% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed: 14.2min finished\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1241997,"status":"ok","timestamp":1606855726598,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Gew_wB7pPi_U","outputId":"4e9f532b-e1e0-4ce7-9870-b8bab5157e6d"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":185,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"unaQIpFcPi_V"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"nwAyHju5X6vP"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZPOKqFjRX6vP"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1241955,"status":"ok","timestamp":1606855726600,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fupMQc6EX6vP","outputId":"4554c336-3f9d-4214-ce2f-c59e11f16451"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.6       , 0.50833333, 0.55833333])"]},"execution_count":187,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1241944,"status":"ok","timestamp":1606855726602,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"M1CThpvVX6vP","outputId":"25a73515-bd1b-486b-936d-92652bac84c1"},"outputs":[{"data":{"text/plain":["0.5479166666666666"]},"execution_count":188,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9_gWEv7sX6vP"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1241920,"status":"ok","timestamp":1606855726603,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fiy7W5ffX6vP","outputId":"149e0371-4c08-415b-d6ee-d661935964dd"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.51666667, 0.55833333, 0.525     ])"]},"execution_count":190,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1241909,"status":"ok","timestamp":1606855726604,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"lkjknhMeX6vP","outputId":"d2e1791f-3b74-4de9-e6df-16eca4904d17"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":191,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FTXiBdQLX6vP"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"t1r-sdlxX6vP"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1242203,"status":"ok","timestamp":1606855726935,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CWGMzyK-X6vP","outputId":"1c58fb9d-c9b2-446f-cbfe-ebda0649a951"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.46666667, 0.56666667, 0.41666667, 0.41666667,\n","       0.46666667, 0.56666667, 0.45      ])"]},"execution_count":193,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1242192,"status":"ok","timestamp":1606855726936,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"H0zLw18oX6vP","outputId":"5fca6d0d-e048-4978-b5d2-d144f9352e8b"},"outputs":[{"data":{"text/plain":["0.48333333333333334"]},"execution_count":194,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A8T5rsMmX6vP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1242479,"status":"ok","timestamp":1606855727248,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"M_t4UF1DX6vP","outputId":"6091052f-c000-4def-b852-2b0515ee95fe"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.58333333, 0.43333333, 0.46666667,\n","       0.55      , 0.58333333, 0.63333333])"]},"execution_count":196,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1242467,"status":"ok","timestamp":1606855727249,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0fJTTwT7X6vP","outputId":"4ee692a1-704a-4f14-b919-22f0a220d212"},"outputs":[{"data":{"text/plain":["0.5375"]},"execution_count":197,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1jmvoITgX6vP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"9GrSc9C_Pi_V"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"kD81hURuX8Gq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VvTPL3JlPi_V"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624865,"status":"ok","timestamp":1606856109691,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VrRmVRDrPi_V","outputId":"eba36c97-0733-4685-8cff-0018b442ff65"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5375\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5645833333333333\n","Improvement of 5.038759689922483% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  6.4min finished\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1624855,"status":"ok","timestamp":1606856109694,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"T_4U6bROPi_V","outputId":"022bc892-359c-4bbc-c887-580344d91619"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":201,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jvvT0I2zA-tR"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"NBFCHmpSX_fT"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FpOCGtljX_fT"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624820,"status":"ok","timestamp":1606856109696,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7Qyp61qCX_fT","outputId":"379fef37-987a-4a53-f157-28a16e9b34fd"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.6       , 0.50833333, 0.55833333])"]},"execution_count":203,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624809,"status":"ok","timestamp":1606856109697,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aIXn6G0DX_fT","outputId":"8b4c1e60-ece1-4a97-9739-f0d47cfd49f9"},"outputs":[{"data":{"text/plain":["0.5479166666666666"]},"execution_count":204,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Cd88yjZ2X_fT"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624786,"status":"ok","timestamp":1606856109701,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TBGK1CCwX_fT","outputId":"4774d93d-7e0f-407f-dbb4-0912c40acffe"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.51666667, 0.55833333, 0.525     ])"]},"execution_count":206,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624774,"status":"ok","timestamp":1606856109702,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YrWrvhkgX_fT","outputId":"c6c32c5c-3417-4174-bc6e-6dd2850c6b79"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":207,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AxSU-XfPX_fU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AmBIkKpYX_fU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624739,"status":"ok","timestamp":1606856109705,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_V5IbN68X_fU","outputId":"68f61b69-2f7f-49e4-914e-fcdea967036c"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.46666667, 0.56666667, 0.41666667, 0.41666667,\n","       0.46666667, 0.56666667, 0.45      ])"]},"execution_count":209,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624730,"status":"ok","timestamp":1606856109708,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TWaCN8l7X_fU","outputId":"b2ad8e54-3f2f-4344-f5bc-ca841ce0a71c"},"outputs":[{"data":{"text/plain":["0.48333333333333334"]},"execution_count":210,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"syrzAL9rX_fU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624707,"status":"ok","timestamp":1606856109710,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"NsiBn2glX_fU","outputId":"1ba7c46c-4125-48e0-ac59-b00a4c5a1904"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.58333333, 0.43333333, 0.46666667,\n","       0.55      , 0.58333333, 0.63333333])"]},"execution_count":212,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1624696,"status":"ok","timestamp":1606856109711,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LtMnsPToX_fU","outputId":"b706a147-acdd-4e1f-a10c-cb45ae947021"},"outputs":[{"data":{"text/plain":["0.5375"]},"execution_count":213,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0DqFlfKnX_fU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"8XqHy9Y-zFbi"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"7JuJVcluzKap"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"nDanBmu2zKap"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"vXdh3OxCzKap"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pMbR3zyvzKap"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793176,"status":"ok","timestamp":1606856278228,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RQK687eXzKap","outputId":"78585ab5-15a3-447f-e75c-028f48b3e3ac"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5479166666666666\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.6166666666666667\n","Improvement of 12.547528517110285% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  2.8min finished\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1793165,"status":"ok","timestamp":1606856278229,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1GyuhQOqzKap","outputId":"cb14447a-ae59-439a-ce81-2c2ec644fe6d"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":217,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hsydl9nEzKap"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"dZufsYMWzKap"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gYJcPYkvzKap"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793129,"status":"ok","timestamp":1606856278231,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zwggFtqFzKap","outputId":"47c95215-93a3-4a77-9b04-d1e5b3004388"},"outputs":[{"data":{"text/plain":["array([0.59166667, 0.65833333, 0.55      , 0.66666667])"]},"execution_count":219,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793120,"status":"ok","timestamp":1606856278234,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"170biW6UzKap","outputId":"06116c72-b619-464e-d514-cabeeb8065ac"},"outputs":[{"data":{"text/plain":["0.6166666666666667"]},"execution_count":220,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BuJajI8CzKap"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793095,"status":"ok","timestamp":1606856278235,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y9sBxOW3zKap","outputId":"0c56690f-2a7f-4ff7-8636-3f037729064a"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.5       , 0.525     , 0.56666667])"]},"execution_count":222,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793084,"status":"ok","timestamp":1606856278236,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Tu78PjDEzKap","outputId":"08fb117a-c66d-4e28-d35f-84d6317598ea"},"outputs":[{"data":{"text/plain":["0.5333333333333332"]},"execution_count":223,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p5O7LCZUzKaq"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"170jqf1TzKaq"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793048,"status":"ok","timestamp":1606856278238,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"4TBwzEPazKaq","outputId":"c0b5d499-324a-4fda-be53-9dcbc5f650e5"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.53333333, 0.65      , 0.46666667, 0.5       ,\n","       0.48333333, 0.66666667, 0.61666667])"]},"execution_count":225,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793036,"status":"ok","timestamp":1606856278239,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AHSEfnC1zKaq","outputId":"7c78e5ed-85cd-4c92-f0c7-b139929aa7ff"},"outputs":[{"data":{"text/plain":["0.54375"]},"execution_count":226,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ObGDJizAzKaq"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1793011,"status":"ok","timestamp":1606856278240,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"j_N2tqWwzKaq","outputId":"b197c4e5-756c-4a28-d3e0-ca5a0a2c4e70"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.46666667, 0.4       , 0.48333333, 0.53333333,\n","       0.35      , 0.51666667, 0.53333333])"]},"execution_count":228,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1792999,"status":"ok","timestamp":1606856278240,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IASR2chPzKaq","outputId":"0d53562b-b14c-490a-a542-f8468a2e0abe"},"outputs":[{"data":{"text/plain":["0.475"]},"execution_count":229,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DgeJt--bzKaq"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TD-U3cR1zKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ARh3tG3HzKaq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"wN2hsHGBzKaq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"skUAhYgczKaq"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1990620,"status":"ok","timestamp":1606856475912,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cwJeDc5FzKaq","outputId":"faa27b55-2a7e-4d50-af03-e56495052be3"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.51875\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5666666666666667\n","Improvement of 9.236947791164646% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  3.3min finished\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1990606,"status":"ok","timestamp":1606856475913,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7T6L3cEMzKaq","outputId":"19a5638e-e6e7-44e4-a6a8-d24b10ed0ca5"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":233,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s-0TYEKRzKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Q-8Wu0mFzKaq"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1JuAwv7xzKar"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1990570,"status":"ok","timestamp":1606856475915,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"3vVCBJB-zKar","outputId":"ce66148b-2f4c-44a5-9b5f-8bed09b51182"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.54166667, 0.53333333, 0.51666667])"]},"execution_count":235,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1990558,"status":"ok","timestamp":1606856475915,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VMeANNU5zKar","outputId":"ba294ff8-ed3e-422b-a1f8-1191992e8f19"},"outputs":[{"data":{"text/plain":["0.5229166666666666"]},"execution_count":236,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S1WpU5CMzKar"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7232,"status":"ok","timestamp":1606856732443,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5TeGAl1HzKar","outputId":"2ef1833d-6688-4e91-a1ba-0dea7cfd6dd6"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.575     , 0.53333333, 0.575     ])"]},"execution_count":239,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7219,"status":"ok","timestamp":1606856732444,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"6YnwjHF0zKar","outputId":"9e97ffeb-5f69-44bc-ffa4-f7912f8d94ac"},"outputs":[{"data":{"text/plain":["0.5666666666666667"]},"execution_count":240,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lq8oWJXFzKar"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_BRFekOUzKar"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7181,"status":"ok","timestamp":1606856732446,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"toTnrmmlzKar","outputId":"bda694b0-d7ab-45bd-fbb6-3d5c175c841d"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.45      , 0.56666667, 0.51666667, 0.5       ,\n","       0.46666667, 0.51666667, 0.48333333])"]},"execution_count":242,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7168,"status":"ok","timestamp":1606856732446,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kKc0nDGCzKar","outputId":"770f6372-d80d-4b8a-a597-f35880a0202d"},"outputs":[{"data":{"text/plain":["0.5"]},"execution_count":243,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OOMuvs-pzKar"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7140,"status":"ok","timestamp":1606856732447,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"wjRpb8NBzKar","outputId":"e1fb8d99-ef6e-4c54-8865-14e66c7d1334"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.63333333, 0.55      , 0.58333333, 0.6       ,\n","       0.48333333, 0.5       , 0.63333333])"]},"execution_count":245,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7127,"status":"ok","timestamp":1606856732447,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"r53hIRRXzKar","outputId":"d3cc15f9-46fd-4bb8-88bb-5a59eca163f9"},"outputs":[{"data":{"text/plain":["0.5645833333333333"]},"execution_count":246,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VRxmvc-wzKar"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"LL4QioxhzKar"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dsa5s6NCzKar"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YhmSCPQKzKar"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":332939,"status":"ok","timestamp":1606857588522,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"x3s1ZBelzKas","outputId":"e5249a0f-f7c5-42c1-d721-649e8be42edd"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48333333333333334\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5770833333333334\n","Improvement of 19.396551724137943% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed: 14.3min finished\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":554,"status":"ok","timestamp":1606857588524,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-_TCEZH-zKas","outputId":"51dc8005-cfbc-4cb4-ae4a-1159a70df7e3"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"oSYzxqW7zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8vgsOGsMzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"YROEJvQ5zKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":367,"status":"ok","timestamp":1606857588526,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VAcVTmDZzKas","outputId":"28a37998-373f-42f3-d2d6-6359c103e162"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.59166667, 0.5       , 0.25833333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":337,"status":"ok","timestamp":1606857588526,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JTR8dtFxzKas","outputId":"dc5e1234-ea12-4a7e-ca4c-458a5d37ba46"},"outputs":[{"data":{"text/plain":["0.4666666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"AphSBh3YzKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":284,"status":"ok","timestamp":1606857588528,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"c1VcemIGzKas","outputId":"4fb12a5f-0647-4a32-85c7-549b946511a1"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.54166667, 0.59166667, 0.525     ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":264,"status":"ok","timestamp":1606857588528,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Mw8VKeX8zKas","outputId":"d4596a26-4f6c-41e7-a87d-b759fa363fe7"},"outputs":[{"data":{"text/plain":["0.5395833333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"F81q7WTjzKas"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"WJ_jCgPzzKas"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1025,"status":"ok","timestamp":1606857589360,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DQYfT2OlzKas","outputId":"f9b0004c-bf3d-4dbd-969f-64c7b6b19c4e"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.5       , 0.61666667, 0.4       , 0.5       ,\n","       0.51666667, 0.76666667, 0.68333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":252,"status":"ok","timestamp":1606857589360,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Tc_SstgszKas","outputId":"0102748d-8893-4c8b-cc75-38416ba2cbcd"},"outputs":[{"data":{"text/plain":["0.5770833333333334"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IoF9LLnOzKas"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":205,"status":"ok","timestamp":1606857589361,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"a1wNxq3PzKas","outputId":"915db3a9-0629-4b71-f7eb-f6b98a8e262b"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.5       , 0.41666667, 0.45      , 0.63333333,\n","       0.45      , 0.46666667, 0.53333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":186,"status":"ok","timestamp":1606857589362,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"N9f3ydSCzKas","outputId":"f6b3b1e8-1e00-495d-9e90-15b83030cdcb"},"outputs":[{"data":{"text/plain":["0.49166666666666664"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"F0bMKlgozKas"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"RSJKARRAzKas"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"mBL6Eax3zKas"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iVOzO1_-zKas"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"Z765IlZJzKas","outputId":"934ef02f-d5ba-440f-8a6b-7bc18c0a9d40"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5375\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5645833333333333\n","Improvement of 5.038759689922483% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  6.3min finished\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"S3UewluXzKas","outputId":"77b6fb17-2a98-4743-fdd8-71a6c41fac55"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_-LO0Fa5zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FY_4P1stzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JtDObYhuzKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"hs5e3gDezKas","outputId":"e7003263-1ce5-493b-edcb-846ab48968f5"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.54166667, 0.53333333, 0.51666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"V3t-_ciTzKas","outputId":"ef8f9802-1da8-4a2c-aabc-0048fa5b7ec8"},"outputs":[{"data":{"text/plain":["0.5229166666666666"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Vj9bEfC_zKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"GrtGNjnnzKat","outputId":"15d0022d-5360-4c06-961e-7712c04eaffd"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.575     , 0.53333333, 0.575     ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tFlJd6qAzKat","outputId":"84178348-64a6-4a38-c0d1-e48b5d3e4a1f"},"outputs":[{"data":{"text/plain":["0.5666666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VdR_va-kzKat"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"mbAbJmqlzKat"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IEV9F0VPzKat","outputId":"1efa38d2-5cf4-4f8b-a643-d14a40b5f9c0"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.45      , 0.56666667, 0.51666667, 0.5       ,\n","       0.46666667, 0.51666667, 0.48333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"j9nKepwezKat","outputId":"623cc98e-c521-461f-cfa4-9ad467153e82"},"outputs":[{"data":{"text/plain":["0.5"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_GK6yAx_zKat"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"d05_H12ezKat","outputId":"2d34b29b-3a8b-4629-9bdb-2d644527aa36"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.63333333, 0.55      , 0.58333333, 0.6       ,\n","       0.48333333, 0.5       , 0.63333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"QJaiqkrezKat","outputId":"f0918902-2e45-4a0e-ee6b-51b86721515b"},"outputs":[{"data":{"text/plain":["0.5645833333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"KKwvhkyMzKat"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"gh0gtRO-D2F-"},"source":["## Random Forest Classifier"]},{"cell_type":"markdown","metadata":{"id":"8cap-uouzQCQ"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jr2mEagmPuxy"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"ZGtZPgTLYETt"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"le2W3NO8Puxy"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2282102,"status":"ok","timestamp":1606860802013,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"gmkK8kiPPuxy","outputId":"928f8749-f887-4ab0-e209-28c984d45adb"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5145833333333334\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 47.2min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5375\n","Improvement of 4.4534412955465426% relative to the initial model\n"]}],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":61,"status":"ok","timestamp":1606860802017,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WXLhC5g3Puxy","outputId":"30b9913a-a20a-445f-e142-6138a029a07e"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"OSua_O1KPuxy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"uMyaSHdOYGtk"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cWwrGaApYGtk"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":216,"status":"ok","timestamp":1606860802655,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cJUw5awvYGtk","outputId":"2807c235-6ebe-4f8c-d3f0-4525a7ccf06b"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.54166667, 0.55833333, 0.48333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":210,"status":"ok","timestamp":1606860802655,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7JkBGvC5YGtk","outputId":"b3bd6f59-0331-4cfd-dbb7-536213f051e4"},"outputs":[{"data":{"text/plain":["0.5375"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Xz6kWFe4YGtk"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":100,"status":"ok","timestamp":1606860803315,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"EXee_GspYGtk","outputId":"bb8ac171-d5d3-434b-d339-a362b34b39f1"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.53333333, 0.55      , 0.56666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":96,"status":"ok","timestamp":1606860803316,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"h7X0yp_8YGtk","outputId":"769c8b27-03cc-4a1c-8f3e-f33a4cf3cf9f"},"outputs":[{"data":{"text/plain":["0.5479166666666666"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VDD1dk-_YGtk"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jmXtWQZ_YGtk"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NRc_AIPLYGtk","outputId":"6dbc0632-e2cc-423b-8c41-ef45a17ec8b7"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.48333333, 0.46666667, 0.53333333, 0.55      ,\n","       0.58333333, 0.48333333, 0.43333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"s1ZyRf3iYGtk","outputId":"c4aaea85-5cb7-43ea-f80a-194db7c29cfe"},"outputs":[{"data":{"text/plain":["0.5020833333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"6wY5DeGLYGtk"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uraK4ZFyYGtk","outputId":"be0035f2-2f7c-4f04-b02e-9dcd1418f0c8"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.58333333, 0.55      , 0.51666667, 0.6       ,\n","       0.35      , 0.53333333, 0.53333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"rlDNMoS2YGtk","outputId":"2116fc0a-7735-46ac-b233-c37b15e08509"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Pi53d5suYGtk"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"E57mYUJwPuxz"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dm3nwjv8YIB7"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uhgJDujzPuxz"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7HXXuw1YPuxz","outputId":"55552e01-39b7-4141-cf91-e45db3e8c3e1"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.55\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 46.7min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5833333333333334\n","Improvement of 6.060606060606059% relative to the initial model\n"]}],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SQT2v3dWPuxz","outputId":"18ce4423-a5ff-4c32-ce98-62f1dc1ba613"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZZPh5InUPuxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"fgncv-YAYKgH"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uQC7n2_9YKgH"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZOyWUPf7YKgH","outputId":"5c75e038-364b-4661-e923-96c1746fb6f2"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.53333333, 0.56666667, 0.45      ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"PNiZaiTAYKgH","outputId":"936111d5-c58f-486f-f036-adf633084b37"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uMEfoU2_YKgH"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SImpkdfFYKgH","outputId":"faa849c3-65cc-41f1-8b71-7cb8801c5df8"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.55      , 0.50833333, 0.59166667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"8pwpVigDYKgH","outputId":"8688c3af-5f45-45bb-99a3-3fdade11e162"},"outputs":[{"data":{"text/plain":["0.5625"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Z-fMf-cOYKgH"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ySiVyU7sYKgH"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RqIaYT5rYKgH","outputId":"04eed1c2-4cb9-4a6b-8175-af24a774e401"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.53333333, 0.46666667, 0.53333333, 0.5       ,\n","       0.55      , 0.51666667, 0.45      ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gvbv0PiHYKgH","outputId":"d339d5b1-12f5-47e5-cd2d-97b4a541ed63"},"outputs":[{"data":{"text/plain":["0.5020833333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"p6Ku1ByOYKgH"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dY3402jGYKgH","outputId":"bf2abbf9-3983-4bb7-9613-5d4730a279cc"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.48333333, 0.46666667, 0.5       , 0.55      ,\n","       0.41666667, 0.51666667, 0.66666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wregmdqtYKgI","outputId":"8e48443b-b0d4-43a0-a94b-08e3f72e74a0"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"fyJpUwLIYKgI"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Tg_rwd0APuxz"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"FSZ6dmiZYLgS"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"39lY7LhiPuxz"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":313,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5112171,"status":"ok","timestamp":1606869461177,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"NOqOwG1nPuxz"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5041666666666667\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed: 97.4min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5395833333333333\n","Improvement of 7.0247933884297495% relative to the initial model\n"]}],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":314,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":45,"status":"ok","timestamp":1606869461180,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"3PmUdS5nPuxz"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":314,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1606869461180,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"MN42Rb16Puxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"F_F96mTXYOPF"},"source":["##### Test"]},{"cell_type":"code","execution_count":315,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":948,"status":"ok","timestamp":1606869462112,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"H6IzjxLBYOPF"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":316,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":81,"status":"ok","timestamp":1606869462171,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"4bWY8XZXYOPF"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.50833333, 0.56666667, 0.45      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":317,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":71,"status":"ok","timestamp":1606869462172,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"62f0GR1bYOPF"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":318,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":483,"status":"ok","timestamp":1606869462590,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8g0yaA4qYOPF"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":319,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":107,"status":"ok","timestamp":1606869462591,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uAdBpkk1YOPF"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.51666667, 0.53333333, 0.58333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":320,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":103,"status":"ok","timestamp":1606869462592,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zMfVwgjNYOPF"},"outputs":[{"data":{"text/plain":["0.5458333333333334"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":320,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":97,"status":"ok","timestamp":1606869462592,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zGUXp9auYOPF"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":321,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":1530,"status":"ok","timestamp":1606869464034,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"X7FB4DfFYOPF"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":322,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":76,"status":"ok","timestamp":1606869464092,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"dSwDndEiYOPF"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.51666667, 0.48333333, 0.55      , 0.56666667,\n","       0.56666667, 0.46666667, 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":323,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":71,"status":"ok","timestamp":1606869464093,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fGLMhla2YOPF"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"lZMclYLSYOPF"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vk3ptRjWYOPF"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.53333333, 0.5       , 0.53333333, 0.6       ,\n","       0.45      , 0.55      , 0.55      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"qkV7RDrQYOPF"},"outputs":[{"data":{"text/plain":["0.53125"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IvwQ0DcnYOPF"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"USGMYRvkPuxz"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"HvXfbULIYP0S"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IvpM4efCPuxz"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"AosKXbMnPuxz"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.525\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed: 97.8min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5479166666666667\n","Improvement of 4.36507936507937% relative to the initial model\n"]}],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Uo1epUM6Puxz"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"LEbVr7kID3lP"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Z3pVdFRIYS_Y"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"O1mSEfhvYS_Y"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"QcLc93iFYS_Y"},"outputs":[{"data":{"text/plain":["array([0.50833333, 0.50833333, 0.53333333, 0.475     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"sKcAejjvYS_Z"},"outputs":[{"data":{"text/plain":["0.50625"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"mQ_K8f1GYS_Z"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7Ni0XQ4MYS_Z"},"outputs":[{"data":{"text/plain":["array([0.59166667, 0.54166667, 0.50833333, 0.55      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"14dpGt4HYS_Z"},"outputs":[{"data":{"text/plain":["0.5479166666666666"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SlABUIa1YS_Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"XcqEawTMYS_Z"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2sVRpDV0YS_Z"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.51666667, 0.51666667, 0.53333333, 0.5       ,\n","       0.53333333, 0.51666667, 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"WUapXFgsYS_Z"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"njxWLC9cYS_Z"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"fOjDRVdiYS_Z"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.51666667, 0.5       , 0.51666667, 0.58333333,\n","       0.4       , 0.58333333, 0.58333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"bN5MWN21YS_Z"},"outputs":[{"data":{"text/plain":["0.5208333333333334"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zRMQjaF0YS_Z"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"ym_PcB2Bzhy5"},"source":["### Hyper_optimized Model"]},{"cell_type":"markdown","metadata":{"id":"gLRQegMuznEx"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"UYtPQW5lznEx"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qzMbiN63znEx"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"brq7F45MznEx"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"deNrrmvfznEx"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5270833333333333\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 46.7min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5375\n","Improvement of 1.97628458498023% relative to the initial model\n"]}],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"DuwWXLzCznEx"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"D_bWM63AznEx"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Dw0u6K5fznEx"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"r0bX_XinznEx"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jQQ7xE6FznEx"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.51666667, 0.59166667, 0.50833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"q8uJkiSgznEx"},"outputs":[{"data":{"text/plain":["0.5333333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"E_WvyhCkznEx"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gQ77McSEznEy"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.525     , 0.575     , 0.55833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"CrfcSLr_znEy"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"EN0zehJcznEy"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JZd-GNejznEy"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1tuwbqxBznEy"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.5       , 0.5       , 0.55      , 0.55      ,\n","       0.51666667, 0.48333333, 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2s555K_JznEy"},"outputs":[{"data":{"text/plain":["0.5125"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"55Yt3JxVznEy"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"e1uK8AAGznEy"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.51666667, 0.38333333, 0.51666667, 0.66666667,\n","       0.38333333, 0.53333333, 0.55      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vdyH7L3-znEy"},"outputs":[{"data":{"text/plain":["0.5104166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"y1YxHwLWznEy"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Uft0d1hpznEy"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"87fHemV8znEy"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_D-7eBzUznEy"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"pUYCZWU8znEy"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5708333333333333\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 46.7min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5875\n","Improvement of 2.9197080291970896% relative to the initial model\n"]}],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_XH1O4gEznEy"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1ZpTLQHPznEy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"gB5QZVGUznEy"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"9DAVY-EmznEy"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dIUnOe4_znEy"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.49166667, 0.59166667, 0.45      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Hen4_Lm3znEz"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Hxs44I_mznEz"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ea6nyuG4znEz"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.56666667, 0.575     , 0.575     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"mr_8apUtznEz"},"outputs":[{"data":{"text/plain":["0.56875"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"4MN-hf_WznEz"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"D0WAxV0RznEz"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vbEylF0OznEz"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.45      , 0.45      , 0.53333333, 0.61666667,\n","       0.55      , 0.55      , 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"oynC3pGvznEz"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"G6C-LGo7znEz"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NOAoGC48znE0"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.53333333, 0.5       , 0.56666667, 0.6       ,\n","       0.46666667, 0.51666667, 0.56666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"t63ca5zEznE0"},"outputs":[{"data":{"text/plain":["0.5291666666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VMZacJ-8znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"VElWFWnwznE0"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"oilXUTU9znE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"OrpD379aznE0"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"GiGSxegJznE0"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5020833333333334\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed: 97.3min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5354166666666667\n","Improvement of 6.639004149377568% relative to the initial model\n"]}],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"82SelhLDznE0"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jWj2VfvKznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"5N35S_S7znE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"xa8-D0wpznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"n2sVmxGdznE0"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.48333333, 0.59166667, 0.45      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BpnIX_HjznE0"},"outputs":[{"data":{"text/plain":["0.5125000000000001"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"XPiy_g5oznE0"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"azSQOq8_znE0"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.56666667, 0.56666667, 0.56666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"nOJk3jtxznE0"},"outputs":[{"data":{"text/plain":["0.575"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"oX-bRxwfznE0"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"f9IzvaKcznE0"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"OjhZe7LAznE0"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.48333333, 0.45      , 0.55      , 0.58333333,\n","       0.55      , 0.51666667, 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"pOxeg5R-znE0"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"FTtx-WTEznE0"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"nm3LlijhznE0"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.51666667, 0.48333333, 0.56666667, 0.61666667,\n","       0.45      , 0.51666667, 0.58333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"v8T7HCsRznE0"},"outputs":[{"data":{"text/plain":["0.5291666666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"rCBj88t3znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"IqZgkBX0znE0"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"3n_oeISCznE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"kAiOndRWznE0"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"D6mfl16pznE0"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5354166666666667\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed: 98.1min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5479166666666667\n","Improvement of 2.334630350194565% relative to the initial model\n"]}],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zIsY4x87znE0"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wOu2FqUgznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FNSg-xESznE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JAhmZr0WznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"qFmuaHAOznE0"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.49166667, 0.6       , 0.475     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"0PRsJdEAznE0"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7J3uMDdGznE1"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"-B3go7n2znE1"},"outputs":[{"data":{"text/plain":["array([0.575     , 0.56666667, 0.56666667, 0.59166667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"yCuHLkI8znE1"},"outputs":[{"data":{"text/plain":["0.575"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"8hWa-aJmznE1"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"5jVryRzDznE1"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"9Z4ghTQ5znE1"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.43333333, 0.43333333, 0.55      , 0.58333333,\n","       0.56666667, 0.51666667, 0.46666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2Z3jNzMFznE1"},"outputs":[{"data":{"text/plain":["0.5104166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"kraH7kCAznE1"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Hm7ymwVIznE1"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.51666667, 0.5       , 0.55      , 0.58333333,\n","       0.46666667, 0.5       , 0.6       ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2KrfQG6vznE1"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BFyZ88sQznE1"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"oDNCpIIRD7gz"},"source":["## XGBoost Classifier"]},{"cell_type":"markdown","metadata":{"id":"j2tykuMUzur7"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jqg0nC9EQYwp"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"NfgwRfQvYb8t"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JsLW_31BQYwp"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"bLodkCQ_QYwp"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5083333333333333\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5354166666666667\n","Improvement of 5.327868852459019% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed:   38.3s finished\n"]}],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RXLNwgL-QYwp"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"yX4Rcv6hQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"g3KPsQ60YgQm"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RxzUgIo2YgQm"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"rsR68pOvYgQm"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.49166667, 0.54166667, 0.525     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7K1nRVGxYgQm"},"outputs":[{"data":{"text/plain":["0.5083333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"qHeNXZf2YgQm"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RBCMfcXSYgQm"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.56666667, 0.56666667, 0.55833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZRQ_1B9WYgQm"},"outputs":[{"data":{"text/plain":["0.5645833333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"hpacKrT3YgQm"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"9EUD5_4AYgQm"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"qDQJIez_YgQm"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.45      , 0.46666667, 0.6       , 0.6       ,\n","       0.55      , 0.48333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"z-mkU6E6YgQn"},"outputs":[{"data":{"text/plain":["0.5354166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1epIp3BNYgQn"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JoJL01LrYgQn"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.61666667, 0.5       , 0.51666667, 0.58333333,\n","       0.41666667, 0.38333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"b6bf8HGHYgQn"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7y55nYzYYgQn"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Wh2r7aqvQYwq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"PVhR6RhrYjM2"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"hxo_eo5IQYwq"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Wr7MB0OmQYwq"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5645833333333333\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5708333333333333\n","Improvement of 1.1070110701106972% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed:   38.5s finished\n"]}],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"LQKZiM2UQYwq"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_M0E115eQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"VDgQXkvRYogs"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VIkd9Qu2Yogs"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"OvM-Fvb3Yogs"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.49166667, 0.54166667, 0.525     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iUk0ifWiYogs"},"outputs":[{"data":{"text/plain":["0.5083333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"PHgkhMkOYogs"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"AHTtZ-8fYogs"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.56666667, 0.56666667, 0.55833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Z9HpvbW3Yogs"},"outputs":[{"data":{"text/plain":["0.5645833333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"l5gaVnt6Yogs"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"a3zuz6rrYogs"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cW3BKU5wYogs"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.45      , 0.46666667, 0.6       , 0.6       ,\n","       0.55      , 0.48333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ancDGUAjYogs"},"outputs":[{"data":{"text/plain":["0.5354166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"LFXL4CazYogs"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"E4x6WM0SYogs"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.61666667, 0.5       , 0.51666667, 0.58333333,\n","       0.41666667, 0.38333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"8guPYbmSYogs"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tg598195Yogs"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AGYcf92VQYwq"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dk6vZ3MYYqf_"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RyTE9hZoQYwq"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Gak6l1CXQYwq"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5354166666666667\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5479166666666667\n","Improvement of 2.334630350194565% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed:  1.4min finished\n"]}],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"0rxn8OrlQYwq"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2BQXvF4KQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Io2FlXTHYt3K"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"bI2jZQ7FYt3K"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"he-l5p-SYt3K"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.49166667, 0.54166667, 0.525     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uy8sRZwLYt3K"},"outputs":[{"data":{"text/plain":["0.5083333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"A8qBvhgVYt3K"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"-dgZAbImYt3K"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.56666667, 0.56666667, 0.55833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"m3bDkAUgYt3K"},"outputs":[{"data":{"text/plain":["0.5645833333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dfF2wiF7Yt3K"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"nLTq2VfkYt3K"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"rC72bI8rYt3K"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.45      , 0.46666667, 0.6       , 0.6       ,\n","       0.55      , 0.48333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"otMnNNBJYt3K"},"outputs":[{"data":{"text/plain":["0.5354166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iz34DmjlYt3K"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"GWhpQqdCYt3K"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.61666667, 0.5       , 0.51666667, 0.58333333,\n","       0.41666667, 0.38333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"eljr226pYt3K"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BrLIGAzbYt3K"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"1O6rD9RLQYwq"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"RIQdan6pYvOX"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"h5xA-bMkQYwq"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"HOQsRZ_8QYwq"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5229166666666667\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5541666666666667\n","Improvement of 5.97609561752988% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed:  1.4min finished\n"]}],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"aHQhKc--QYwq"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"eseZcKAoJ__G"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"yLZCsP0eY1pQ"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"X7kKF19DY1pQ"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"KWcoIkfCY1pQ"},"outputs":[{"data":{"text/plain":["array([0.475     , 0.49166667, 0.54166667, 0.525     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jnyaRlzsY1pQ"},"outputs":[{"data":{"text/plain":["0.5083333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"9NgKsUKFY1pQ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zueJZ-5YY1pQ"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.56666667, 0.56666667, 0.55833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"PP9j9jbzY1pQ"},"outputs":[{"data":{"text/plain":["0.5645833333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"HwbywwFEY1pQ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zR8v_IjfY1pQ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"O_LHVRPTY1pQ"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.45      , 0.46666667, 0.6       , 0.6       ,\n","       0.55      , 0.48333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SnRWttBqY1pQ"},"outputs":[{"data":{"text/plain":["0.5354166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"S8E5UdVMY1pQ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iSNXFoQYY1pQ"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.61666667, 0.5       , 0.51666667, 0.58333333,\n","       0.41666667, 0.38333333, 0.61666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZDu2p-FDY1pQ"},"outputs":[{"data":{"text/plain":["0.5229166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"mliqJis0Y1pQ"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uqoeswDMnyci"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"JAynU_HI0PBY"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"vgrN6ot60PBY"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"O48noycN0PBY"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jDpeFtN80PBY"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"QnV8vzRh0PBY"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5083333333333333\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5354166666666667\n","Improvement of 5.327868852459019% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed:   38.3s finished\n"]}],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"HJzjh4ga0PBY"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IE2N7VHD0PBY"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"YSJmQn2_0PBY"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"B9OPp_sT0PBY"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7UF8Fh0r0PBY"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.51666667, 0.58333333, 0.51666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"LHHSq-ze0PBZ"},"outputs":[{"data":{"text/plain":["0.5354166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NU2etCDh0PBZ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vzs-oG2Q0PBZ"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.53333333, 0.55      , 0.51666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Y5LNQ2Im0PBZ"},"outputs":[{"data":{"text/plain":["0.5458333333333334"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zWt5dGZS0PBZ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"R9R3q8lF0PBZ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uuD97M-r0PBZ"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.46666667, 0.48333333, 0.58333333, 0.58333333,\n","       0.55      , 0.51666667, 0.51666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"QWUwvFh-0PBZ"},"outputs":[{"data":{"text/plain":["0.5354166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vEfN1lmG0PBZ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"0srZvvEV0PBZ"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.56666667, 0.48333333, 0.51666667, 0.6       ,\n","       0.46666667, 0.45      , 0.6       ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ugLG-QXc0PBZ"},"outputs":[{"data":{"text/plain":["0.5208333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"F6Eu517e0PBa"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"90su4wIc0PBa"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"MJ4OmTw50PBa"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vJnjTODu0PBa"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NgcVhOm00PBa"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5645833333333333\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5708333333333333\n","Improvement of 1.1070110701106972% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed:   38.4s finished\n"]}],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"aEo-v5Sh0PBa"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"z1CdrcR-0PBa"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ss4KdVSQ0PBa"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SC7I2If40PBa"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"6DhduOKd0PBa"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.44166667, 0.56666667, 0.50833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wDo0HinI0PBa"},"outputs":[{"data":{"text/plain":["0.5083333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"6DDy143g0PBa"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"o-nojkLm0PBa"},"outputs":[{"data":{"text/plain":["array([0.625     , 0.575     , 0.5       , 0.58333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7W4s6Znt0PBa"},"outputs":[{"data":{"text/plain":["0.5708333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"GbdcHa7A0PBb"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VzBE8UbC0PBb"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"YFf8uy7j0PBb"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.46666667, 0.45      , 0.53333333, 0.5       ,\n","       0.58333333, 0.46666667, 0.63333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"s0Qet-vx0PBb"},"outputs":[{"data":{"text/plain":["0.5208333333333334"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"G1pViHjW0PBb"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"HngwE8vS0PBb"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.55      , 0.46666667, 0.5       , 0.55      ,\n","       0.4       , 0.36666667, 0.58333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wcsNamsp0PBb"},"outputs":[{"data":{"text/plain":["0.4895833333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"480rGKpC0PBb"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AbL7-dbc0PBb"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"tnN0ijSs0PBb"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Tx_6QIyU0PBb"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iJrhBHOb0PBb"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5354166666666667\n","Fitting 8 folds for each of 300 candidates, totalling 2400 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5479166666666667\n","Improvement of 2.334630350194565% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 2400 out of 2400 | elapsed:  1.4min finished\n"]}],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IkkX2HRP0PBb"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tqiloYtR0PBb"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Ropu3-tW0PBb"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"k0e0jkDZ0PBb"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"bIeTuXR00PBb"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.48333333, 0.60833333, 0.475     ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"QSQ-6v460PBc"},"outputs":[{"data":{"text/plain":["0.5083333333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"sj8Sha_x0PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"4yc-2qz10PBc"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.49166667, 0.55833333, 0.55      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"neS6G0C10PBc"},"outputs":[{"data":{"text/plain":["0.53125"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7MXe6xRr0PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ct3yEerV0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iSfJeL230PBc"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.58333333, 0.48333333, 0.55      , 0.55      ,\n","       0.51666667, 0.58333333, 0.53333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"kojZ2SUM0PBc"},"outputs":[{"data":{"text/plain":["0.5479166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"A_CcH-Ql0PBc"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7Tn152nR0PBc"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.58333333, 0.48333333, 0.51666667, 0.61666667,\n","       0.5       , 0.48333333, 0.56666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tRSdT7Wx0PBc"},"outputs":[{"data":{"text/plain":["0.525"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BLyOKveN0PBc"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Oq6LsPJw0PBc"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"eUk34NiQ0PBc"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7tnmONbH0PBc"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"45KiYK090PBc"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G2tlj00W0PBc"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AFtm3Nt40PBc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"1X2T4ocQ0PBc"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mOdemmuz0PBc"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0IbOynDY0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mWi1QK860PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zz1UZyb90PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pc4AEhkH0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IZONW9Eg0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J0yH0nP80PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f_XTLXOd0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ejufwDue0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f0rOZsMN0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MLvMmLOC0PBd"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tMpVsZzS0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"13om3syO0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9kuC5h0B0PBd"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55_ocXPFoH8Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wzk61CezoI2E"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YUIZoGclSNMr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n4DB9nM9WS_I"},"outputs":[],"source":[""]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Machine Learning Computation - linear - vmPFC","provenance":[{"file_id":"1wV98L2ux7aXgacLTPCET4rezuozEXbNB","timestamp":1606814445981},{"file_id":"1FKzRRIZhxD6H3s8wEXUtnoGk7FOlng8M","timestamp":1605987313010},{"file_id":"https://github.com/fastai/fastai/blob/master/nbs/44_tutorial.tabular.ipynb","timestamp":1605742460785}],"version":""},"jupytext":{"split_at_heading":true},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"}},"nbformat":4,"nbformat_minor":0}