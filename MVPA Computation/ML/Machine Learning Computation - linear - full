{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"0q0cnNSixB9u"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MRb0FZftSf1k"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tKtiW9P0o7fM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":4973,"status":"ok","timestamp":1606853526027,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Cs4vCXzHXrFL"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from numpy import array\n","import matplotlib.pyplot as plt\n","\n","from sklearn.feature_selection import f_classif, mutual_info_classif, SelectFdr\n","\n","from sklearn.feature_selection import GenericUnivariateSelect\n","from sklearn.svm import LinearSVC, NuSVC\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier \n","\n","from scipy.stats import uniform, randint\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from sklearn.naive_bayes import GaussianNB\n","from sklearn.svm import SVC\n","from sklearn.datasets import load_digits\n","from sklearn.model_selection import learning_curve\n","from sklearn.model_selection import ShuffleSplit\n","from sklearn.model_selection import cross_val_score\n","\n","import xgboost as xgb\n","from sklearn.metrics import auc, accuracy_score, confusion_matrix, mean_squared_error\n","from sklearn.model_selection import cross_val_score, GridSearchCV, KFold, RandomizedSearchCV, train_test_split\n","\n","from warnings import filterwarnings\n","filterwarnings('ignore')\n"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":5203,"status":"ok","timestamp":1606853526261,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"F9rXqu8pJW8o"},"outputs":[],"source":["\n","def plot_learning_curve(estimator, title, X, y, axes=None, ylim=None, cv=None,\n","                        n_jobs=None, train_sizes=np.linspace(.1, 1.0, 5)):\n","    \"\"\"\n","    Generate 3 plots: the test and training learning curve, the training\n","    samples vs fit times curve, the fit times vs score curve.\n","\n","    Parameters\n","    ----------\n","    estimator : object type that implements the \"fit\" and \"predict\" methods\n","        An object of that type which is cloned for each validation.\n","\n","    title : string\n","        Title for the chart.\n","\n","    X : array-like, shape (n_samples, n_features)\n","        Training vector, where n_samples is the number of samples and\n","        n_features is the number of features.\n","\n","    y : array-like, shape (n_samples) or (n_samples, n_features), optional\n","        Target relative to X for classification or regression;\n","        None for unsupervised learning.\n","\n","    axes : array of 3 axes, optional (default=None)\n","        Axes to use for plotting the curves.\n","\n","    ylim : tuple, shape (ymin, ymax), optional\n","        Defines minimum and maximum yvalues plotted.\n","\n","    cv : int, cross-validation generator or an iterable, optional\n","        Determines the cross-validation splitting strategy.\n","        Possible inputs for cv are:\n","\n","          - None, to use the default 5-fold cross-validation,\n","          - integer, to specify the number of folds.\n","          - :term:`CV splitter`,\n","          - An iterable yielding (train, test) splits as arrays of indices.\n","\n","        For integer/None inputs, if ``y`` is binary or multiclass,\n","        :class:`StratifiedKFold` used. If the estimator is not a classifier\n","        or if ``y`` is neither binary nor multiclass, :class:`KFold` is used.\n","\n","        Refer :ref:`User Guide \u003ccross_validation\u003e` for the various\n","        cross-validators that can be used here.\n","\n","    n_jobs : int or None, optional (default=None)\n","        Number of jobs to run in parallel.\n","        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n","        ``-1`` means using all processors. See :term:`Glossary \u003cn_jobs\u003e`\n","        for more details.\n","\n","    train_sizes : array-like, shape (n_ticks,), dtype float or int\n","        Relative or absolute numbers of training examples that will be used to\n","        generate the learning curve. If the dtype is float, it is regarded as a\n","        fraction of the maximum size of the training set (that is determined\n","        by the selected validation method), i.e. it has to be within (0, 1].\n","        Otherwise it is interpreted as absolute sizes of the training sets.\n","        Note that for classification the number of samples usually have to\n","        be big enough to contain at least one sample from each class.\n","        (default: np.linspace(0.1, 1.0, 5))\n","    \"\"\"\n","    if axes is None:\n","        _, axes = plt.subplots(1, 3, figsize=(20, 5))\n","\n","    axes[0].set_title(title)\n","    if ylim is not None:\n","        axes[0].set_ylim(*ylim)\n","    axes[0].set_xlabel(\"Training examples\")\n","    axes[0].set_ylabel(\"Score\")\n","\n","    train_sizes, train_scores, test_scores, fit_times, _ = \\\n","        learning_curve(estimator, X, y, cv=cv, n_jobs=n_jobs,\n","                       train_sizes=train_sizes,\n","                       return_times=True)\n","    train_scores_mean = np.mean(train_scores, axis=1)\n","    train_scores_std = np.std(train_scores, axis=1)\n","    test_scores_mean = np.mean(test_scores, axis=1)\n","    test_scores_std = np.std(test_scores, axis=1)\n","    fit_times_mean = np.mean(fit_times, axis=1)\n","    fit_times_std = np.std(fit_times, axis=1)\n","\n","    # Plot learning curve\n","    axes[0].grid()\n","    axes[0].fill_between(train_sizes, train_scores_mean - train_scores_std,\n","                         train_scores_mean + train_scores_std, alpha=0.1,\n","                         color=\"r\")\n","    axes[0].fill_between(train_sizes, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1,\n","                         color=\"g\")\n","    axes[0].plot(train_sizes, train_scores_mean, 'o-', color=\"r\",\n","                 label=\"Training score\")\n","    axes[0].plot(train_sizes, test_scores_mean, 'o-', color=\"g\",\n","                 label=\"Cross-validation score\")\n","    axes[0].legend(loc=\"best\")\n","\n","    # Plot n_samples vs fit_times\n","    axes[1].grid()\n","    axes[1].plot(train_sizes, fit_times_mean, 'o-')\n","    axes[1].fill_between(train_sizes, fit_times_mean - fit_times_std,\n","                         fit_times_mean + fit_times_std, alpha=0.1)\n","    axes[1].set_xlabel(\"Training examples\")\n","    axes[1].set_ylabel(\"fit_times\")\n","    axes[1].set_title(\"Scalability of the model\")\n","\n","    # Plot fit_time vs score\n","    axes[2].grid()\n","    axes[2].plot(fit_times_mean, test_scores_mean, 'o-')\n","    axes[2].fill_between(fit_times_mean, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1)\n","    axes[2].set_xlabel(\"fit_times\")\n","    axes[2].set_ylabel(\"Score\")\n","    axes[2].set_title(\"Performance of the model\")\n","\n","    return plt"]},{"cell_type":"code","execution_count":17,"metadata":{"executionInfo":{"elapsed":956,"status":"ok","timestamp":1606854282661,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0KzSKSrn_INa"},"outputs":[],"source":["def hyper_opt_procedure(model_object,params,cv,perf_df,X,y):\n","\n","\n","  model = model_object()\n","\n","  # Initial Model Fit with stock hyper_params\n","\n","  init_score = np.mean(cross_val_score(model,X,y,cv=cv))\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Stock Params',\n","                              'Score':init_score}, ignore_index=True)\n","\n","  print('Initial Model with Stock Params Score : {}'.format(init_score))\n","\n","  # Random Search Cross Validation\n","\n","\n","  search_model = RandomizedSearchCV(model,\n","                                         param_distributions=params,\n","                                         random_state=42, \n","                                         n_iter=300, \n","                                         cv=cv, \n","                                         verbose=1, \n","                                         n_jobs=1, \n","                                         return_train_score=True)\n","\n","  search_model.fit(X,y)\n","\n","  best_search_model = search_model.best_estimator_\n","\n","  best_search_model_score = search_model.best_score_\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Random HP Search Best Model',\n","                      'Score':best_search_model_score}, ignore_index=True)\n","\n","  rd_score_improv = ((best_search_model_score - init_score)/init_score) * 100\n","\n","  print('Random HP Search Best Model Score : {}'.format(best_search_model_score))\n","\n","  print('Improvement of {}% relative to the initial model'.format(rd_score_improv))\n","  \n","  \n","\n","\n","  return model, best_search_model\n","   \n","\n","\n","\n","class hyper_model:\n","    \n","    def __init__(self,model_name,validation_approach,X,y):\n","        \n","        self.model_name = model_name\n","        self.X = X\n","        self.y = y\n","        self.validation_approach= validation_approach\n","        self.best_model = None\n","        self.best_params = None\n","        self.all_models_perf = pd.DataFrame(None,columns=['Model Iteration','Score'])\n","        self.stock_model = None\n","        self.rd_model = None\n","\n","\n","    def fit(self):\n","\n","\n","      if self.validation_approach == 'leave-one-run-out':\n","\n","        cv = KFold(n_splits=8, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-run-out-shuffled':\n","\n","        cv = KFold(n_splits=8, shuffle=True, random_state=42)\n","\n","      elif self.validation_approach == 'leave-one-task-out':\n","\n","        cv = KFold(n_splits=4, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-task-out-shuffled':\n","\n","        cv = KFold(n_splits=4, shuffle=True, random_state=42)    \n","\n","\n"," \n","        \n","        # Linear SVM\n","\n","      if self.model_name == 'linear_svm':\n","\n","        params = {'C': [0.1, 1, 10, 100, 1000]} \n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=LinearSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","         \n","\n","      # Non Linear SVM\n","\n","\n","      elif self.model_name == 'non_linear_svm':\n","\n","        params = {'nu': [0.01, 0.3, 0.5, 0.7, 1],  \n","                        'gamma': [1, 0.1, 0.01, 0.001, 0.0001], \n","                        'kernel': ['rbf','poly','sigmoid']\n","                       }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=NuSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","          \n","      # Random Forest Classifier\n","\n","\n","      elif self.model_name == 'random_forest_classifier':\n","\n","\n","        params = {'bootstrap': [True, False],\n","                    'max_depth': [50, 60, 70, 80, 90, 100],\n","                    'max_features': ['auto', 'sqrt'],\n","                    'min_samples_leaf': [1, 2, 4],\n","                    'min_samples_split': [2, 5, 10],\n","                    'n_estimators': [1000, 1200, 1400, 1600, 1800, 2000]\n","                   }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=RandomForestClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","          \n","\n","\n","\n","      # XG Boost Classifier\n","\n","\n","      elif self.model_name == 'xg_boost':\n","\n","        params = {\n","              \"colsample_bytree\": uniform(0.7, 0.3),\n","              \"gamma\": uniform(0, 0.5),\n","              \"learning_rate\": uniform(0.03, 0.3), \n","              \"max_depth\": randint(2, 6), \n","              \"n_estimators\": randint(100, 150),\n","              \"subsample\": uniform(0.6, 0.4)\n","              }\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=xgb.XGBClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)  \n","\n","                \n","                "]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21170,"status":"ok","timestamp":1606853546447,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hO1Z8nwls9_Y","outputId":"0b756f41-c922-4455-a4ff-88e74c7eec5e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive/\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive/',force_remount=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":445,"status":"ok","timestamp":1606838283145,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AU6YvpHup87A","outputId":"01e7039d-4da3-4fc8-de9a-209278a9364c"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[0m\u001b[01;34mdrive\u001b[0m/  \u001b[01;34msample_data\u001b[0m/\n"]}],"source":["ls"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":812,"status":"ok","timestamp":1606853570529,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jtOjcM89tPUT","outputId":"ae72010c-2c24-454b-9235-2d758c0afb47"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CEA\n"]}],"source":["cd drive/MyDrive/CEA/"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":1698,"status":"ok","timestamp":1606853573496,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"mK0bYtMjvknM"},"outputs":[],"source":["X = np.load('data/X_pref_lss_shift_linear_full.npy')"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1010,"status":"ok","timestamp":1606853578157,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uqbxJx6gxbey","outputId":"7132b5a6-3eb4-410a-e0c5-9e95e46ae537"},"outputs":[{"data":{"text/plain":["(480, 1915)"]},"execution_count":8,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X.shape"]},{"cell_type":"code","execution_count":9,"metadata":{"executionInfo":{"elapsed":962,"status":"ok","timestamp":1606853603719,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Iojp3abFv1W0"},"outputs":[],"source":["y = np.load('data/y_pref_lss_shift_linear_full.npy')"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":419,"status":"ok","timestamp":1606853603963,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HRfd5YRExl6M","outputId":"f5bb77c6-4ca4-4987-e80e-fc4204a98a85"},"outputs":[{"data":{"text/plain":["(480, 1)"]},"execution_count":10,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["y.shape"]},{"cell_type":"markdown","metadata":{"id":"-eDis182XeSE"},"source":["## Features Selection"]},{"cell_type":"markdown","metadata":{"id":"G7d7JTJmXgwj"},"source":["### Filter"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":2535,"status":"ok","timestamp":1606853984992,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Kexq1fnyXkRY"},"outputs":[],"source":["transformer = GenericUnivariateSelect(mutual_info_classif, mode='k_best', param=550)"]},{"cell_type":"code","execution_count":12,"metadata":{"executionInfo":{"elapsed":13595,"status":"ok","timestamp":1606853996056,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FAZkKRmhXnPo"},"outputs":[],"source":["X_trans = transformer.fit_transform(X, y)"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13179,"status":"ok","timestamp":1606853996057,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BKKN66taXoz0","outputId":"1a05678f-2855-4fac-da62-aaf737c66ee4"},"outputs":[{"data":{"text/plain":["(480, 550)"]},"execution_count":13,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X_trans.shape"]},{"cell_type":"markdown","metadata":{"id":"cC_RDtVZYwG0"},"source":["### Data Preparation"]},{"cell_type":"code","execution_count":14,"metadata":{"executionInfo":{"elapsed":13177,"status":"ok","timestamp":1606853996057,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8OmeM2TuYzDd"},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10, random_state=42)"]},{"cell_type":"markdown","metadata":{"id":"3rxGDdS1Y2A6"},"source":["## Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"GYprfzL1CrKi"},"source":["# Nouvelle section"]},{"cell_type":"markdown","metadata":{"id":"3e6kNyHGxE_w"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"oK0OX_9xnzWv"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"P0slq_QtT_P1"},"source":["##### Training"]},{"cell_type":"code","execution_count":18,"metadata":{"executionInfo":{"elapsed":7711,"status":"ok","timestamp":1606854518296,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"url-dxiyoJsT"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":57368,"status":"ok","timestamp":1606854567983,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"MATeUxpJo9DC","outputId":"8ad61144-efd9-4fe6-94aa-2d315346912a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5020833333333333\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:   37.4s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5125\n","Improvement of 2.0746887966804906% relative to the initial model\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":57333,"status":"ok","timestamp":1606854567984,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-LuUfzJYuZ5c","outputId":"d736be1b-5d9f-4722-83ea-0f0bd7071bfe"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":20,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":20,"metadata":{"executionInfo":{"elapsed":57320,"status":"ok","timestamp":1606854567984,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hlwfN3l9XDr-"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"WnDMByUhXMfO"},"source":["##### Test"]},{"cell_type":"code","execution_count":21,"metadata":{"executionInfo":{"elapsed":64869,"status":"ok","timestamp":1606854575546,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"obSzi-BEXMfO"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":64859,"status":"ok","timestamp":1606854575548,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aPPDOaCxXMfO","outputId":"7949da44-a4d8-4a83-810b-787fe81b3753"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.45833333, 0.49166667, 0.475     ])"]},"execution_count":22,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":64848,"status":"ok","timestamp":1606854575549,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9l85G4epXMfO","outputId":"2d430d08-d165-43e4-b389-0b895f56c87a"},"outputs":[{"data":{"text/plain":["0.48958333333333337"]},"execution_count":23,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":24,"metadata":{"executionInfo":{"elapsed":69620,"status":"ok","timestamp":1606854580333,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"nZiTeY6mXMfO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":69610,"status":"ok","timestamp":1606854580335,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Imp-qfZeXMfO","outputId":"64505a42-5ce0-4a3e-e781-aedc4146c9a0"},"outputs":[{"data":{"text/plain":["array([0.14166667, 0.15      , 0.11666667, 0.125     ])"]},"execution_count":25,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":69598,"status":"ok","timestamp":1606854580335,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y6HNpYl_XMfO","outputId":"c7bb8fe8-3892-4cb8-d22a-4462adc499cf"},"outputs":[{"data":{"text/plain":["0.13333333333333333"]},"execution_count":26,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":26,"metadata":{"executionInfo":{"elapsed":69587,"status":"ok","timestamp":1606854580336,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"osKpbfvyXMfO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":27,"metadata":{"executionInfo":{"elapsed":88021,"status":"ok","timestamp":1606854598782,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"w2SlhLffXMfO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":88011,"status":"ok","timestamp":1606854598784,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FqjIqTD1XMfO","outputId":"03cf2620-4863-475a-b3f6-a6f734d8adb1"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.5       , 0.5       , 0.46666667, 0.46666667,\n","       0.48333333, 0.55      , 0.56666667])"]},"execution_count":28,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":88002,"status":"ok","timestamp":1606854598787,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yZVtOibiXMfO","outputId":"e4cc7ea5-8043-4340-a140-4d8f450488e0"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":29,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":30,"metadata":{"executionInfo":{"elapsed":106152,"status":"ok","timestamp":1606854616949,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"oajU1LQ3XMfP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":106140,"status":"ok","timestamp":1606854616952,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ADNditLZXMfP","outputId":"d67f705b-2f68-479f-d9a3-88bf4b7d1a99"},"outputs":[{"data":{"text/plain":["array([0.06666667, 0.13333333, 0.08333333, 0.1       , 0.23333333,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":31,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":32,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":106128,"status":"ok","timestamp":1606854616953,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"goo-B_3cXMfP","outputId":"0602640b-160e-4a06-9795-440fff940a33"},"outputs":[{"data":{"text/plain":["0.10625000000000001"]},"execution_count":32,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":33,"metadata":{"executionInfo":{"elapsed":106116,"status":"ok","timestamp":1606854616953,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"P-5MwWHhXMfP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Gb-Qqwn8oJ7d"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"R4mMDLPsWAmE"},"source":["##### Training"]},{"cell_type":"code","execution_count":34,"metadata":{"executionInfo":{"elapsed":106105,"status":"ok","timestamp":1606854616954,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8Cee0jzzPIFx"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":35,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":135948,"status":"ok","timestamp":1606854646809,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JGJS_yz6PIFy","outputId":"f8ee3619-3ce5-476d-c2bf-3f4c2951f1cc"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.13333333333333333\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:   22.7s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.13541666666666666\n","Improvement of 1.5624999999999944% relative to the initial model\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":135938,"status":"ok","timestamp":1606854646811,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JAf3le69PIFy","outputId":"741af111-7240-4aa2-aae3-943952238ff4"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":36,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":36,"metadata":{"executionInfo":{"elapsed":135923,"status":"ok","timestamp":1606854646812,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WIsSLawaoR-_"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"CMPrOUDoWFWr"},"source":["##### Test"]},{"cell_type":"code","execution_count":37,"metadata":{"executionInfo":{"elapsed":144054,"status":"ok","timestamp":1606854654956,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Vd_umY9HWFWr"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":38,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":144043,"status":"ok","timestamp":1606854654958,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tpxUGequWFWr","outputId":"a1c86631-4eb1-4122-ad99-ed1584f5185a"},"outputs":[{"data":{"text/plain":["array([0.50833333, 0.44166667, 0.5       , 0.49166667])"]},"execution_count":38,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":39,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":144029,"status":"ok","timestamp":1606854654959,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LCzQufNtWFWr","outputId":"8e38c48a-8bc2-4a9f-a4c4-1cbd84179b7b"},"outputs":[{"data":{"text/plain":["0.48541666666666666"]},"execution_count":39,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":40,"metadata":{"executionInfo":{"elapsed":149100,"status":"ok","timestamp":1606854660044,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"pSmKo3hZWFWr"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":41,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":149091,"status":"ok","timestamp":1606854660046,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7hn8vbGCWFWr","outputId":"19989b39-67db-43a1-e1fa-071bc2eeb3fb"},"outputs":[{"data":{"text/plain":["array([0.14166667, 0.15      , 0.11666667, 0.125     ])"]},"execution_count":41,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":42,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":149081,"status":"ok","timestamp":1606854660046,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PxVtKHfUWFWr","outputId":"c6c10a69-2012-40c5-b4fe-938276d4d43a"},"outputs":[{"data":{"text/plain":["0.13333333333333333"]},"execution_count":42,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":42,"metadata":{"executionInfo":{"elapsed":149072,"status":"ok","timestamp":1606854660047,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ChZvGrkeWFWr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":43,"metadata":{"executionInfo":{"elapsed":168315,"status":"ok","timestamp":1606854679300,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"3uCFUnE0WFWr"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":44,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":168308,"status":"ok","timestamp":1606854679304,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8CGhPtsfWFWr","outputId":"e47ae0cd-2183-48b2-de46-812429394fd8"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.45      , 0.46666667, 0.45      , 0.45      ,\n","       0.45      , 0.53333333, 0.43333333])"]},"execution_count":44,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":45,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":168298,"status":"ok","timestamp":1606854679305,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"D0iWmziUWFWr","outputId":"0087f3b6-1728-4cb0-ec3f-996d1a6ec9c0"},"outputs":[{"data":{"text/plain":["0.4708333333333333"]},"execution_count":45,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":46,"metadata":{"executionInfo":{"elapsed":185937,"status":"ok","timestamp":1606854696955,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xdhCavSlWFWr"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":47,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":185929,"status":"ok","timestamp":1606854696958,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1JmYYZIwWFWr","outputId":"ae274c38-d978-4791-a2fe-3647cd785e2d"},"outputs":[{"data":{"text/plain":["array([0.05      , 0.13333333, 0.08333333, 0.1       , 0.23333333,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":47,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":48,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":185919,"status":"ok","timestamp":1606854696960,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9JDZ-36UWFWr","outputId":"a4dc36e7-c4c2-43da-e27d-52c0cc72b087"},"outputs":[{"data":{"text/plain":["0.10416666666666667"]},"execution_count":48,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":49,"metadata":{"executionInfo":{"elapsed":185909,"status":"ok","timestamp":1606854696961,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"nbRpu_f0WFWr"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"yk1VAnOFoSCu"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qK7ud6-dWV9T"},"source":["##### Training"]},{"cell_type":"code","execution_count":50,"metadata":{"executionInfo":{"elapsed":185897,"status":"ok","timestamp":1606854696961,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BjBXz_jRPPJO"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":51,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":298719,"status":"ok","timestamp":1606854809794,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CnbTertnPPJO","outputId":"fd2ad848-6db3-4b78-8094-4630b9a72d26"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5020833333333333\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:  1.5min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 9.543568464730301% relative to the initial model\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":52,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":298708,"status":"ok","timestamp":1606854809795,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sHMdRLUsPPJP","outputId":"475b6018-3829-48c6-dbbe-716304710259"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":52,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":52,"metadata":{"executionInfo":{"elapsed":298697,"status":"ok","timestamp":1606854809795,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VhkTeBlsoSGf"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ffRmE2HzXfw2"},"source":["##### Test"]},{"cell_type":"code","execution_count":53,"metadata":{"executionInfo":{"elapsed":306623,"status":"ok","timestamp":1606854817733,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xjJzKwpEXfw2"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":54,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":306614,"status":"ok","timestamp":1606854817735,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FfqjXtzaXfw2","outputId":"f0503ff4-171a-493a-d790-34e128b73a3e"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.45833333, 0.54166667, 0.48333333])"]},"execution_count":54,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":55,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":306602,"status":"ok","timestamp":1606854817735,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XCi4tf0uXfw2","outputId":"6d9e8cad-acad-4fcb-db7e-185ed65796c1"},"outputs":[{"data":{"text/plain":["0.5020833333333333"]},"execution_count":55,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":56,"metadata":{"executionInfo":{"elapsed":310986,"status":"ok","timestamp":1606854822130,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"f4rrkYJUXfw2"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":57,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":310976,"status":"ok","timestamp":1606854822132,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ldUaBM8oXfw2","outputId":"ee17cffa-7fb2-4b40-b845-ebd7b7873e17"},"outputs":[{"data":{"text/plain":["array([0.14166667, 0.15      , 0.11666667, 0.125     ])"]},"execution_count":57,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":58,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":310966,"status":"ok","timestamp":1606854822133,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kiw1b1y8Xfw2","outputId":"b08a21fc-b0d6-49b8-b613-230a020e8568"},"outputs":[{"data":{"text/plain":["0.13333333333333333"]},"execution_count":58,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":58,"metadata":{"executionInfo":{"elapsed":310954,"status":"ok","timestamp":1606854822133,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"bNAQZX5ZXfw2"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":59,"metadata":{"executionInfo":{"elapsed":330952,"status":"ok","timestamp":1606854842142,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RYc1l8DXXfw2"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":60,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":330942,"status":"ok","timestamp":1606854842144,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"69s38be1Xfw2","outputId":"40068c56-5c39-4c0e-94b7-093b7c28d5c9"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.45      , 0.41666667, 0.46666667, 0.53333333,\n","       0.45      , 0.53333333, 0.53333333])"]},"execution_count":60,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":61,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":330932,"status":"ok","timestamp":1606854842145,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"nVk4MjlQXfw2","outputId":"fd8941f2-b3fb-44e7-aff6-1927427211d8"},"outputs":[{"data":{"text/plain":["0.4895833333333333"]},"execution_count":61,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":62,"metadata":{"executionInfo":{"elapsed":347541,"status":"ok","timestamp":1606854858765,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"88KOXS3VXfw2"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":63,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":347533,"status":"ok","timestamp":1606854858769,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"bImXksWpXfw2","outputId":"63ded7e6-529e-4b68-a03c-b91707769aaf"},"outputs":[{"data":{"text/plain":["array([0.06666667, 0.13333333, 0.08333333, 0.1       , 0.23333333,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":63,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":64,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":347523,"status":"ok","timestamp":1606854858770,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QWbqk81KXfw2","outputId":"b963099b-5c49-4679-f7c9-49d026d91d69"},"outputs":[{"data":{"text/plain":["0.10625000000000001"]},"execution_count":64,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":65,"metadata":{"executionInfo":{"elapsed":347512,"status":"ok","timestamp":1606854858770,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"gvhldUdEXfw2"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":65,"metadata":{"executionInfo":{"elapsed":347501,"status":"ok","timestamp":1606854858771,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ryKXIhosWkY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":65,"metadata":{"executionInfo":{"elapsed":347481,"status":"ok","timestamp":1606854858771,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LuqDNEUVXem2"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8Z7a-FGHoSKO"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Wjkj4swhXhgq"},"source":["##### Training"]},{"cell_type":"code","execution_count":66,"metadata":{"executionInfo":{"elapsed":347469,"status":"ok","timestamp":1606854858772,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"eWJfI5YnPPzE"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":67,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":458848,"status":"ok","timestamp":1606854970163,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-QFW2J0HPPzE","outputId":"b5b5b86b-5a06-494e-9adf-2cf5e7af96ee"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.10833333333333334\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:  1.5min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.11875\n","Improvement of 9.615384615384606% relative to the initial model\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":68,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":458837,"status":"ok","timestamp":1606854970164,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Diwlgrr6PPzE","outputId":"ef23be17-facf-48ea-a9dd-e3c297db7301"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":68,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":68,"metadata":{"executionInfo":{"elapsed":458825,"status":"ok","timestamp":1606854970164,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"p_zezBW2SWjz"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"rjvf3p9eXkKN"},"source":["##### Test"]},{"cell_type":"code","execution_count":69,"metadata":{"executionInfo":{"elapsed":467258,"status":"ok","timestamp":1606854978610,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Nic0nOPtXkKN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":70,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":467251,"status":"ok","timestamp":1606854978615,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"J-OqyJx4XkKO","outputId":"a986dc43-fedc-44ac-cf08-92a9538e2579"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.45833333, 0.53333333, 0.475     ])"]},"execution_count":70,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":71,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":467239,"status":"ok","timestamp":1606854978616,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"I2V919yeXkKO","outputId":"891a65d0-67d6-47ca-f313-240b4ca01488"},"outputs":[{"data":{"text/plain":["0.4833333333333334"]},"execution_count":71,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":72,"metadata":{"executionInfo":{"elapsed":472025,"status":"ok","timestamp":1606854983413,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CQo-9ubKXkKO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":73,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":472016,"status":"ok","timestamp":1606854983416,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YTzKNz4rXkKO","outputId":"a7db8ade-4c53-41cb-e599-626357ffab17"},"outputs":[{"data":{"text/plain":["array([0.14166667, 0.15      , 0.11666667, 0.125     ])"]},"execution_count":73,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":74,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":472005,"status":"ok","timestamp":1606854983416,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"2GWAFm_6XkKO","outputId":"b4804ec3-151d-4150-b486-35ee34139688"},"outputs":[{"data":{"text/plain":["0.13333333333333333"]},"execution_count":74,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":74,"metadata":{"executionInfo":{"elapsed":471994,"status":"ok","timestamp":1606854983417,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-c5IHn17XkKO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":75,"metadata":{"executionInfo":{"elapsed":491997,"status":"ok","timestamp":1606855003431,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Okf-45vIXkKO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":76,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":491988,"status":"ok","timestamp":1606855003433,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HfQ03o7aXkKO","outputId":"fd932038-06c7-4f45-ea98-a9616cf354a2"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.48333333, 0.48333333, 0.48333333, 0.51666667,\n","       0.51666667, 0.58333333, 0.51666667])"]},"execution_count":76,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":77,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":491977,"status":"ok","timestamp":1606855003434,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5XRG6jEEXkKO","outputId":"42638e8e-aaa9-463f-92be-92a27dfffa23"},"outputs":[{"data":{"text/plain":["0.5145833333333334"]},"execution_count":77,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":78,"metadata":{"executionInfo":{"elapsed":512075,"status":"ok","timestamp":1606855023543,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7-0CnEaYXkKO"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":79,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":512071,"status":"ok","timestamp":1606855023551,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-0quuBcgXkKO","outputId":"9334c315-7355-4ff4-b96e-707eac82b2ea"},"outputs":[{"data":{"text/plain":["array([0.06666667, 0.13333333, 0.08333333, 0.1       , 0.23333333,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":79,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":80,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":512061,"status":"ok","timestamp":1606855023552,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"X16n6fn-XkKO","outputId":"dc4548f6-b0f1-4715-9d6c-4b8d6a89c2c6"},"outputs":[{"data":{"text/plain":["0.10625000000000001"]},"execution_count":80,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":81,"metadata":{"executionInfo":{"elapsed":512050,"status":"ok","timestamp":1606855023552,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"UDRY8j-5XkKO"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":81,"metadata":{"executionInfo":{"elapsed":512039,"status":"ok","timestamp":1606855023553,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Lja4q_wLTg0R"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":81,"metadata":{"executionInfo":{"elapsed":512029,"status":"ok","timestamp":1606855023554,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"stZ6DO2sThIc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"TTW32YjnxcFK"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"mvKVuHmJxcFL"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"JYV5csm3xcFL"},"source":["##### Training"]},{"cell_type":"code","execution_count":82,"metadata":{"executionInfo":{"elapsed":512018,"status":"ok","timestamp":1606855023555,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"OzOIKjnrxcFL"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":83,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":564364,"status":"ok","timestamp":1606855075912,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ugzTVwdBxcFL","outputId":"856991b7-4ada-475b-f7ed-2aacaf772fa0"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48125000000000007\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:   41.6s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5208333333333333\n","Improvement of 8.225108225108196% relative to the initial model\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":84,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":564349,"status":"ok","timestamp":1606855075913,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BcoF6XGAxcFL","outputId":"9cad4261-0204-4d98-a9c0-768a8ec978b8"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":84,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":84,"metadata":{"executionInfo":{"elapsed":564335,"status":"ok","timestamp":1606855075914,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Gz3DAOnAxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"MU1PmbLuxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":85,"metadata":{"executionInfo":{"elapsed":572745,"status":"ok","timestamp":1606855084340,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"R_IY4nR0xcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":86,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":572736,"status":"ok","timestamp":1606855084343,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LXgqGhMMxcFM","outputId":"2e4662b8-ceb7-4133-9414-92e00e5054a2"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.49166667, 0.50833333, 0.525     ])"]},"execution_count":86,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":87,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":572726,"status":"ok","timestamp":1606855084344,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cQSax0c_xcFM","outputId":"2ada582d-37b6-4f77-cd38-a8154fe804ca"},"outputs":[{"data":{"text/plain":["0.5020833333333333"]},"execution_count":87,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":88,"metadata":{"executionInfo":{"elapsed":576594,"status":"ok","timestamp":1606855088223,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"B6QFFuZoxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":89,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":576587,"status":"ok","timestamp":1606855088226,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jpdF-f29xcFM","outputId":"216adc90-d816-44da-8546-058d47f9edea"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.15      , 0.11666667, 0.125     ])"]},"execution_count":89,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":90,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":576577,"status":"ok","timestamp":1606855088227,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tWt6NvLnxcFM","outputId":"d66cb6fa-e37d-4a6c-ceae-64512feb0e06"},"outputs":[{"data":{"text/plain":["0.13541666666666666"]},"execution_count":90,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":90,"metadata":{"executionInfo":{"elapsed":576568,"status":"ok","timestamp":1606855088228,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"mrvkWQG2xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":91,"metadata":{"executionInfo":{"elapsed":597207,"status":"ok","timestamp":1606855108879,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"f6ono8bWxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":92,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":597200,"status":"ok","timestamp":1606855108883,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"opbGpr4qxcFM","outputId":"3c1f682d-3268-4075-b399-cf48c2801194"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.53333333, 0.45      , 0.45      , 0.56666667,\n","       0.48333333, 0.55      , 0.53333333])"]},"execution_count":92,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":93,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":597189,"status":"ok","timestamp":1606855108883,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"K1ZpmNBAxcFM","outputId":"360199d3-db75-4aa6-814e-bc40b53705ac"},"outputs":[{"data":{"text/plain":["0.5125000000000001"]},"execution_count":93,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":94,"metadata":{"executionInfo":{"elapsed":614995,"status":"ok","timestamp":1606855126700,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jm7mkIIdxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":95,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":614987,"status":"ok","timestamp":1606855126703,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"pvspMz5zxcFM","outputId":"c4b1b903-e97c-4040-f8d7-54921b277558"},"outputs":[{"data":{"text/plain":["array([0.1       , 0.16666667, 0.06666667, 0.1       , 0.26666667,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":95,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":96,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":614976,"status":"ok","timestamp":1606855126704,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xBjz_G5TxcFM","outputId":"d5b379e0-930e-45cc-f187-1eadc59a068e"},"outputs":[{"data":{"text/plain":["0.11666666666666667"]},"execution_count":96,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":97,"metadata":{"executionInfo":{"elapsed":614965,"status":"ok","timestamp":1606855126704,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"dC9pWR3WxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"XedkRZHwxcFM"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"9HiVDnozxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":98,"metadata":{"executionInfo":{"elapsed":614955,"status":"ok","timestamp":1606855126705,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uwuuHEYlxcFM"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":99,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":646327,"status":"ok","timestamp":1606855158089,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"l-XinugXxcFM","outputId":"2f8b67a1-53ca-45f4-c746-cfd7ad1a4a3a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.13333333333333333\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:   23.2s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.13541666666666666\n","Improvement of 1.5624999999999944% relative to the initial model\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":100,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":646317,"status":"ok","timestamp":1606855158090,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7tvjFgLoxcFM","outputId":"25e81a42-4f5f-4e3d-9156-13b5166d6def"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":100,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":100,"metadata":{"executionInfo":{"elapsed":646306,"status":"ok","timestamp":1606855158091,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"EbZRWXTwxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qEfs8n21xcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":101,"metadata":{"executionInfo":{"elapsed":654147,"status":"ok","timestamp":1606855165942,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QGT0CuzPxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":102,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":654137,"status":"ok","timestamp":1606855165944,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"O65IF5P6xcFM","outputId":"78cc5966-bbe2-4460-ae08-5388e747c6db"},"outputs":[{"data":{"text/plain":["array([0.41666667, 0.475     , 0.5       , 0.49166667])"]},"execution_count":102,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":103,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":654127,"status":"ok","timestamp":1606855165944,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"g135jDm3xcFM","outputId":"a192ff00-dd6f-451b-d4a3-9a65b75de6be"},"outputs":[{"data":{"text/plain":["0.4708333333333333"]},"execution_count":103,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":104,"metadata":{"executionInfo":{"elapsed":658549,"status":"ok","timestamp":1606855170376,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"U4ZzCpkwxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":105,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":658541,"status":"ok","timestamp":1606855170378,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ghEGnajnxcFM","outputId":"8cb396c1-a9f6-4f90-b607-eba222091643"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.15      , 0.11666667, 0.125     ])"]},"execution_count":105,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":106,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":658531,"status":"ok","timestamp":1606855170379,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1dQIJEXixcFM","outputId":"af325a60-28f3-4a3c-8716-23511f081a9b"},"outputs":[{"data":{"text/plain":["0.13541666666666666"]},"execution_count":106,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":106,"metadata":{"executionInfo":{"elapsed":658520,"status":"ok","timestamp":1606855170379,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8Bx9r41ixcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":107,"metadata":{"executionInfo":{"elapsed":678663,"status":"ok","timestamp":1606855190533,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_PSdLsDqxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":108,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":678656,"status":"ok","timestamp":1606855190537,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"r1C0gBd-xcFM","outputId":"d6a52a9f-d36f-4e2e-ed23-9fd28996d569"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.53333333, 0.41666667, 0.51666667, 0.48333333,\n","       0.4       , 0.48333333, 0.53333333])"]},"execution_count":108,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":109,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":678643,"status":"ok","timestamp":1606855190538,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sd_600a3xcFM","outputId":"ba2f36f7-6d34-4989-8917-7b71d49c9776"},"outputs":[{"data":{"text/plain":["0.48124999999999996"]},"execution_count":109,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":110,"metadata":{"executionInfo":{"elapsed":697608,"status":"ok","timestamp":1606855209515,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"NTsPzbnSxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":111,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":697601,"status":"ok","timestamp":1606855209519,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jb5RMb-pxcFM","outputId":"bd2addb9-1746-4d6c-b721-ac1dc0e6917b"},"outputs":[{"data":{"text/plain":["array([0.08333333, 0.16666667, 0.08333333, 0.1       , 0.26666667,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":111,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":112,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":697590,"status":"ok","timestamp":1606855209519,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sdOno854xcFM","outputId":"2738a6df-2f93-497d-8de7-4b882d364239"},"outputs":[{"data":{"text/plain":["0.11666666666666667"]},"execution_count":112,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":113,"metadata":{"executionInfo":{"elapsed":697579,"status":"ok","timestamp":1606855209520,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"awfIV9pZxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"3Km95QOvxcFM"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"4HGGgdeIxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":114,"metadata":{"executionInfo":{"elapsed":697568,"status":"ok","timestamp":1606855209520,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"oaYNByAsxcFM"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":115,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":821824,"status":"ok","timestamp":1606855333787,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"G63hlZ4kxcFM","outputId":"a7536c2e-e159-4a97-8097-f9dd97e3810d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48333333333333334\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:  1.7min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5270833333333333\n","Improvement of 9.051724137931037% relative to the initial model\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":116,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":821813,"status":"ok","timestamp":1606855333788,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PpMulicsxcFM","outputId":"bf8c7d05-742c-4d8d-8d88-7e975701c753"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":116,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":116,"metadata":{"executionInfo":{"elapsed":821802,"status":"ok","timestamp":1606855333788,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"gtkUY73bxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"4ad7FRzfxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":117,"metadata":{"executionInfo":{"elapsed":830939,"status":"ok","timestamp":1606855342936,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5Pi0us0CxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":118,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":830931,"status":"ok","timestamp":1606855342939,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"P2ReLTMmxcFM","outputId":"0597f1f5-6143-480f-c9d1-9dde5255450c"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.28333333])"]},"execution_count":118,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":119,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":830920,"status":"ok","timestamp":1606855342939,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zQe_P4vtxcFM","outputId":"c97d6f1c-c707-4e85-a72a-a6de98213895"},"outputs":[{"data":{"text/plain":["0.4291666666666667"]},"execution_count":119,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":120,"metadata":{"executionInfo":{"elapsed":834097,"status":"ok","timestamp":1606855346127,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-fLvGqsBxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":121,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":834089,"status":"ok","timestamp":1606855346130,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vH6BJYeCxcFM","outputId":"822a79cb-5755-4c6e-ca60-e251a7018e5c"},"outputs":[{"data":{"text/plain":["array([0.14166667, 0.15      , 0.11666667, 0.11666667])"]},"execution_count":121,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":122,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":834081,"status":"ok","timestamp":1606855346134,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"iWKygSBFxcFM","outputId":"ab38effb-695b-498a-d64b-d8f6b7358a1e"},"outputs":[{"data":{"text/plain":["0.13125"]},"execution_count":122,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":122,"metadata":{"executionInfo":{"elapsed":834070,"status":"ok","timestamp":1606855346134,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"H89-Ubk1xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":123,"metadata":{"executionInfo":{"elapsed":853910,"status":"ok","timestamp":1606855365986,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jystqc68xcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":124,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":853901,"status":"ok","timestamp":1606855365988,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"me7J6W3jxcFM","outputId":"7cfd2978-38ef-40e3-973e-63366808e6e5"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.7       , 0.73333333])"]},"execution_count":124,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":125,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":853891,"status":"ok","timestamp":1606855365990,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"b4GFz5MExcFM","outputId":"6de182f6-9406-4093-a8e2-24f168c351a2"},"outputs":[{"data":{"text/plain":["0.5333333333333333"]},"execution_count":125,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":126,"metadata":{"executionInfo":{"elapsed":872712,"status":"ok","timestamp":1606855384822,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xuQVuhiQxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":127,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":872705,"status":"ok","timestamp":1606855384827,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"laTiM7yyxcFM","outputId":"266f1d2e-0b6f-4d61-f809-dc041f2fa05d"},"outputs":[{"data":{"text/plain":["array([0.03333333, 0.08333333, 0.08333333, 0.1       , 0.1       ,\n","       0.08333333, 0.03333333, 0.06666667])"]},"execution_count":127,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":128,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":872696,"status":"ok","timestamp":1606855384829,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5YEpQA8MxcFM","outputId":"e18ebd54-a71d-443d-b775-5bcd19dde06a"},"outputs":[{"data":{"text/plain":["0.07291666666666667"]},"execution_count":128,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":129,"metadata":{"executionInfo":{"elapsed":872685,"status":"ok","timestamp":1606855384830,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"e9j2dV-0xcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":129,"metadata":{"executionInfo":{"elapsed":872675,"status":"ok","timestamp":1606855384831,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"In9JIEELxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":129,"metadata":{"executionInfo":{"elapsed":872665,"status":"ok","timestamp":1606855384832,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QBdhZ-WaxcFN"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"M_bDhah3xcFN"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"SB0mgXXvxcFN"},"source":["##### Training"]},{"cell_type":"code","execution_count":130,"metadata":{"executionInfo":{"elapsed":872654,"status":"ok","timestamp":1606855384832,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BqKnbg_JxcFN"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":131,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1000294,"status":"ok","timestamp":1606855512483,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DdLP80jqxcFN","outputId":"cb624921-ddef-4b2e-ffff-5237476ef178"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.11041666666666666\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:  1.5min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.11875\n","Improvement of 7.547169811320753% relative to the initial model\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":132,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1000284,"status":"ok","timestamp":1606855512484,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"O-pGzTR8xcFN","outputId":"0a73bf17-bb1c-4bc1-ed11-5491c12e15a3"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":132,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":132,"metadata":{"executionInfo":{"elapsed":1000274,"status":"ok","timestamp":1606855512485,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"mm_UBr-JxcFN"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"37SLrvJMxcFN"},"source":["##### Test"]},{"cell_type":"code","execution_count":133,"metadata":{"executionInfo":{"elapsed":1000702,"status":"ok","timestamp":1606855512924,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"UOiflGaYxcFN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":134,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1000692,"status":"ok","timestamp":1606855512925,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uSGfcU8QxcFN","outputId":"7df8024f-4187-4015-8c7f-f742255921cf"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.5       , 0.525     , 0.48333333])"]},"execution_count":134,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":135,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1000682,"status":"ok","timestamp":1606855512926,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xoi4Bd7NxcFN","outputId":"0ff98b5d-8f6e-4b83-a140-38d6d99b2f92"},"outputs":[{"data":{"text/plain":["0.5125"]},"execution_count":135,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":136,"metadata":{"executionInfo":{"elapsed":1000671,"status":"ok","timestamp":1606855512926,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"wNJLv2rYxcFN"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":137,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1000661,"status":"ok","timestamp":1606855512927,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"V7rgWJWOxcFN","outputId":"b51ba682-6a6a-4ef2-c4c1-e76e4eb9d902"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.15      , 0.11666667, 0.125     ])"]},"execution_count":137,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":138,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1000650,"status":"ok","timestamp":1606855512927,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VDh6BucmxcFN","outputId":"fa99b0a5-645f-432d-8f92-3ce579a382ac"},"outputs":[{"data":{"text/plain":["0.13541666666666666"]},"execution_count":138,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":138,"metadata":{"executionInfo":{"elapsed":1000639,"status":"ok","timestamp":1606855512928,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HUaF3tqAxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":139,"metadata":{"executionInfo":{"elapsed":1015079,"status":"ok","timestamp":1606855527379,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"EuutIIFXxcFN"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":140,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1015070,"status":"ok","timestamp":1606855527381,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RAi3g167xcFN","outputId":"f856a6da-f986-42fc-ad3e-0e015f2e5cc3"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.5       , 0.46666667, 0.46666667, 0.5       ,\n","       0.46666667, 0.6       , 0.45      ])"]},"execution_count":140,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":141,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1015060,"status":"ok","timestamp":1606855527382,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"qRf2KlHuxcFN","outputId":"8795d2a6-7efc-47c0-ffbc-f9deb6f159fd"},"outputs":[{"data":{"text/plain":["0.5020833333333333"]},"execution_count":141,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":142,"metadata":{"executionInfo":{"elapsed":1033833,"status":"ok","timestamp":1606855546166,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vc_-n4csxcFN"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":143,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1033826,"status":"ok","timestamp":1606855546170,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Jln-g212xcFN","outputId":"2f7669af-700a-4260-c3a6-3ac54678b59a"},"outputs":[{"data":{"text/plain":["array([0.08333333, 0.16666667, 0.08333333, 0.1       , 0.26666667,\n","       0.11666667, 0.05      , 0.06666667])"]},"execution_count":143,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":144,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1033816,"status":"ok","timestamp":1606855546171,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tlOVYKDCxcFN","outputId":"2c734156-5a2c-4a95-8a5a-b39c438d7a75"},"outputs":[{"data":{"text/plain":["0.11666666666666667"]},"execution_count":144,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":145,"metadata":{"executionInfo":{"elapsed":1033804,"status":"ok","timestamp":1606855546171,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VIaGLGWLxcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":145,"metadata":{"executionInfo":{"elapsed":1033794,"status":"ok","timestamp":1606855546172,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"i80BGb95xcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":145,"metadata":{"executionInfo":{"elapsed":1033783,"status":"ok","timestamp":1606855546172,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"eo8YKpR5ThY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":145,"metadata":{"executionInfo":{"elapsed":1033772,"status":"ok","timestamp":1606855546173,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"oqugS205TiTt"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qeEgWCblzQnP"},"source":["## Non Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"5GSv6mzky38n"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"7oULTVbEPi_U"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"0Cne7taDXqB-"},"source":["##### Training"]},{"cell_type":"code","execution_count":146,"metadata":{"executionInfo":{"elapsed":1033759,"status":"ok","timestamp":1606855546173,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"dq07br9mPi_U"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":147,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1213184,"status":"ok","timestamp":1606855725610,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1V8keujMPi_U","outputId":"1101835e-1256-4e81-e3b5-f79bdf7fb4c0"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.475\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  2.9min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 15.789473684210542% relative to the initial model\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":148,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1213174,"status":"ok","timestamp":1606855725612,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0gD5AkJMPi_U","outputId":"9c9b8c9a-1b1f-46bd-c7b7-02076df2dca2"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":148,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":148,"metadata":{"executionInfo":{"elapsed":1213163,"status":"ok","timestamp":1606855725612,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XxxGNCDDPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"R-4wu13DXt7S"},"source":["##### Test"]},{"cell_type":"code","execution_count":149,"metadata":{"executionInfo":{"elapsed":1215604,"status":"ok","timestamp":1606855728064,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"2zxO36oNXt7S"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":150,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1215587,"status":"ok","timestamp":1606855728066,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fsWhol8YXt7S","outputId":"125c57d0-1618-4c86-b3fe-499256223857"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.39166667, 0.5       , 0.475     ])"]},"execution_count":150,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":151,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1215576,"status":"ok","timestamp":1606855728067,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ymPirDLmXt7S","outputId":"14ead2a9-62f9-4990-e192-15541bc32a9d"},"outputs":[{"data":{"text/plain":["0.475"]},"execution_count":151,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":152,"metadata":{"executionInfo":{"elapsed":1217816,"status":"ok","timestamp":1606855730319,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"T0ta4ssHXt7S"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":153,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1217807,"status":"ok","timestamp":1606855730322,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1RjKwn0pXt7S","outputId":"3a0ff753-0dcc-4c6f-e04d-34233350e918"},"outputs":[{"data":{"text/plain":["array([0.275     , 0.26666667, 0.24166667, 0.19166667])"]},"execution_count":153,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":154,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1217796,"status":"ok","timestamp":1606855730322,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CIBOvXeDXt7S","outputId":"83a30662-c4ab-4ef9-a15c-74bb3441a41f"},"outputs":[{"data":{"text/plain":["0.24375000000000002"]},"execution_count":154,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":154,"metadata":{"executionInfo":{"elapsed":1217786,"status":"ok","timestamp":1606855730323,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1aTV6PZfXt7S"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":155,"metadata":{"executionInfo":{"elapsed":1222669,"status":"ok","timestamp":1606855735218,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"NNnTNmeiXt7S"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":156,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1222664,"status":"ok","timestamp":1606855735224,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XPMCwPjQXt7S","outputId":"6b3c67bc-13c3-4e43-d6e1-271c4838f713"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.35      , 0.5       , 0.51666667,\n","       0.55      , 0.53333333, 0.55      ])"]},"execution_count":156,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":157,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1222652,"status":"ok","timestamp":1606855735226,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DRVwsyQLXt7S","outputId":"289ede72-bd59-42fa-ce63-2c16ab970265"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":157,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":158,"metadata":{"executionInfo":{"elapsed":1227665,"status":"ok","timestamp":1606855740251,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vinSE87gXt7S"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":159,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1227657,"status":"ok","timestamp":1606855740255,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xOuNRJLdXt7S","outputId":"45916e3d-a646-44a1-9d70-9df23d7ad2c2"},"outputs":[{"data":{"text/plain":["array([0.18333333, 0.26666667, 0.3       , 0.18333333, 0.2       ,\n","       0.26666667, 0.15      , 0.11666667])"]},"execution_count":159,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":160,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1227645,"status":"ok","timestamp":1606855740255,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"d4xnl7FcXt7S","outputId":"0912e6c8-2c17-4e33-d6f7-837d9a135bff"},"outputs":[{"data":{"text/plain":["0.20833333333333331"]},"execution_count":160,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":161,"metadata":{"executionInfo":{"elapsed":1227634,"status":"ok","timestamp":1606855740256,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"eFy5EJT0Xt7S"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":161,"metadata":{"executionInfo":{"elapsed":1227622,"status":"ok","timestamp":1606855740256,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"l0KvHb0QXogu"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0Zs6BKtdPi_U"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"8EAYpz-HXvUg"},"source":["##### Training"]},{"cell_type":"code","execution_count":162,"metadata":{"executionInfo":{"elapsed":1227612,"status":"ok","timestamp":1606855740257,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CL0ybWLcPi_U"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":163,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1412000,"status":"ok","timestamp":1606855924657,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IktxzifQPi_U","outputId":"487f3563-59da-430b-f44d-7c8bf7445c8b"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.24375000000000002\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  3.0min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.6895833333333334\n","Improvement of 182.9059829059829% relative to the initial model\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":164,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1411990,"status":"ok","timestamp":1606855924659,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_P-nox5XPi_U","outputId":"ed8930ca-cb92-4c81-b518-054ffe79c086"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":164,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":164,"metadata":{"executionInfo":{"elapsed":1412276,"status":"ok","timestamp":1606855924956,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tWvOHDWQPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0198Uz5fXzwU"},"source":["##### Test"]},{"cell_type":"code","execution_count":165,"metadata":{"executionInfo":{"elapsed":1414121,"status":"ok","timestamp":1606855926813,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RyahliyLXzwU"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":166,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1414114,"status":"ok","timestamp":1606855926817,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zehjkRXnXzwU","outputId":"98a679b1-b619-45a5-b83f-af5616a8eb27"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.39166667, 0.5       , 0.475     ])"]},"execution_count":166,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":167,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1414103,"status":"ok","timestamp":1606855926817,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WuJ2osi6XzwU","outputId":"d2843075-4bad-46ea-b887-42f78353e104"},"outputs":[{"data":{"text/plain":["0.475"]},"execution_count":167,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":168,"metadata":{"executionInfo":{"elapsed":1415750,"status":"ok","timestamp":1606855928475,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Ci44W-T2XzwU"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":169,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1415743,"status":"ok","timestamp":1606855928479,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vK4IjAABXzwU","outputId":"8622ac35-36d1-4a35-d892-9ecde54a79ca"},"outputs":[{"data":{"text/plain":["array([0.275     , 0.26666667, 0.24166667, 0.19166667])"]},"execution_count":169,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":170,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1415732,"status":"ok","timestamp":1606855928480,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xhWy-ohdXzwU","outputId":"cbee0d47-348d-442a-ad13-92d3ac4df081"},"outputs":[{"data":{"text/plain":["0.24375000000000002"]},"execution_count":170,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":170,"metadata":{"executionInfo":{"elapsed":1415722,"status":"ok","timestamp":1606855928481,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CF7JcIMjXzwU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":171,"metadata":{"executionInfo":{"elapsed":1420691,"status":"ok","timestamp":1606855933462,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"2oIQ_WXQXzwU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":172,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1420683,"status":"ok","timestamp":1606855933465,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"UzV889JxXzwU","outputId":"2a326171-808e-4074-9e0e-ab0cec2f5fbb"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.35      , 0.5       , 0.51666667,\n","       0.55      , 0.53333333, 0.55      ])"]},"execution_count":172,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":173,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1420672,"status":"ok","timestamp":1606855933466,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yL2hPRGYXzwU","outputId":"6a4b73b0-ff8e-4f4e-d0af-2c057bf80ca7"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":173,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":174,"metadata":{"executionInfo":{"elapsed":1425946,"status":"ok","timestamp":1606855938751,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-66NgtuSXzwU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":175,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1425941,"status":"ok","timestamp":1606855938757,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WuB0T_n2XzwU","outputId":"31b11865-d9ef-4d24-a996-68527fced174"},"outputs":[{"data":{"text/plain":["array([0.18333333, 0.26666667, 0.3       , 0.18333333, 0.2       ,\n","       0.26666667, 0.15      , 0.11666667])"]},"execution_count":175,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":176,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1425935,"status":"ok","timestamp":1606855938763,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tKTaDJrDXzwU","outputId":"c733ce57-2812-45b3-f0d4-6e6a49e70cdd"},"outputs":[{"data":{"text/plain":["0.20833333333333331"]},"execution_count":176,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":177,"metadata":{"executionInfo":{"elapsed":1425925,"status":"ok","timestamp":1606855938764,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cn3af9g-XzwU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uDs9TYKhPi_U"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"egAIdkvWX28i"},"source":["##### Training"]},{"cell_type":"code","execution_count":178,"metadata":{"executionInfo":{"elapsed":1425915,"status":"ok","timestamp":1606855938765,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TC4Zs4C_Pi_U"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":179,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1872211,"status":"ok","timestamp":1606856385072,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yYH5CASnPi_U","outputId":"d92ec3c6-356d-424b-9bea-ed855c54caa9"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5041666666666667\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  7.3min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 9.090909090909102% relative to the initial model\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":180,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1872202,"status":"ok","timestamp":1606856385074,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Gew_wB7pPi_U","outputId":"fa6c0d2e-535d-41c4-9798-c89f9f83bb67"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":180,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":180,"metadata":{"executionInfo":{"elapsed":1872190,"status":"ok","timestamp":1606856385074,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"unaQIpFcPi_V"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"nwAyHju5X6vP"},"source":["##### Test"]},{"cell_type":"code","execution_count":181,"metadata":{"executionInfo":{"elapsed":1874558,"status":"ok","timestamp":1606856387453,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ZPOKqFjRX6vP"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":182,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1874551,"status":"ok","timestamp":1606856387457,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fupMQc6EX6vP","outputId":"c051ca58-2c02-4ec2-b23c-f9660ecca6a4"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.39166667, 0.5       , 0.475     ])"]},"execution_count":182,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":183,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1874539,"status":"ok","timestamp":1606856387457,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"M1CThpvVX6vP","outputId":"01cf5f82-5d00-4b8f-a2e8-43feb85c16b7"},"outputs":[{"data":{"text/plain":["0.475"]},"execution_count":183,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":184,"metadata":{"executionInfo":{"elapsed":1876893,"status":"ok","timestamp":1606856389822,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9_gWEv7sX6vP"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":185,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1876886,"status":"ok","timestamp":1606856389826,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fiy7W5ffX6vP","outputId":"fe0b3276-8b94-4b1e-e503-fcc4573d750a"},"outputs":[{"data":{"text/plain":["array([0.275     , 0.26666667, 0.24166667, 0.19166667])"]},"execution_count":185,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":186,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1876875,"status":"ok","timestamp":1606856389827,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"lkjknhMeX6vP","outputId":"2f844135-c6fd-4d9f-884c-0d2ef9b86368"},"outputs":[{"data":{"text/plain":["0.24375000000000002"]},"execution_count":186,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":186,"metadata":{"executionInfo":{"elapsed":1876865,"status":"ok","timestamp":1606856389828,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FTXiBdQLX6vP"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":187,"metadata":{"executionInfo":{"elapsed":1881205,"status":"ok","timestamp":1606856394179,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"t1r-sdlxX6vP"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":188,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1881195,"status":"ok","timestamp":1606856394180,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CWGMzyK-X6vP","outputId":"0b0dbee9-30eb-4460-8964-dc84cf59eb2f"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.35      , 0.5       , 0.51666667,\n","       0.55      , 0.53333333, 0.55      ])"]},"execution_count":188,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":189,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1881185,"status":"ok","timestamp":1606856394181,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"H0zLw18oX6vP","outputId":"26f10995-8f9e-48ed-ae07-c810ec7710ee"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":189,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":190,"metadata":{"executionInfo":{"elapsed":1886708,"status":"ok","timestamp":1606856399715,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"A8T5rsMmX6vP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":191,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1886702,"status":"ok","timestamp":1606856399721,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"M_t4UF1DX6vP","outputId":"6c06b6d1-f6ad-48b1-92d6-fda44c635ab0"},"outputs":[{"data":{"text/plain":["array([0.18333333, 0.26666667, 0.3       , 0.18333333, 0.2       ,\n","       0.26666667, 0.15      , 0.11666667])"]},"execution_count":191,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":192,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1886691,"status":"ok","timestamp":1606856399721,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0fJTTwT7X6vP","outputId":"68ca9f77-ad3f-4346-c477-f35679629468"},"outputs":[{"data":{"text/plain":["0.20833333333333331"]},"execution_count":192,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":193,"metadata":{"executionInfo":{"elapsed":1886682,"status":"ok","timestamp":1606856399723,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1jmvoITgX6vP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"9GrSc9C_Pi_V"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"kD81hURuX8Gq"},"source":["##### Training"]},{"cell_type":"code","execution_count":194,"metadata":{"executionInfo":{"elapsed":1886674,"status":"ok","timestamp":1606856399726,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VvTPL3JlPi_V"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":195,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2345835,"status":"ok","timestamp":1606856858899,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VrRmVRDrPi_V","outputId":"80472581-736d-40a9-a9cf-1362bd86fa39"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.20833333333333331\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  7.6min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.8416666666666666\n","Improvement of 304.0% relative to the initial model\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":196,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":2345826,"status":"ok","timestamp":1606856858901,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"T_4U6bROPi_V","outputId":"eb753545-28f7-497d-fa7b-c0d772b0745a"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":196,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":196,"metadata":{"executionInfo":{"elapsed":2345815,"status":"ok","timestamp":1606856858902,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jvvT0I2zA-tR"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"NBFCHmpSX_fT"},"source":["##### Test"]},{"cell_type":"code","execution_count":197,"metadata":{"executionInfo":{"elapsed":2347905,"status":"ok","timestamp":1606856861002,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FpOCGtljX_fT"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":198,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2347897,"status":"ok","timestamp":1606856861005,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7Qyp61qCX_fT","outputId":"41d72343-968b-4cc0-b0e4-ab410a92f308"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.39166667, 0.5       , 0.475     ])"]},"execution_count":198,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":199,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2347887,"status":"ok","timestamp":1606856861006,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aIXn6G0DX_fT","outputId":"dfdc8bda-f3a3-4f5c-d757-6b97923f38fa"},"outputs":[{"data":{"text/plain":["0.475"]},"execution_count":199,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":200,"metadata":{"executionInfo":{"elapsed":2350039,"status":"ok","timestamp":1606856863169,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Cd88yjZ2X_fT"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":201,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2350034,"status":"ok","timestamp":1606856863175,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TBGK1CCwX_fT","outputId":"9772f289-e002-4caf-b6a9-021d1e82110b"},"outputs":[{"data":{"text/plain":["array([0.275     , 0.26666667, 0.24166667, 0.19166667])"]},"execution_count":201,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":202,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2350024,"status":"ok","timestamp":1606856863176,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YrWrvhkgX_fT","outputId":"11083229-8868-4027-c090-e1dedfa6c86e"},"outputs":[{"data":{"text/plain":["0.24375000000000002"]},"execution_count":202,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":202,"metadata":{"executionInfo":{"elapsed":2350014,"status":"ok","timestamp":1606856863177,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AxSU-XfPX_fU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":203,"metadata":{"executionInfo":{"elapsed":2355163,"status":"ok","timestamp":1606856868337,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AmBIkKpYX_fU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":204,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2355159,"status":"ok","timestamp":1606856868344,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_V5IbN68X_fU","outputId":"c03d2041-995a-4dc3-b786-369a0beebd9e"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.35      , 0.5       , 0.51666667,\n","       0.55      , 0.53333333, 0.55      ])"]},"execution_count":204,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":205,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2355149,"status":"ok","timestamp":1606856868345,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TWaCN8l7X_fU","outputId":"8238a421-439c-497e-8c18-5ba00b8dfdb2"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":205,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":206,"metadata":{"executionInfo":{"elapsed":2360162,"status":"ok","timestamp":1606856873369,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"syrzAL9rX_fU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":207,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2360154,"status":"ok","timestamp":1606856873372,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"NsiBn2glX_fU","outputId":"5a995dd2-9d69-48f5-f8fb-605a3b1792d8"},"outputs":[{"data":{"text/plain":["array([0.18333333, 0.26666667, 0.3       , 0.18333333, 0.2       ,\n","       0.26666667, 0.15      , 0.11666667])"]},"execution_count":207,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":208,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2360143,"status":"ok","timestamp":1606856873372,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LtMnsPToX_fU","outputId":"078b08ff-a115-4ada-ee3c-ed5b9b3b1a82"},"outputs":[{"data":{"text/plain":["0.20833333333333331"]},"execution_count":208,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":209,"metadata":{"executionInfo":{"elapsed":2360133,"status":"ok","timestamp":1606856873373,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0DqFlfKnX_fU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"8XqHy9Y-zFbi"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"7JuJVcluzKap"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"nDanBmu2zKap"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"vXdh3OxCzKap"},"source":["##### Training"]},{"cell_type":"code","execution_count":210,"metadata":{"executionInfo":{"elapsed":2360123,"status":"ok","timestamp":1606856873374,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"pMbR3zyvzKap"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":211,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2542950,"status":"ok","timestamp":1606857056212,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RQK687eXzKap","outputId":"31549a4b-19de-484b-d740-5f910424b5b2"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.475\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  3.0min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 15.789473684210542% relative to the initial model\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":212,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":2542941,"status":"ok","timestamp":1606857056214,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1GyuhQOqzKap","outputId":"99d90c4a-ea6f-40de-9b5d-72a75a57a769"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":212,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":212,"metadata":{"executionInfo":{"elapsed":2542932,"status":"ok","timestamp":1606857056216,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Hsydl9nEzKap"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"dZufsYMWzKap"},"source":["##### Test"]},{"cell_type":"code","execution_count":213,"metadata":{"executionInfo":{"elapsed":2544998,"status":"ok","timestamp":1606857058294,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"gYJcPYkvzKap"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":214,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2544988,"status":"ok","timestamp":1606857058295,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zwggFtqFzKap","outputId":"7eca5871-dd5d-456a-e14a-fd36e135e967"},"outputs":[{"data":{"text/plain":["array([0.59166667, 0.5       , 0.58333333, 0.525     ])"]},"execution_count":214,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":215,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2544978,"status":"ok","timestamp":1606857058296,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"170biW6UzKap","outputId":"9a90d108-799e-4786-efc0-319cb3429189"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":215,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":216,"metadata":{"executionInfo":{"elapsed":2546737,"status":"ok","timestamp":1606857060065,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BuJajI8CzKap"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":217,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2546728,"status":"ok","timestamp":1606857060069,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y9sBxOW3zKap","outputId":"71f4b9dc-997f-4bb2-8867-b98ac8f2099e"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.45      , 0.4       , 0.50833333])"]},"execution_count":217,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":218,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2546718,"status":"ok","timestamp":1606857060070,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Tu78PjDEzKap","outputId":"c6f92b9c-5050-4292-9e02-9da49749c2c1"},"outputs":[{"data":{"text/plain":["0.4770833333333333"]},"execution_count":218,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":218,"metadata":{"executionInfo":{"elapsed":2546708,"status":"ok","timestamp":1606857060071,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"p5O7LCZUzKaq"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":219,"metadata":{"executionInfo":{"elapsed":2551297,"status":"ok","timestamp":1606857064672,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"170jqf1TzKaq"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":220,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2551288,"status":"ok","timestamp":1606857064675,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"4TBwzEPazKaq","outputId":"236520a3-e1db-48bb-da73-8d959e841ecf"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.53333333, 0.36666667, 0.53333333, 0.6       ,\n","       0.58333333, 0.55      , 0.48333333])"]},"execution_count":220,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":221,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2551277,"status":"ok","timestamp":1606857064675,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AHSEfnC1zKaq","outputId":"ed81b05a-b6fc-44df-b9a5-cda4b741ea5a"},"outputs":[{"data":{"text/plain":["0.5270833333333333"]},"execution_count":221,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":222,"metadata":{"executionInfo":{"elapsed":2555796,"status":"ok","timestamp":1606857069206,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ObGDJizAzKaq"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":223,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2555791,"status":"ok","timestamp":1606857069213,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"j_N2tqWwzKaq","outputId":"286450cc-ee44-497d-9085-644b8327b165"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.43333333, 0.51666667, 0.45      , 0.46666667,\n","       0.43333333, 0.48333333, 0.53333333])"]},"execution_count":223,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":224,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2555781,"status":"ok","timestamp":1606857069214,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IASR2chPzKaq","outputId":"eb66c5d5-bddf-4231-e54a-3bd803d05acf"},"outputs":[{"data":{"text/plain":["0.48333333333333334"]},"execution_count":224,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":225,"metadata":{"executionInfo":{"elapsed":2555770,"status":"ok","timestamp":1606857069215,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DgeJt--bzKaq"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":225,"metadata":{"executionInfo":{"elapsed":2555757,"status":"ok","timestamp":1606857069215,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TD-U3cR1zKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ARh3tG3HzKaq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"wN2hsHGBzKaq"},"source":["##### Training"]},{"cell_type":"code","execution_count":226,"metadata":{"executionInfo":{"elapsed":2555746,"status":"ok","timestamp":1606857069216,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"skUAhYgczKaq"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":227,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2668,"status":"ok","timestamp":1606857256333,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cwJeDc5FzKaq","outputId":"912ec33e-2cb2-4d1e-b511-e606e4edeae4"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.24375000000000002\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:  3.0min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.6895833333333334\n","Improvement of 182.9059829059829% relative to the initial model\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":228,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":39,"status":"ok","timestamp":1606857256334,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7T6L3cEMzKaq","outputId":"c322fc75-cd98-4ad9-d547-0a23531181af"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":228,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":228,"metadata":{"executionInfo":{"elapsed":23,"status":"ok","timestamp":1606857256334,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"s-0TYEKRzKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Q-8Wu0mFzKaq"},"source":["##### Test"]},{"cell_type":"code","execution_count":229,"metadata":{"executionInfo":{"elapsed":1103,"status":"ok","timestamp":1606857257429,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1JuAwv7xzKar"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":230,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":89,"status":"ok","timestamp":1606857257429,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"3vVCBJB-zKar","outputId":"b3fc5284-9a08-4a3e-fc1a-51c925cf8636"},"outputs":[{"data":{"text/plain":["array([0.45833333, 0.525     , 0.48333333, 0.53333333])"]},"execution_count":230,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":231,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":72,"status":"ok","timestamp":1606857257430,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VMeANNU5zKar","outputId":"bb52c177-858c-4440-d689-d5f8ff19a280"},"outputs":[{"data":{"text/plain":["0.5"]},"execution_count":231,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":233,"metadata":{"executionInfo":{"elapsed":5107,"status":"ok","timestamp":1606857941913,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"S1WpU5CMzKar"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":234,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6374,"status":"ok","timestamp":1606857943232,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5TeGAl1HzKar","outputId":"91aaaf6d-49be-4098-8301-18ede76af30e"},"outputs":[{"data":{"text/plain":["array([0.65833333, 0.71666667, 0.68333333, 0.7       ])"]},"execution_count":234,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":235,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6359,"status":"ok","timestamp":1606857943233,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"6YnwjHF0zKar","outputId":"8a95904d-a9bf-4703-9c18-47b1157319ae"},"outputs":[{"data":{"text/plain":["0.6895833333333334"]},"execution_count":235,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":235,"metadata":{"executionInfo":{"elapsed":6347,"status":"ok","timestamp":1606857943234,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"lq8oWJXFzKar"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":236,"metadata":{"executionInfo":{"elapsed":10336,"status":"ok","timestamp":1606857947235,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_BRFekOUzKar"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":237,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10325,"status":"ok","timestamp":1606857947236,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"toTnrmmlzKar","outputId":"82ea46f5-1e6f-4d73-e0bc-cb81abade939"},"outputs":[{"data":{"text/plain":["array([0.4       , 0.48333333, 0.45      , 0.46666667, 0.55      ,\n","       0.45      , 0.48333333, 0.46666667])"]},"execution_count":237,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":238,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10311,"status":"ok","timestamp":1606857947236,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kKc0nDGCzKar","outputId":"c21001e4-a228-4f26-854a-d2c8e08ff49a"},"outputs":[{"data":{"text/plain":["0.46875"]},"execution_count":238,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":239,"metadata":{"executionInfo":{"elapsed":13955,"status":"ok","timestamp":1606857950892,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"OOMuvs-pzKar"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":240,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13944,"status":"ok","timestamp":1606857950893,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"wjRpb8NBzKar","outputId":"44f187f9-a6e7-437d-b6e1-283cc131ae25"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.63333333, 0.7       , 0.63333333, 0.6       ,\n","       0.71666667, 0.66666667, 0.73333333])"]},"execution_count":240,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":241,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13925,"status":"ok","timestamp":1606857950893,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"r53hIRRXzKar","outputId":"ecd6a1a7-93c4-4d91-b7c9-f2d35bb15cbe"},"outputs":[{"data":{"text/plain":["0.6645833333333333"]},"execution_count":241,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":242,"metadata":{"executionInfo":{"elapsed":13914,"status":"ok","timestamp":1606857950893,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VRxmvc-wzKar"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"LL4QioxhzKar"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dsa5s6NCzKar"},"source":["##### Training"]},{"cell_type":"code","execution_count":243,"metadata":{"executionInfo":{"elapsed":13903,"status":"ok","timestamp":1606857950894,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YhmSCPQKzKar"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":244,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":460011,"status":"ok","timestamp":1606858397015,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"x3s1ZBelzKas","outputId":"0269b50f-40e9-41f1-d09a-fcb08062237b"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5041666666666667\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  7.3min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 9.090909090909102% relative to the initial model\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":245,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":459999,"status":"ok","timestamp":1606858397017,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-_TCEZH-zKas","outputId":"1cceaa11-5aba-4648-c366-2d379556f50c"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":245,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":245,"metadata":{"executionInfo":{"elapsed":459987,"status":"ok","timestamp":1606858397017,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"oSYzxqW7zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8vgsOGsMzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":246,"metadata":{"executionInfo":{"elapsed":460774,"status":"ok","timestamp":1606858397815,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YROEJvQ5zKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":247,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":460763,"status":"ok","timestamp":1606858397816,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VAcVTmDZzKas","outputId":"8d4d377c-06cc-45fa-dcc6-c574bd6d11a8"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":247,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":248,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":460753,"status":"ok","timestamp":1606858397817,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JTR8dtFxzKas","outputId":"bbb1d4f4-dfbf-4163-a5ca-4024fb7bbc85"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":248,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":249,"metadata":{"executionInfo":{"elapsed":463728,"status":"ok","timestamp":1606858400802,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AphSBh3YzKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":250,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":463717,"status":"ok","timestamp":1606858400803,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"c1VcemIGzKas","outputId":"cd3f036b-6bd8-4b5d-c677-26e4ab3fa1a2"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.61666667, 0.53333333])"]},"execution_count":250,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":251,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":463705,"status":"ok","timestamp":1606858400804,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Mw8VKeX8zKas","outputId":"e6354027-cea6-4499-898f-482906920509"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":251,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":251,"metadata":{"executionInfo":{"elapsed":463693,"status":"ok","timestamp":1606858400804,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"F81q7WTjzKas"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":252,"metadata":{"executionInfo":{"elapsed":467690,"status":"ok","timestamp":1606858404811,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WJ_jCgPzzKas"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":253,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":467677,"status":"ok","timestamp":1606858404813,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DQYfT2OlzKas","outputId":"6e3e24db-228a-412e-a362-f25c6adb2d22"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":253,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":254,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":467664,"status":"ok","timestamp":1606858404813,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Tc_SstgszKas","outputId":"a2505628-8dd5-4246-c896-cf1728d1746c"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":254,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":255,"metadata":{"executionInfo":{"elapsed":472395,"status":"ok","timestamp":1606858409556,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IoF9LLnOzKas"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":256,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":472381,"status":"ok","timestamp":1606858409557,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"a1wNxq3PzKas","outputId":"f8a7dbd4-866c-4ed8-b650-caa8ea6762ce"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.5       , 0.56666667, 0.63333333,\n","       0.6       , 0.53333333, 0.53333333])"]},"execution_count":256,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":257,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":472371,"status":"ok","timestamp":1606858409558,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"N9f3ydSCzKas","outputId":"5f3c9965-ac3f-4645-c3c4-86889fb40ba9"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":257,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":258,"metadata":{"executionInfo":{"elapsed":472361,"status":"ok","timestamp":1606858409559,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"F0bMKlgozKas"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"RSJKARRAzKas"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"mBL6Eax3zKas"},"source":["##### Training"]},{"cell_type":"code","execution_count":259,"metadata":{"executionInfo":{"elapsed":472349,"status":"ok","timestamp":1606858409559,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"iVOzO1_-zKas"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":260,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":928950,"status":"ok","timestamp":1606858866173,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Z765IlZJzKas","outputId":"d7e4a61d-71bb-4cab-d5fb-8eea7aff87d8"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.20833333333333331\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  7.5min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.8416666666666666\n","Improvement of 304.0% relative to the initial model\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":261,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":928941,"status":"ok","timestamp":1606858866176,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"S3UewluXzKas","outputId":"3f796411-1844-4acc-81a4-cfeb0b95d8df"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":261,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":261,"metadata":{"executionInfo":{"elapsed":928932,"status":"ok","timestamp":1606858866178,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_-LO0Fa5zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FY_4P1stzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":262,"metadata":{"executionInfo":{"elapsed":929941,"status":"ok","timestamp":1606858867202,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JtDObYhuzKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":263,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":929927,"status":"ok","timestamp":1606858867204,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hs5e3gDezKas","outputId":"dd30ff1a-961a-49f6-e714-46f4a372cdee"},"outputs":[{"data":{"text/plain":["array([0.50833333, 0.61666667, 0.55      , 0.36666667])"]},"execution_count":263,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":264,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":929914,"status":"ok","timestamp":1606858867205,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"V3t-_ciTzKas","outputId":"2dcb438b-eee7-4b16-9225-df88a6a0a259"},"outputs":[{"data":{"text/plain":["0.5104166666666666"]},"execution_count":264,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":265,"metadata":{"executionInfo":{"elapsed":932111,"status":"ok","timestamp":1606858869414,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Vj9bEfC_zKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":266,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":932102,"status":"ok","timestamp":1606858869416,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"GrtGNjnnzKat","outputId":"162b41ec-6005-48ae-a4a2-930ebf2aea71"},"outputs":[{"data":{"text/plain":["array([0.18333333, 0.15833333, 0.125     , 0.125     ])"]},"execution_count":266,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":267,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":932086,"status":"ok","timestamp":1606858869417,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tFlJd6qAzKat","outputId":"6f9870b5-3faf-45e0-ee06-2e50f3755a2b"},"outputs":[{"data":{"text/plain":["0.14791666666666667"]},"execution_count":267,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":267,"metadata":{"executionInfo":{"elapsed":932076,"status":"ok","timestamp":1606858869418,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VdR_va-kzKat"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":268,"metadata":{"executionInfo":{"elapsed":934432,"status":"ok","timestamp":1606858871785,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"mbAbJmqlzKat"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":269,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":934423,"status":"ok","timestamp":1606858871788,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IEV9F0VPzKat","outputId":"bd237726-c658-49af-d9b5-5e06e6869429"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.53333333, 0.58333333, 0.53333333, 0.56666667,\n","       0.51666667, 0.43333333, 0.41666667])"]},"execution_count":269,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":270,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":934411,"status":"ok","timestamp":1606858871789,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"j9nKepwezKat","outputId":"0e44fb57-0b65-42a6-de4d-5530809e0c68"},"outputs":[{"data":{"text/plain":["0.5104166666666667"]},"execution_count":270,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":271,"metadata":{"executionInfo":{"elapsed":940343,"status":"ok","timestamp":1606858877733,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_GK6yAx_zKat"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":272,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":940332,"status":"ok","timestamp":1606858877734,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"d05_H12ezKat","outputId":"c2b5495e-4a83-43ad-e917-3ff7e9159658"},"outputs":[{"data":{"text/plain":["array([0.86666667, 0.81666667, 0.85      , 0.85      , 0.78333333,\n","       0.86666667, 0.81666667, 0.88333333])"]},"execution_count":272,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":273,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":940320,"status":"ok","timestamp":1606858877735,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QJaiqkrezKat","outputId":"dc502f4c-77c5-4e4c-ad53-5a84b100d172"},"outputs":[{"data":{"text/plain":["0.8416666666666666"]},"execution_count":273,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":274,"metadata":{"executionInfo":{"elapsed":940307,"status":"ok","timestamp":1606858877737,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"KKwvhkyMzKat"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"gh0gtRO-D2F-"},"source":["## Random Forest Classifier"]},{"cell_type":"markdown","metadata":{"id":"8cap-uouzQCQ"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jr2mEagmPuxy"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"ZGtZPgTLYETt"},"source":["##### Training"]},{"cell_type":"code","execution_count":275,"metadata":{"executionInfo":{"elapsed":940296,"status":"ok","timestamp":1606858877739,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"le2W3NO8Puxy"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"gmkK8kiPPuxy"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.46458333333333335\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 337.3min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.49166666666666664\n","Improvement of 5.829596412556045% relative to the initial model\n"]}],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"WXLhC5g3Puxy"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"OSua_O1KPuxy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"uMyaSHdOYGtk"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cWwrGaApYGtk"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cJUw5awvYGtk"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.4       , 0.5       , 0.4       ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7JkBGvC5YGtk"},"outputs":[{"data":{"text/plain":["0.46458333333333335"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Xz6kWFe4YGtk"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"EXee_GspYGtk"},"outputs":[{"data":{"text/plain":["array([0.39166667, 0.44166667, 0.33333333, 0.38333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"h7X0yp_8YGtk"},"outputs":[{"data":{"text/plain":["0.38749999999999996"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VDD1dk-_YGtk"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jmXtWQZ_YGtk"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NRc_AIPLYGtk"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.51666667, 0.4       , 0.45      , 0.55      ,\n","       0.45      , 0.51666667, 0.6       ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"s1ZyRf3iYGtk"},"outputs":[{"data":{"text/plain":["0.4979166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"6wY5DeGLYGtk"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uraK4ZFyYGtk"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.36666667, 0.41666667, 0.38333333, 0.38333333,\n","       0.3       , 0.3       , 0.3       ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"rlDNMoS2YGtk"},"outputs":[{"data":{"text/plain":["0.36041666666666666"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Pi53d5suYGtk"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"E57mYUJwPuxz"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dm3nwjv8YIB7"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uhgJDujzPuxz"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7HXXuw1YPuxz"},"outputs":[],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SQT2v3dWPuxz"},"outputs":[],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZZPh5InUPuxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"fgncv-YAYKgH"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uQC7n2_9YKgH"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZOyWUPf7YKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PNiZaiTAYKgH"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uMEfoU2_YKgH"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SImpkdfFYKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8pwpVigDYKgH"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z-fMf-cOYKgH"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ySiVyU7sYKgH"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RqIaYT5rYKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gvbv0PiHYKgH"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p6Ku1ByOYKgH"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dY3402jGYKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wregmdqtYKgI"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fyJpUwLIYKgI"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Tg_rwd0APuxz"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"FSZ6dmiZYLgS"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"39lY7LhiPuxz"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NOqOwG1nPuxz"},"outputs":[],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3PmUdS5nPuxz"},"outputs":[],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MN42Rb16Puxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"F_F96mTXYOPF"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H6IzjxLBYOPF"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4bWY8XZXYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"62f0GR1bYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8g0yaA4qYOPF"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uAdBpkk1YOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zMfVwgjNYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zGUXp9auYOPF"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7FB4DfFYOPF"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dSwDndEiYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fGLMhla2YOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lZMclYLSYOPF"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vk3ptRjWYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qkV7RDrQYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IvwQ0DcnYOPF"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"USGMYRvkPuxz"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"HvXfbULIYP0S"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IvpM4efCPuxz"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AosKXbMnPuxz"},"outputs":[],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Uo1epUM6Puxz"},"outputs":[],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LEbVr7kID3lP"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Z3pVdFRIYS_Y"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O1mSEfhvYS_Y"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QcLc93iFYS_Y"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sKcAejjvYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mQ_K8f1GYS_Z"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Ni0XQ4MYS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"14dpGt4HYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SlABUIa1YS_Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XcqEawTMYS_Z"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2sVRpDV0YS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WUapXFgsYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"njxWLC9cYS_Z"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fOjDRVdiYS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bN5MWN21YS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zRMQjaF0YS_Z"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"ym_PcB2Bzhy5"},"source":["### Hyper_optimized Model"]},{"cell_type":"markdown","metadata":{"id":"gLRQegMuznEx"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"UYtPQW5lznEx"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qzMbiN63znEx"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"brq7F45MznEx"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"deNrrmvfznEx"},"outputs":[],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DuwWXLzCznEx"},"outputs":[],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D_bWM63AznEx"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Dw0u6K5fznEx"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"r0bX_XinznEx"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jQQ7xE6FznEx"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q8uJkiSgznEx"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E_WvyhCkznEx"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gQ77McSEznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CrfcSLr_znEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EN0zehJcznEy"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JZd-GNejznEy"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1tuwbqxBznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2s555K_JznEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55Yt3JxVznEy"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e1uK8AAGznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vdyH7L3-znEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"y1YxHwLWznEy"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Uft0d1hpznEy"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"87fHemV8znEy"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_D-7eBzUznEy"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pUYCZWU8znEy"},"outputs":[],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_XH1O4gEznEy"},"outputs":[],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1ZpTLQHPznEy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"gB5QZVGUznEy"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9DAVY-EmznEy"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dIUnOe4_znEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hen4_Lm3znEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hxs44I_mznEz"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ea6nyuG4znEz"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mr_8apUtznEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4MN-hf_WznEz"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D0WAxV0RznEz"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vbEylF0OznEz"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oynC3pGvznEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G6C-LGo7znEz"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NOAoGC48znE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"t63ca5zEznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VMZacJ-8znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"VElWFWnwznE0"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"oilXUTU9znE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OrpD379aznE0"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GiGSxegJznE0"},"outputs":[],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"82SelhLDznE0"},"outputs":[],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jWj2VfvKznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"5N35S_S7znE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xa8-D0wpznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n2sVmxGdznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BpnIX_HjznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XPiy_g5oznE0"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"azSQOq8_znE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nOJk3jtxznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oX-bRxwfznE0"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f9IzvaKcznE0"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OjhZe7LAznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pOxeg5R-znE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FTtx-WTEznE0"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nm3LlijhznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"v8T7HCsRznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rCBj88t3znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"IqZgkBX0znE0"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"3n_oeISCznE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kAiOndRWznE0"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D6mfl16pznE0"},"outputs":[],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zIsY4x87znE0"},"outputs":[],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wOu2FqUgznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FNSg-xESznE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JAhmZr0WznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qFmuaHAOznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0PRsJdEAznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7J3uMDdGznE1"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-B3go7n2znE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yCuHLkI8znE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8hWa-aJmznE1"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5jVryRzDznE1"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9Z4ghTQ5znE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2Z3jNzMFznE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kraH7kCAznE1"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hm7ymwVIznE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2KrfQG6vznE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BFyZ88sQznE1"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"oDNCpIIRD7gz"},"source":["## XGBoost Classifier"]},{"cell_type":"markdown","metadata":{"id":"j2tykuMUzur7"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jqg0nC9EQYwp"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"NfgwRfQvYb8t"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JsLW_31BQYwp"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bLodkCQ_QYwp"},"outputs":[],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RXLNwgL-QYwp"},"outputs":[],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yX4Rcv6hQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"g3KPsQ60YgQm"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RxzUgIo2YgQm"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rsR68pOvYgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7K1nRVGxYgQm"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qHeNXZf2YgQm"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RBCMfcXSYgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZRQ_1B9WYgQm"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hpacKrT3YgQm"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9EUD5_4AYgQm"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qDQJIez_YgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z-mkU6E6YgQn"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1epIp3BNYgQn"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JoJL01LrYgQn"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"b6bf8HGHYgQn"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7y55nYzYYgQn"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Wh2r7aqvQYwq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"PVhR6RhrYjM2"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hxo_eo5IQYwq"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wr7MB0OmQYwq"},"outputs":[],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LQKZiM2UQYwq"},"outputs":[],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_M0E115eQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"VDgQXkvRYogs"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VIkd9Qu2Yogs"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OvM-Fvb3Yogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iUk0ifWiYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PHgkhMkOYogs"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AHTtZ-8fYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z9HpvbW3Yogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l5gaVnt6Yogs"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a3zuz6rrYogs"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cW3BKU5wYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ancDGUAjYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LFXL4CazYogs"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E4x6WM0SYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8guPYbmSYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tg598195Yogs"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AGYcf92VQYwq"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dk6vZ3MYYqf_"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RyTE9hZoQYwq"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gak6l1CXQYwq"},"outputs":[],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0rxn8OrlQYwq"},"outputs":[],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2BQXvF4KQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Io2FlXTHYt3K"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bI2jZQ7FYt3K"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"he-l5p-SYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uy8sRZwLYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A8qBvhgVYt3K"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-dgZAbImYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"m3bDkAUgYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dfF2wiF7Yt3K"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nLTq2VfkYt3K"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rC72bI8rYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"otMnNNBJYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iz34DmjlYt3K"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GWhpQqdCYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eljr226pYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BrLIGAzbYt3K"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"1O6rD9RLQYwq"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"RIQdan6pYvOX"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h5xA-bMkQYwq"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HOQsRZ_8QYwq"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aHQhKc--QYwq"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eseZcKAoJ__G"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"yLZCsP0eY1pQ"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7kKF19DY1pQ"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KWcoIkfCY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jnyaRlzsY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9NgKsUKFY1pQ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zueJZ-5YY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PP9j9jbzY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HwbywwFEY1pQ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zR8v_IjfY1pQ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O_LHVRPTY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SnRWttBqY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S8E5UdVMY1pQ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iSNXFoQYY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZDu2p-FDY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mliqJis0Y1pQ"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uqoeswDMnyci"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"JAynU_HI0PBY"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"vgrN6ot60PBY"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"O48noycN0PBY"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jDpeFtN80PBY"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QnV8vzRh0PBY"},"outputs":[],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HJzjh4ga0PBY"},"outputs":[],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IE2N7VHD0PBY"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"YSJmQn2_0PBY"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B9OPp_sT0PBY"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7UF8Fh0r0PBY"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LHHSq-ze0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NU2etCDh0PBZ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vzs-oG2Q0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Y5LNQ2Im0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zWt5dGZS0PBZ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R9R3q8lF0PBZ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uuD97M-r0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QWUwvFh-0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vEfN1lmG0PBZ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0srZvvEV0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ugLG-QXc0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F6Eu517e0PBa"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"90su4wIc0PBa"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"MJ4OmTw50PBa"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vJnjTODu0PBa"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NgcVhOm00PBa"},"outputs":[],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aEo-v5Sh0PBa"},"outputs":[],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z1CdrcR-0PBa"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ss4KdVSQ0PBa"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SC7I2If40PBa"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6DhduOKd0PBa"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wDo0HinI0PBa"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6DDy143g0PBa"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o-nojkLm0PBa"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7W4s6Znt0PBa"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GbdcHa7A0PBb"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VzBE8UbC0PBb"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YFf8uy7j0PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s0Qet-vx0PBb"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G1pViHjW0PBb"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HngwE8vS0PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wcsNamsp0PBb"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"480rGKpC0PBb"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AbL7-dbc0PBb"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"tnN0ijSs0PBb"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Tx_6QIyU0PBb"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iJrhBHOb0PBb"},"outputs":[],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IkkX2HRP0PBb"},"outputs":[],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tqiloYtR0PBb"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Ropu3-tW0PBb"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"k0e0jkDZ0PBb"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bIeTuXR00PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QSQ-6v460PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sj8Sha_x0PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4yc-2qz10PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"neS6G0C10PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7MXe6xRr0PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ct3yEerV0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iSfJeL230PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kojZ2SUM0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A_CcH-Ql0PBc"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Tn152nR0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tRSdT7Wx0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BLyOKveN0PBc"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Oq6LsPJw0PBc"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"eUk34NiQ0PBc"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7tnmONbH0PBc"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"45KiYK090PBc"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G2tlj00W0PBc"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AFtm3Nt40PBc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"1X2T4ocQ0PBc"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mOdemmuz0PBc"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0IbOynDY0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mWi1QK860PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zz1UZyb90PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pc4AEhkH0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IZONW9Eg0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J0yH0nP80PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f_XTLXOd0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ejufwDue0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f0rOZsMN0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MLvMmLOC0PBd"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tMpVsZzS0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"13om3syO0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9kuC5h0B0PBd"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55_ocXPFoH8Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wzk61CezoI2E"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YUIZoGclSNMr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n4DB9nM9WS_I"},"outputs":[],"source":[""]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Machine Learning Computation - linear - full","provenance":[{"file_id":"1wV98L2ux7aXgacLTPCET4rezuozEXbNB","timestamp":1606814445981},{"file_id":"1FKzRRIZhxD6H3s8wEXUtnoGk7FOlng8M","timestamp":1605987313010},{"file_id":"https://github.com/fastai/fastai/blob/master/nbs/44_tutorial.tabular.ipynb","timestamp":1605742460785}],"toc_visible":true,"version":""},"jupytext":{"split_at_heading":true},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"}},"nbformat":4,"nbformat_minor":0}