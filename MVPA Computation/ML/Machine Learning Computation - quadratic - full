{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"0q0cnNSixB9u"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MRb0FZftSf1k"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tKtiW9P0o7fM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Cs4vCXzHXrFL"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from numpy import array\n","import matplotlib.pyplot as plt\n","\n","from sklearn.feature_selection import f_classif, mutual_info_classif, SelectFdr\n","\n","from sklearn.feature_selection import GenericUnivariateSelect\n","from sklearn.svm import LinearSVC, NuSVC\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier \n","\n","from scipy.stats import uniform, randint\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from sklearn.naive_bayes import GaussianNB\n","from sklearn.svm import SVC\n","from sklearn.datasets import load_digits\n","from sklearn.model_selection import learning_curve\n","from sklearn.model_selection import ShuffleSplit\n","from sklearn.model_selection import cross_val_score\n","\n","import xgboost as xgb\n","from sklearn.metrics import auc, accuracy_score, confusion_matrix, mean_squared_error\n","from sklearn.model_selection import cross_val_score, GridSearchCV, KFold, RandomizedSearchCV, train_test_split\n","\n","from warnings import filterwarnings\n","filterwarnings('ignore')\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F9rXqu8pJW8o"},"outputs":[],"source":["\n","def plot_learning_curve(estimator, title, X, y, axes=None, ylim=None, cv=None,\n","                        n_jobs=None, train_sizes=np.linspace(.1, 1.0, 5)):\n","    \"\"\"\n","    Generate 3 plots: the test and training learning curve, the training\n","    samples vs fit times curve, the fit times vs score curve.\n","\n","    Parameters\n","    ----------\n","    estimator : object type that implements the \"fit\" and \"predict\" methods\n","        An object of that type which is cloned for each validation.\n","\n","    title : string\n","        Title for the chart.\n","\n","    X : array-like, shape (n_samples, n_features)\n","        Training vector, where n_samples is the number of samples and\n","        n_features is the number of features.\n","\n","    y : array-like, shape (n_samples) or (n_samples, n_features), optional\n","        Target relative to X for classification or regression;\n","        None for unsupervised learning.\n","\n","    axes : array of 3 axes, optional (default=None)\n","        Axes to use for plotting the curves.\n","\n","    ylim : tuple, shape (ymin, ymax), optional\n","        Defines minimum and maximum yvalues plotted.\n","\n","    cv : int, cross-validation generator or an iterable, optional\n","        Determines the cross-validation splitting strategy.\n","        Possible inputs for cv are:\n","\n","          - None, to use the default 5-fold cross-validation,\n","          - integer, to specify the number of folds.\n","          - :term:`CV splitter`,\n","          - An iterable yielding (train, test) splits as arrays of indices.\n","\n","        For integer/None inputs, if ``y`` is binary or multiclass,\n","        :class:`StratifiedKFold` used. If the estimator is not a classifier\n","        or if ``y`` is neither binary nor multiclass, :class:`KFold` is used.\n","\n","        Refer :ref:`User Guide \u003ccross_validation\u003e` for the various\n","        cross-validators that can be used here.\n","\n","    n_jobs : int or None, optional (default=None)\n","        Number of jobs to run in parallel.\n","        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n","        ``-1`` means using all processors. See :term:`Glossary \u003cn_jobs\u003e`\n","        for more details.\n","\n","    train_sizes : array-like, shape (n_ticks,), dtype float or int\n","        Relative or absolute numbers of training examples that will be used to\n","        generate the learning curve. If the dtype is float, it is regarded as a\n","        fraction of the maximum size of the training set (that is determined\n","        by the selected validation method), i.e. it has to be within (0, 1].\n","        Otherwise it is interpreted as absolute sizes of the training sets.\n","        Note that for classification the number of samples usually have to\n","        be big enough to contain at least one sample from each class.\n","        (default: np.linspace(0.1, 1.0, 5))\n","    \"\"\"\n","    if axes is None:\n","        _, axes = plt.subplots(1, 3, figsize=(20, 5))\n","\n","    axes[0].set_title(title)\n","    if ylim is not None:\n","        axes[0].set_ylim(*ylim)\n","    axes[0].set_xlabel(\"Training examples\")\n","    axes[0].set_ylabel(\"Score\")\n","\n","    train_sizes, train_scores, test_scores, fit_times, _ = \\\n","        learning_curve(estimator, X, y, cv=cv, n_jobs=n_jobs,\n","                       train_sizes=train_sizes,\n","                       return_times=True)\n","    train_scores_mean = np.mean(train_scores, axis=1)\n","    train_scores_std = np.std(train_scores, axis=1)\n","    test_scores_mean = np.mean(test_scores, axis=1)\n","    test_scores_std = np.std(test_scores, axis=1)\n","    fit_times_mean = np.mean(fit_times, axis=1)\n","    fit_times_std = np.std(fit_times, axis=1)\n","\n","    # Plot learning curve\n","    axes[0].grid()\n","    axes[0].fill_between(train_sizes, train_scores_mean - train_scores_std,\n","                         train_scores_mean + train_scores_std, alpha=0.1,\n","                         color=\"r\")\n","    axes[0].fill_between(train_sizes, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1,\n","                         color=\"g\")\n","    axes[0].plot(train_sizes, train_scores_mean, 'o-', color=\"r\",\n","                 label=\"Training score\")\n","    axes[0].plot(train_sizes, test_scores_mean, 'o-', color=\"g\",\n","                 label=\"Cross-validation score\")\n","    axes[0].legend(loc=\"best\")\n","\n","    # Plot n_samples vs fit_times\n","    axes[1].grid()\n","    axes[1].plot(train_sizes, fit_times_mean, 'o-')\n","    axes[1].fill_between(train_sizes, fit_times_mean - fit_times_std,\n","                         fit_times_mean + fit_times_std, alpha=0.1)\n","    axes[1].set_xlabel(\"Training examples\")\n","    axes[1].set_ylabel(\"fit_times\")\n","    axes[1].set_title(\"Scalability of the model\")\n","\n","    # Plot fit_time vs score\n","    axes[2].grid()\n","    axes[2].plot(fit_times_mean, test_scores_mean, 'o-')\n","    axes[2].fill_between(fit_times_mean, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1)\n","    axes[2].set_xlabel(\"fit_times\")\n","    axes[2].set_ylabel(\"Score\")\n","    axes[2].set_title(\"Performance of the model\")\n","\n","    return plt"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0KzSKSrn_INa"},"outputs":[],"source":["def hyper_opt_procedure(model_object,params,cv,perf_df,X,y):\n","\n","\n","  model = model_object()\n","\n","  # Initial Model Fit with stock hyper_params\n","\n","  init_score = np.mean(cross_val_score(model,X,y,cv=cv))\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Stock Params',\n","                              'Score':init_score}, ignore_index=True)\n","\n","  print('Initial Model with Stock Params Score : {}'.format(init_score))\n","\n","  # Random Search Cross Validation\n","\n","\n","  search_model = RandomizedSearchCV(model,\n","                                         param_distributions=params,\n","                                         random_state=42, \n","                                         n_iter=300, \n","                                         cv=cv, \n","                                         verbose=1, \n","                                         n_jobs=1, \n","                                         return_train_score=True)\n","\n","  search_model.fit(X,y)\n","\n","  best_search_model = search_model.best_estimator_\n","\n","  best_search_model_score = search_model.best_score_\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Random HP Search Best Model',\n","                      'Score':best_search_model_score}, ignore_index=True)\n","\n","  rd_score_improv = ((best_search_model_score - init_score)/init_score) * 100\n","\n","  print('Random HP Search Best Model Score : {}'.format(best_search_model_score))\n","\n","  print('Improvement of {}% relative to the initial model'.format(rd_score_improv))\n","  \n","  \n","\n","\n","  return model, best_search_model\n","   \n","\n","\n","\n","class hyper_model:\n","    \n","    def __init__(self,model_name,validation_approach,X,y):\n","        \n","        self.model_name = model_name\n","        self.X = X\n","        self.y = y\n","        self.validation_approach= validation_approach\n","        self.best_model = None\n","        self.best_params = None\n","        self.all_models_perf = pd.DataFrame(None,columns=['Model Iteration','Score'])\n","        self.stock_model = None\n","        self.rd_model = None\n","\n","\n","    def fit(self):\n","\n","\n","      if self.validation_approach == 'leave-one-run-out':\n","\n","        cv = KFold(n_splits=8, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-run-out-shuffled':\n","\n","        cv = KFold(n_splits=8, shuffle=True, random_state=42)\n","\n","      elif self.validation_approach == 'leave-one-task-out':\n","\n","        cv = KFold(n_splits=4, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-task-out-shuffled':\n","\n","        cv = KFold(n_splits=4, shuffle=True, random_state=42)    \n","\n","\n"," \n","        \n","        # Linear SVM\n","\n","      if self.model_name == 'linear_svm':\n","\n","        params = {'C': [0.1, 1, 10, 100, 1000]} \n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=LinearSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","         \n","\n","      # Non Linear SVM\n","\n","\n","      elif self.model_name == 'non_linear_svm':\n","\n","        params = {'nu': [0.01, 0.3, 0.5, 0.7, 1],  \n","                        'gamma': [1, 0.1, 0.01, 0.001, 0.0001], \n","                        'kernel': ['rbf','poly','sigmoid']\n","                       }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=NuSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","          \n","      # Random Forest Classifier\n","\n","\n","      elif self.model_name == 'random_forest_classifier':\n","\n","\n","        params = {'bootstrap': [True, False],\n","                    'max_depth': [50, 60, 70, 80, 90, 100],\n","                    'max_features': ['auto', 'sqrt'],\n","                    'min_samples_leaf': [1, 2, 4],\n","                    'min_samples_split': [2, 5, 10],\n","                    'n_estimators': [1000, 1200, 1400, 1600, 1800, 2000]\n","                   }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=RandomForestClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","          \n","\n","\n","\n","      # XG Boost Classifier\n","\n","\n","      elif self.model_name == 'xg_boost':\n","\n","        params = {\n","              \"colsample_bytree\": uniform(0.7, 0.3),\n","              \"gamma\": uniform(0, 0.5),\n","              \"learning_rate\": uniform(0.03, 0.3), \n","              \"max_depth\": randint(2, 6), \n","              \"n_estimators\": randint(100, 150),\n","              \"subsample\": uniform(0.6, 0.4)\n","              }\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=xgb.XGBClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)  \n","\n","                \n","                "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":25330,"status":"ok","timestamp":1606853051808,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hO1Z8nwls9_Y","outputId":"602136d8-0d1a-44c8-93ac-50ea03e71c90"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive/\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive/',force_remount=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2305,"status":"ok","timestamp":1606853051808,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AU6YvpHup87A","outputId":"8524bebc-4294-47f4-a7d7-27ded74c9ecd"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[0m\u001b[01;34mdrive\u001b[0m/  \u001b[01;34msample_data\u001b[0m/\n"]}],"source":["ls"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":588,"status":"ok","timestamp":1606853053087,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jtOjcM89tPUT","outputId":"83993f20-b6ab-4573-f36b-8ac7fb0603fc"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CEA\n"]}],"source":["cd drive/MyDrive/CEA/"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mK0bYtMjvknM"},"outputs":[],"source":["X = np.load('data/X_pref_lss_shift_quadratic_full.npy')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":697,"status":"ok","timestamp":1606853087727,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uqbxJx6gxbey","outputId":"a4c82a81-6a47-4595-efd7-59fd54d21a5b"},"outputs":[{"data":{"text/plain":["(480, 11457)"]},"execution_count":8,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Iojp3abFv1W0"},"outputs":[],"source":["y = np.load('data/y_pref_lss_shift_quadratic_full.npy')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":830,"status":"ok","timestamp":1606853092833,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HRfd5YRExl6M","outputId":"33178d82-61ce-4e29-d6be-92de0c2cd445"},"outputs":[{"data":{"text/plain":["(480, 1)"]},"execution_count":10,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["y.shape"]},{"cell_type":"markdown","metadata":{"id":"-eDis182XeSE"},"source":["## Features Selection"]},{"cell_type":"markdown","metadata":{"id":"G7d7JTJmXgwj"},"source":["### Filter"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Kexq1fnyXkRY"},"outputs":[],"source":["transformer = GenericUnivariateSelect(mutual_info_classif, mode='k_best', param=550)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FAZkKRmhXnPo"},"outputs":[],"source":["X_trans = transformer.fit_transform(X, y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":58957,"status":"ok","timestamp":1606854007752,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BKKN66taXoz0","outputId":"a1e2797a-7768-47ce-e69a-5f17f3de6082"},"outputs":[{"data":{"text/plain":["(480, 550)"]},"execution_count":13,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X_trans.shape"]},{"cell_type":"markdown","metadata":{"id":"cC_RDtVZYwG0"},"source":["### Data Preparation"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8OmeM2TuYzDd"},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10, random_state=42)"]},{"cell_type":"markdown","metadata":{"id":"3rxGDdS1Y2A6"},"source":["## Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"3e6kNyHGxE_w"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"oK0OX_9xnzWv"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"P0slq_QtT_P1"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"url-dxiyoJsT"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":342357,"status":"ok","timestamp":1606854801726,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"MATeUxpJo9DC","outputId":"b55b8963-4474-472a-eefe-21e722572bc8"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5041666666666667\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:  4.4min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.50625\n","Improvement of 0.4132231404958663% relative to the initial model\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":342316,"status":"ok","timestamp":1606854801728,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-LuUfzJYuZ5c","outputId":"f9343633-ddd8-451f-82aa-716e93671c9f"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":20,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hlwfN3l9XDr-"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"WnDMByUhXMfO"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"obSzi-BEXMfO"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":394547,"status":"ok","timestamp":1606854853998,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aPPDOaCxXMfO","outputId":"6f4ab46a-fc59-4da3-a90e-f3f11c003af1"},"outputs":[{"data":{"text/plain":["array([0.50833333, 0.43333333, 0.51666667, 0.51666667])"]},"execution_count":22,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":394535,"status":"ok","timestamp":1606854853998,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9l85G4epXMfO","outputId":"af4beff5-949d-4153-93e1-04d88dc28280"},"outputs":[{"data":{"text/plain":["0.49375"]},"execution_count":23,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nZiTeY6mXMfO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":417929,"status":"ok","timestamp":1606854877416,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Imp-qfZeXMfO","outputId":"b125b7af-ccd0-4649-cc92-b2d2c39a360b"},"outputs":[{"data":{"text/plain":["array([0.125     , 0.11666667, 0.1       , 0.08333333])"]},"execution_count":25,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":417917,"status":"ok","timestamp":1606854877416,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y6HNpYl_XMfO","outputId":"323a4c75-ad83-48a3-e941-e067a9fd724a"},"outputs":[{"data":{"text/plain":["0.10625"]},"execution_count":26,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"osKpbfvyXMfO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w2SlhLffXMfO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":540854,"status":"ok","timestamp":1606855000390,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FqjIqTD1XMfO","outputId":"8f0898dc-43c0-4060-cd4e-bd1c3dfad550"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.51666667, 0.46666667, 0.51666667,\n","       0.53333333, 0.53333333, 0.51666667])"]},"execution_count":28,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":540843,"status":"ok","timestamp":1606855000391,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yZVtOibiXMfO","outputId":"673636a5-e4e6-40f4-e47e-252264bd5342"},"outputs":[{"data":{"text/plain":["0.5166666666666666"]},"execution_count":29,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oajU1LQ3XMfP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":654422,"status":"ok","timestamp":1606855113996,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ADNditLZXMfP","outputId":"e3d90015-6abf-4e40-c3a3-e4a0c4ce63d8"},"outputs":[{"data":{"text/plain":["array([0.08333333, 0.13333333, 0.03333333, 0.08333333, 0.26666667,\n","       0.11666667, 0.06666667, 0.01666667])"]},"execution_count":31,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":654408,"status":"ok","timestamp":1606855113996,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"goo-B_3cXMfP","outputId":"6855cc3b-a77d-4c36-b291-378128b8de9b"},"outputs":[{"data":{"text/plain":["0.1"]},"execution_count":32,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"P-5MwWHhXMfP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Gb-Qqwn8oJ7d"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"R4mMDLPsWAmE"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Cee0jzzPIFx"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":811279,"status":"ok","timestamp":1606855270905,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JGJS_yz6PIFy","outputId":"8377be99-f546-4fb5-d682-0f3ec0f92f15"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.10625\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:  1.9min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.10625\n","Improvement of 0.0% relative to the initial model\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":811271,"status":"ok","timestamp":1606855270910,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JAf3le69PIFy","outputId":"d32fbc1c-e807-4551-b3a1-221c767dff3c"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":36,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WIsSLawaoR-_"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"CMPrOUDoWFWr"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Vd_umY9HWFWr"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":864384,"status":"ok","timestamp":1606855324060,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tpxUGequWFWr","outputId":"806ec201-f90d-4a10-f48c-a83eda926239"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.48333333, 0.46666667, 0.525     ])"]},"execution_count":38,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":864373,"status":"ok","timestamp":1606855324061,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LCzQufNtWFWr","outputId":"bbdb7468-c6ab-4f7d-e062-465ad62abfb3"},"outputs":[{"data":{"text/plain":["0.4770833333333333"]},"execution_count":39,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pSmKo3hZWFWr"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":888186,"status":"ok","timestamp":1606855347899,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7hn8vbGCWFWr","outputId":"e90cda7c-fc75-4099-e756-8906f762665a"},"outputs":[{"data":{"text/plain":["array([0.125     , 0.11666667, 0.1       , 0.08333333])"]},"execution_count":41,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":888174,"status":"ok","timestamp":1606855347900,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PxVtKHfUWFWr","outputId":"8e25ab7d-3a43-44b1-b43e-fe26ea213a92"},"outputs":[{"data":{"text/plain":["0.10625"]},"execution_count":42,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ChZvGrkeWFWr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3uCFUnE0WFWr"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1010406,"status":"ok","timestamp":1606855470172,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8CGhPtsfWFWr","outputId":"1fe07ff3-6a96-4551-c794-2c757bd39ec6"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.48333333, 0.45      , 0.55      , 0.53333333,\n","       0.46666667, 0.6       , 0.55      ])"]},"execution_count":44,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1010395,"status":"ok","timestamp":1606855470173,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"D0iWmziUWFWr","outputId":"79b0550f-d62c-4d43-b02f-06555d6bbf88"},"outputs":[{"data":{"text/plain":["0.5145833333333334"]},"execution_count":45,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xdhCavSlWFWr"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1127340,"status":"ok","timestamp":1606855587143,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1JmYYZIwWFWr","outputId":"42cbb29c-384f-4d4a-eb96-730d2fe741be"},"outputs":[{"data":{"text/plain":["array([0.08333333, 0.13333333, 0.03333333, 0.08333333, 0.26666667,\n","       0.11666667, 0.06666667, 0.01666667])"]},"execution_count":47,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1127328,"status":"ok","timestamp":1606855587143,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9JDZ-36UWFWr","outputId":"09e11bc6-a65d-48b3-ea21-4eefc1184593"},"outputs":[{"data":{"text/plain":["0.1"]},"execution_count":48,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nbRpu_f0WFWr"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"yk1VAnOFoSCu"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qK7ud6-dWV9T"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BjBXz_jRPPJO"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1879393,"status":"ok","timestamp":1606856339245,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CnbTertnPPJO","outputId":"5b5fe39d-ba51-4d83-f085-6c3694f416d0"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5166666666666666\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed: 10.2min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5229166666666667\n","Improvement of 1.209677419354856% relative to the initial model\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":1879382,"status":"ok","timestamp":1606856339246,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sHMdRLUsPPJP","outputId":"47ff5aad-dcf8-4735-efba-bf00825363da"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":52,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VhkTeBlsoSGf"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ffRmE2HzXfw2"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xjJzKwpEXfw2"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1931526,"status":"ok","timestamp":1606856391425,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FfqjXtzaXfw2","outputId":"9dcf151c-68c6-4834-f3e7-05621f53d63f"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.44166667, 0.51666667, 0.46666667])"]},"execution_count":54,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1931517,"status":"ok","timestamp":1606856391430,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XCi4tf0uXfw2","outputId":"ba26dbfd-f539-4640-dc5d-08bf98e9cc88"},"outputs":[{"data":{"text/plain":["0.4916666666666667"]},"execution_count":55,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f4rrkYJUXfw2"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1955028,"status":"ok","timestamp":1606856414965,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ldUaBM8oXfw2","outputId":"a5e78522-cc34-41f8-d12b-67e1897528a6"},"outputs":[{"data":{"text/plain":["array([0.125     , 0.11666667, 0.1       , 0.08333333])"]},"execution_count":57,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1955016,"status":"ok","timestamp":1606856414965,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kiw1b1y8Xfw2","outputId":"5726580a-ee50-44eb-a9da-99845f8e6ae2"},"outputs":[{"data":{"text/plain":["0.10625"]},"execution_count":58,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bNAQZX5ZXfw2"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RYc1l8DXXfw2"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2077227,"status":"ok","timestamp":1606856537211,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"69s38be1Xfw2","outputId":"59856dab-1d6e-4abb-e459-5538d725432a"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.5       , 0.51666667, 0.5       , 0.58333333,\n","       0.51666667, 0.51666667, 0.58333333])"]},"execution_count":60,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2077216,"status":"ok","timestamp":1606856537212,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"nVk4MjlQXfw2","outputId":"fe5c1147-bf67-4d39-8e42-39df13ff8dea"},"outputs":[{"data":{"text/plain":["0.53125"]},"execution_count":61,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"88KOXS3VXfw2"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2190302,"status":"ok","timestamp":1606856650322,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"bImXksWpXfw2","outputId":"1e6a3ac7-380c-46ca-b4a0-28111a399592"},"outputs":[{"data":{"text/plain":["array([0.08333333, 0.13333333, 0.03333333, 0.08333333, 0.28333333,\n","       0.11666667, 0.06666667, 0.01666667])"]},"execution_count":63,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2190291,"status":"ok","timestamp":1606856650323,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QWbqk81KXfw2","outputId":"23dfda6c-5805-4ba8-902f-9e1207137424"},"outputs":[{"data":{"text/plain":["0.10208333333333333"]},"execution_count":64,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gvhldUdEXfw2"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ryKXIhosWkY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LuqDNEUVXem2"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8Z7a-FGHoSKO"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Wjkj4swhXhgq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eWJfI5YnPPzE"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":92889,"status":"ok","timestamp":1606857347789,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-QFW2J0HPPzE","outputId":"5baf28c3-bc2e-48c7-c720-8fe1ac908fc9"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.1\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:  9.4min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.10208333333333333\n","Improvement of 2.083333333333326% relative to the initial model\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":61,"status":"ok","timestamp":1606857347790,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Diwlgrr6PPzE","outputId":"a2a3ea4c-1715-4004-de98-c047d42ee3a5"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":68,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p_zezBW2SWjz"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"rjvf3p9eXkKN"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Nic0nOPtXkKN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J-OqyJx4XkKO"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"I2V919yeXkKO"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CQo-9ubKXkKO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":25,"status":"ok","timestamp":1606857423443,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YTzKNz4rXkKO","outputId":"e11eeb1e-b405-41a2-c5c2-cda7217813f3"},"outputs":[{"data":{"text/plain":["array([0.125     , 0.11666667, 0.1       , 0.08333333])"]},"execution_count":73,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2GWAFm_6XkKO"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-c5IHn17XkKO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Okf-45vIXkKO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":64,"status":"ok","timestamp":1606857546165,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HfQ03o7aXkKO","outputId":"a23517aa-782b-4ca8-e83f-4308cbc10096"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.55      , 0.48333333, 0.51666667, 0.46666667,\n","       0.51666667, 0.48333333, 0.5       ])"]},"execution_count":76,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5XRG6jEEXkKO"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7-0CnEaYXkKO"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-0quuBcgXkKO"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X16n6fn-XkKO"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UDRY8j-5XkKO"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Lja4q_wLTg0R"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"stZ6DO2sThIc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"TTW32YjnxcFK"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"mvKVuHmJxcFL"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"JYV5csm3xcFL"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OzOIKjnrxcFL"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":320474,"status":"ok","timestamp":1606857989622,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ugzTVwdBxcFL","outputId":"493f2408-670f-44f5-f1f6-a6d1ef1a530f"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4875\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:  4.4min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5083333333333333\n","Improvement of 4.27350427350427% relative to the initial model\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BcoF6XGAxcFL"},"outputs":[],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gz3DAOnAxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"MU1PmbLuxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R_IY4nR0xcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LXgqGhMMxcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cQSax0c_xcFM"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B6QFFuZoxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jpdF-f29xcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":58,"status":"ok","timestamp":1606858064737,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tWt6NvLnxcFM","outputId":"91b5d012-ac70-4a01-cd91-03a01852e8dd"},"outputs":[{"data":{"text/plain":["0.10625"]},"execution_count":90,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mrvkWQG2xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f6ono8bWxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"opbGpr4qxcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"K1ZpmNBAxcFM"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jm7mkIIdxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pvspMz5zxcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":131,"status":"ok","timestamp":1606858302635,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xBjz_G5TxcFM","outputId":"edc1867f-ec92-49b8-c357-d9b387385946"},"outputs":[{"data":{"text/plain":["0.09375"]},"execution_count":96,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dC9pWR3WxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"XedkRZHwxcFM"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"9HiVDnozxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uwuuHEYlxcFM"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l-XinugXxcFM"},"outputs":[],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7tvjFgLoxcFM"},"outputs":[],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EbZRWXTwxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qEfs8n21xcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QGT0CuzPxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O65IF5P6xcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":39,"status":"ok","timestamp":1606858515833,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"g135jDm3xcFM","outputId":"76de302e-1d08-4a2a-db0f-cda0f7902c6d"},"outputs":[{"data":{"text/plain":["0.48750000000000004"]},"execution_count":103,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"U4ZzCpkwxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ghEGnajnxcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1dQIJEXixcFM"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Bx9r41ixcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_PSdLsDqxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"r1C0gBd-xcFM"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sd_600a3xcFM"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NTsPzbnSxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":66,"status":"ok","timestamp":1606858779367,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jb5RMb-pxcFM","outputId":"fea71b0f-a43b-48ac-f74b-8cb0ff079dca"},"outputs":[{"data":{"text/plain":["array([0.06666667, 0.11666667, 0.03333333, 0.08333333, 0.25      ,\n","       0.11666667, 0.06666667, 0.01666667])"]},"execution_count":111,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sdOno854xcFM"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"awfIV9pZxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"3Km95QOvxcFM"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"4HGGgdeIxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oaYNByAsxcFM"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"G63hlZ4kxcFM","outputId":"344d9448-f8b8-4ae0-f449-35d52fc0f925"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4916666666666667\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed: 10.2min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5062500000000001\n","Improvement of 2.9661016949152663% relative to the initial model\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"PpMulicsxcFM","outputId":"99ef0fd2-0ef7-4049-a28d-5afed553e30c"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gtkUY73bxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"4ad7FRzfxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"5Pi0us0CxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"P2ReLTMmxcFM","outputId":"0fff36b3-7c3d-4d8b-a339-f497dcff36ea"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.44166667, 0.55833333, 0.5       ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zQe_P4vtxcFM","outputId":"72b5cb14-5038-415d-d74a-000247fd1724"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"-fLvGqsBxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vH6BJYeCxcFM","outputId":"888032fe-5b80-4d87-e91d-abd7ccdb516d"},"outputs":[{"data":{"text/plain":["array([0.125     , 0.11666667, 0.1       , 0.08333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"iWKygSBFxcFM","outputId":"4622d363-b751-45d3-8664-6a66483c5194"},"outputs":[{"data":{"text/plain":["0.10625"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"H89-Ubk1xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jystqc68xcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"me7J6W3jxcFM","outputId":"43b5b568-cd4d-42ad-f675-4b062a3f785f"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.55      , 0.48333333, 0.5       , 0.56666667,\n","       0.45      , 0.51666667, 0.5       ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"b4GFz5MExcFM","outputId":"fe4ab1c5-8276-4cde-a240-927992253776"},"outputs":[{"data":{"text/plain":["0.5104166666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"xuQVuhiQxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"laTiM7yyxcFM","outputId":"62bd78ca-56ef-435d-8aed-25117cfd19d9"},"outputs":[{"data":{"text/plain":["array([0.06666667, 0.11666667, 0.03333333, 0.08333333, 0.25      ,\n","       0.11666667, 0.06666667, 0.01666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"5YEpQA8MxcFM","outputId":"27c8526f-c15e-4153-a094-68c311dca2f3"},"outputs":[{"data":{"text/plain":["0.09375"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"e9j2dV-0xcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"In9JIEELxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"QBdhZ-WaxcFN"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"M_bDhah3xcFN"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"SB0mgXXvxcFN"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BqKnbg_JxcFN"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"DdLP80jqxcFN","outputId":"cf3612fc-9fe3-4cdd-efd7-337d69433698"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.1\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:  9.6min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.10208333333333333\n","Improvement of 2.083333333333326% relative to the initial model\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"O-pGzTR8xcFN","outputId":"fe52ba28-f02e-4b1d-ec39-292145093263"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"mm_UBr-JxcFN"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"37SLrvJMxcFN"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"UOiflGaYxcFN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uSGfcU8QxcFN","outputId":"edc9aa1b-fd41-4c29-c512-e115065ecbce"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.48333333, 0.49166667, 0.46666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"xoi4Bd7NxcFN","outputId":"b29ab2f9-e71f-4026-baf1-4c47f0f5e613"},"outputs":[{"data":{"text/plain":["0.4854166666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wNJLv2rYxcFN"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"V7rgWJWOxcFN","outputId":"fe09cc04-9500-4cad-8273-7770ae76c27f"},"outputs":[{"data":{"text/plain":["array([0.125     , 0.11666667, 0.1       , 0.08333333])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VDh6BucmxcFN","outputId":"e3cbbf86-14c8-4fed-b0af-0108acec9346"},"outputs":[{"data":{"text/plain":["0.10625"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"HUaF3tqAxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"EuutIIFXxcFN"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RAi3g167xcFN","outputId":"ff75a2d9-a1dd-4120-d887-5632d92cc980"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.53333333, 0.53333333, 0.48333333, 0.53333333,\n","       0.53333333, 0.5       , 0.51666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"qRf2KlHuxcFN","outputId":"14de2a69-0366-4e6b-c5d7-13aaa80b4b55"},"outputs":[{"data":{"text/plain":["0.5208333333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vc_-n4csxcFN"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Jln-g212xcFN","outputId":"527a2636-3b13-44be-8f8e-731f35734b72"},"outputs":[{"data":{"text/plain":["array([0.1       , 0.13333333, 0.03333333, 0.08333333, 0.28333333,\n","       0.11666667, 0.06666667, 0.01666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tlOVYKDCxcFN","outputId":"142e70d8-01b6-4d30-f40f-b5598ae70a51"},"outputs":[{"data":{"text/plain":["0.10416666666666666"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VIaGLGWLxcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"i80BGb95xcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"eo8YKpR5ThY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"oqugS205TiTt"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qeEgWCblzQnP"},"source":["## Non Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"5GSv6mzky38n"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"7oULTVbEPi_U"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"0Cne7taDXqB-"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dq07br9mPi_U"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1V8keujMPi_U","outputId":"3b316783-188b-481e-8574-8f745c4973c1"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48750000000000004\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed: 19.0min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5291666666666667\n","Improvement of 8.547008547008538% relative to the initial model\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"0gD5AkJMPi_U","outputId":"a10541b3-655c-4737-ed56-b5e7abe3f082"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"XxxGNCDDPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"R-4wu13DXt7S"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2zxO36oNXt7S"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"fsWhol8YXt7S","outputId":"6ecc358c-8182-43b0-89f4-cb5103fad0fc"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.4       , 0.5       , 0.46666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ymPirDLmXt7S","outputId":"84843d2a-99ac-4546-eb7f-8ec470bacda5"},"outputs":[{"data":{"text/plain":["0.48750000000000004"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"T0ta4ssHXt7S"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1RjKwn0pXt7S","outputId":"a02a9920-c68d-431f-d758-adb9a4846748"},"outputs":[{"data":{"text/plain":["array([0.23333333, 0.175     , 0.15833333, 0.2       ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"CIBOvXeDXt7S","outputId":"f5edc904-edad-4b2c-fa48-06915f0c497f"},"outputs":[{"data":{"text/plain":["0.19166666666666665"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1aTV6PZfXt7S"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NNnTNmeiXt7S"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"XPMCwPjQXt7S","outputId":"a492f1ba-ae01-4906-90d6-51ca0706085b"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.5       , 0.35      , 0.41666667, 0.53333333,\n","       0.53333333, 0.53333333, 0.56666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"DRVwsyQLXt7S","outputId":"a76de8fb-b534-4e64-daf4-86cd9bdf5562"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vinSE87gXt7S"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"xOuNRJLdXt7S","outputId":"4c1bcef5-fec1-4b32-9ec6-e70c981fd108"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.21666667, 0.16666667, 0.11666667, 0.2       ,\n","       0.11666667, 0.23333333, 0.11666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"d4xnl7FcXt7S","outputId":"6f46cc84-a6dc-42e7-f23b-dd3bb2885733"},"outputs":[{"data":{"text/plain":["0.16458333333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"eFy5EJT0Xt7S"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"l0KvHb0QXogu"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0Zs6BKtdPi_U"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"8EAYpz-HXvUg"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"CL0ybWLcPi_U"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IktxzifQPi_U","outputId":"94981945-96e1-4fcd-cef5-7b0d0c10b422"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.19166666666666665\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed: 19.1min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.7916666666666667\n","Improvement of 313.0434782608696% relative to the initial model\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_P-nox5XPi_U","outputId":"af99c52f-46c7-41c6-92aa-686aff32220c"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tWvOHDWQPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0198Uz5fXzwU"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RyahliyLXzwU"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zehjkRXnXzwU","outputId":"03038463-a5a5-4dc0-ee9c-996c3f650be2"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.4       , 0.5       , 0.46666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"WuJ2osi6XzwU","outputId":"c9a67f04-b94d-48f1-ac4a-23b2597a5a0c"},"outputs":[{"data":{"text/plain":["0.48750000000000004"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Ci44W-T2XzwU"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"vK4IjAABXzwU","outputId":"c6d98628-3b3d-4e36-f507-25a45511eeca"},"outputs":[{"data":{"text/plain":["array([0.23333333, 0.175     , 0.15833333, 0.2       ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"xhWy-ohdXzwU","outputId":"6f250ed6-dbf9-4578-b54f-37907b5e2381"},"outputs":[{"data":{"text/plain":["0.19166666666666665"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"CF7JcIMjXzwU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"2oIQ_WXQXzwU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"UzV889JxXzwU","outputId":"76afd791-e592-49db-f73a-9c41dea42002"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.5       , 0.35      , 0.41666667, 0.53333333,\n","       0.53333333, 0.53333333, 0.56666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"yL2hPRGYXzwU","outputId":"88cb2807-32cc-4cc0-e43a-b5d296f48507"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"-66NgtuSXzwU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"WuB0T_n2XzwU","outputId":"4f19555a-a95b-421a-ce99-8ec3816ee5f5"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.21666667, 0.16666667, 0.11666667, 0.2       ,\n","       0.11666667, 0.23333333, 0.11666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"tKTaDJrDXzwU","outputId":"052e9f82-f127-416a-830f-91cfc27a03ae"},"outputs":[{"data":{"text/plain":["0.16458333333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cn3af9g-XzwU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uDs9TYKhPi_U"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"egAIdkvWX28i"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"TC4Zs4C_Pi_U"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"yYH5CASnPi_U","outputId":"6e92d9d7-944d-4428-d93e-3818603a8a4e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.5041666666666667\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed: 47.6min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 9.090909090909102% relative to the initial model\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Gew_wB7pPi_U","outputId":"a5f8e7ee-fa3f-4436-ed79-b4096511e8f6"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"unaQIpFcPi_V"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"nwAyHju5X6vP"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZPOKqFjRX6vP"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"fupMQc6EX6vP","outputId":"d631811b-58f5-4ae1-a609-2734e987b984"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.4       , 0.5       , 0.46666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"M1CThpvVX6vP","outputId":"4882f4b1-1450-46fd-f739-4b1ab2a8e740"},"outputs":[{"data":{"text/plain":["0.48750000000000004"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"9_gWEv7sX6vP"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"fiy7W5ffX6vP","outputId":"66f2140c-6c37-413d-b51f-cfd419c5da21"},"outputs":[{"data":{"text/plain":["array([0.23333333, 0.175     , 0.15833333, 0.2       ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"lkjknhMeX6vP","outputId":"883a9ed1-1180-4aec-bae0-4b7b3664fc2e"},"outputs":[{"data":{"text/plain":["0.19166666666666665"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"FTXiBdQLX6vP"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"t1r-sdlxX6vP"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"CWGMzyK-X6vP","outputId":"975ad38a-35ec-4d18-a8ef-bb2d52584f9f"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.5       , 0.35      , 0.41666667, 0.53333333,\n","       0.53333333, 0.53333333, 0.56666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"H0zLw18oX6vP","outputId":"7386ec63-5c5f-4ce7-fa44-d7cfaac83498"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"A8T5rsMmX6vP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"M_t4UF1DX6vP","outputId":"ee56027c-e81e-40c6-85ab-10180b7a2f19"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.21666667, 0.16666667, 0.11666667, 0.2       ,\n","       0.11666667, 0.23333333, 0.11666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"0fJTTwT7X6vP","outputId":"94c3a629-9b22-49d9-fb76-be2af3e69ebf"},"outputs":[{"data":{"text/plain":["0.16458333333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1jmvoITgX6vP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"9GrSc9C_Pi_V"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"kD81hURuX8Gq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VvTPL3JlPi_V"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1411387,"status":"ok","timestamp":1606869242491,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VrRmVRDrPi_V","outputId":"a5fc8dc0-67c1-49c6-cd39-71624f022a35"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.16458333333333333\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed: 47.6min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.8708333333333333\n","Improvement of 429.113924050633% relative to the initial model\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":42,"status":"ok","timestamp":1606869242492,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"T_4U6bROPi_V","outputId":"7c3ea6ef-c924-434d-8233-f622ef6dced4"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jvvT0I2zA-tR"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"NBFCHmpSX_fT"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"FpOCGtljX_fT"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7Qyp61qCX_fT","outputId":"13097b29-7d34-498f-c847-4f2b75d39fa7"},"outputs":[{"data":{"text/plain":["array([0.58333333, 0.4       , 0.5       , 0.46666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"aIXn6G0DX_fT","outputId":"b8cd788a-f3f7-4ea5-cf83-d28de6c2ef80"},"outputs":[{"data":{"text/plain":["0.48750000000000004"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Cd88yjZ2X_fT"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"TBGK1CCwX_fT","outputId":"7f41eeeb-1880-4c00-be34-99864d31429b"},"outputs":[{"data":{"text/plain":["array([0.23333333, 0.175     , 0.15833333, 0.2       ])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"YrWrvhkgX_fT","outputId":"0384f82a-0b06-4f71-b7c2-fbbdb0d927c7"},"outputs":[{"data":{"text/plain":["0.19166666666666665"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"AxSU-XfPX_fU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"AmBIkKpYX_fU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"_V5IbN68X_fU","outputId":"73c2bfab-41f2-4736-80e8-36c478ad04f1"},"outputs":[{"data":{"text/plain":["array([0.6       , 0.5       , 0.35      , 0.41666667, 0.53333333,\n","       0.53333333, 0.53333333, 0.56666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"TWaCN8l7X_fU","outputId":"2438ad29-4735-418f-d7e1-75b7ec2e1aa2"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"syrzAL9rX_fU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NsiBn2glX_fU","outputId":"c1440af2-77bc-46d0-807e-1fa78edf22ec"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.21666667, 0.16666667, 0.11666667, 0.2       ,\n","       0.11666667, 0.23333333, 0.11666667])"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"LtMnsPToX_fU","outputId":"eb6de9cb-75ab-4b8e-a880-f56907ace794"},"outputs":[{"data":{"text/plain":["0.16458333333333333"]},"execution_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"0DqFlfKnX_fU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"8XqHy9Y-zFbi"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"7JuJVcluzKap"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"nDanBmu2zKap"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"vXdh3OxCzKap"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"pMbR3zyvzKap"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"RQK687eXzKap"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48750000000000004\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed: 19.1min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5291666666666667\n","Improvement of 8.547008547008538% relative to the initial model\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"1GyuhQOqzKap"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Hsydl9nEzKap"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"dZufsYMWzKap"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gYJcPYkvzKap"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"zwggFtqFzKap"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.45      , 0.575     , 0.53333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"170biW6UzKap"},"outputs":[{"data":{"text/plain":["0.5291666666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BuJajI8CzKap"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"y9sBxOW3zKap"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.39166667, 0.45833333, 0.45      ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Tu78PjDEzKap"},"outputs":[{"data":{"text/plain":["0.4375"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"p5O7LCZUzKaq"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"170jqf1TzKaq"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"4TBwzEPazKaq"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.5       , 0.5       , 0.4       , 0.56666667,\n","       0.55      , 0.48333333, 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"AHSEfnC1zKaq"},"outputs":[{"data":{"text/plain":["0.5020833333333333"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ObGDJizAzKaq"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"j_N2tqWwzKaq"},"outputs":[{"data":{"text/plain":["array([0.35      , 0.45      , 0.56666667, 0.38333333, 0.41666667,\n","       0.51666667, 0.45      , 0.36666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"IASR2chPzKaq"},"outputs":[{"data":{"text/plain":["0.4375"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"DgeJt--bzKaq"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"TD-U3cR1zKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ARh3tG3HzKaq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"wN2hsHGBzKaq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"skUAhYgczKaq"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cwJeDc5FzKaq"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.19166666666666665\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed: 19.2min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.7916666666666667\n","Improvement of 313.0434782608696% relative to the initial model\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7T6L3cEMzKaq"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"s-0TYEKRzKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Q-8Wu0mFzKaq"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1JuAwv7xzKar"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3vVCBJB-zKar"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VMeANNU5zKar"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S1WpU5CMzKar"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5TeGAl1HzKar"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6YnwjHF0zKar"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lq8oWJXFzKar"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_BRFekOUzKar"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"toTnrmmlzKar"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kKc0nDGCzKar"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OOMuvs-pzKar"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wjRpb8NBzKar"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"r53hIRRXzKar"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VRxmvc-wzKar"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"LL4QioxhzKar"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dsa5s6NCzKar"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YhmSCPQKzKar"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"x3s1ZBelzKas"},"outputs":[],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-_TCEZH-zKas"},"outputs":[],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oSYzxqW7zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8vgsOGsMzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YROEJvQ5zKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VAcVTmDZzKas"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JTR8dtFxzKas"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AphSBh3YzKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"c1VcemIGzKas"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Mw8VKeX8zKas"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F81q7WTjzKas"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WJ_jCgPzzKas"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DQYfT2OlzKas"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Tc_SstgszKas"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IoF9LLnOzKas"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a1wNxq3PzKas"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"N9f3ydSCzKas"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F0bMKlgozKas"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"RSJKARRAzKas"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"mBL6Eax3zKas"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iVOzO1_-zKas"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z765IlZJzKas"},"outputs":[],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S3UewluXzKas"},"outputs":[],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_-LO0Fa5zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FY_4P1stzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JtDObYhuzKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hs5e3gDezKas"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"V3t-_ciTzKas"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Vj9bEfC_zKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GrtGNjnnzKat"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tFlJd6qAzKat"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VdR_va-kzKat"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mbAbJmqlzKat"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IEV9F0VPzKat"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"j9nKepwezKat"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_GK6yAx_zKat"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"d05_H12ezKat"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QJaiqkrezKat"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KKwvhkyMzKat"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"gh0gtRO-D2F-"},"source":["## Random Forest Classifier"]},{"cell_type":"markdown","metadata":{"id":"8cap-uouzQCQ"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jr2mEagmPuxy"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"ZGtZPgTLYETt"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"le2W3NO8Puxy"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gmkK8kiPPuxy"},"outputs":[],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WXLhC5g3Puxy"},"outputs":[],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OSua_O1KPuxy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"uMyaSHdOYGtk"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cWwrGaApYGtk"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cJUw5awvYGtk"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7JkBGvC5YGtk"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Xz6kWFe4YGtk"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EXee_GspYGtk"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h7X0yp_8YGtk"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VDD1dk-_YGtk"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jmXtWQZ_YGtk"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NRc_AIPLYGtk"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s1ZyRf3iYGtk"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6wY5DeGLYGtk"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uraK4ZFyYGtk"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rlDNMoS2YGtk"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pi53d5suYGtk"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"E57mYUJwPuxz"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dm3nwjv8YIB7"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uhgJDujzPuxz"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7HXXuw1YPuxz"},"outputs":[],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SQT2v3dWPuxz"},"outputs":[],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZZPh5InUPuxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"fgncv-YAYKgH"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uQC7n2_9YKgH"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZOyWUPf7YKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PNiZaiTAYKgH"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uMEfoU2_YKgH"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SImpkdfFYKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8pwpVigDYKgH"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z-fMf-cOYKgH"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ySiVyU7sYKgH"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RqIaYT5rYKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gvbv0PiHYKgH"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p6Ku1ByOYKgH"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dY3402jGYKgH"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wregmdqtYKgI"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fyJpUwLIYKgI"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Tg_rwd0APuxz"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"FSZ6dmiZYLgS"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"39lY7LhiPuxz"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NOqOwG1nPuxz"},"outputs":[],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3PmUdS5nPuxz"},"outputs":[],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MN42Rb16Puxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"F_F96mTXYOPF"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H6IzjxLBYOPF"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4bWY8XZXYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"62f0GR1bYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8g0yaA4qYOPF"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uAdBpkk1YOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zMfVwgjNYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zGUXp9auYOPF"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7FB4DfFYOPF"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dSwDndEiYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fGLMhla2YOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lZMclYLSYOPF"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vk3ptRjWYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qkV7RDrQYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IvwQ0DcnYOPF"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"USGMYRvkPuxz"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"HvXfbULIYP0S"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IvpM4efCPuxz"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AosKXbMnPuxz"},"outputs":[],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Uo1epUM6Puxz"},"outputs":[],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LEbVr7kID3lP"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Z3pVdFRIYS_Y"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O1mSEfhvYS_Y"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QcLc93iFYS_Y"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sKcAejjvYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mQ_K8f1GYS_Z"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Ni0XQ4MYS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"14dpGt4HYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SlABUIa1YS_Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XcqEawTMYS_Z"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2sVRpDV0YS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WUapXFgsYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"njxWLC9cYS_Z"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fOjDRVdiYS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bN5MWN21YS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zRMQjaF0YS_Z"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"ym_PcB2Bzhy5"},"source":["### Hyper_optimized Model"]},{"cell_type":"markdown","metadata":{"id":"gLRQegMuznEx"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"UYtPQW5lznEx"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qzMbiN63znEx"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"brq7F45MznEx"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"deNrrmvfznEx"},"outputs":[],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DuwWXLzCznEx"},"outputs":[],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D_bWM63AznEx"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Dw0u6K5fznEx"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"r0bX_XinznEx"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jQQ7xE6FznEx"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q8uJkiSgznEx"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E_WvyhCkznEx"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gQ77McSEznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CrfcSLr_znEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EN0zehJcznEy"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JZd-GNejznEy"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1tuwbqxBznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2s555K_JznEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55Yt3JxVznEy"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e1uK8AAGznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vdyH7L3-znEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"y1YxHwLWznEy"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Uft0d1hpznEy"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"87fHemV8znEy"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_D-7eBzUznEy"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pUYCZWU8znEy"},"outputs":[],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_XH1O4gEznEy"},"outputs":[],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1ZpTLQHPznEy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"gB5QZVGUznEy"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9DAVY-EmznEy"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dIUnOe4_znEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hen4_Lm3znEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hxs44I_mznEz"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ea6nyuG4znEz"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mr_8apUtznEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4MN-hf_WznEz"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D0WAxV0RznEz"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vbEylF0OznEz"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oynC3pGvznEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G6C-LGo7znEz"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NOAoGC48znE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"t63ca5zEznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VMZacJ-8znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"VElWFWnwznE0"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"oilXUTU9znE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OrpD379aznE0"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GiGSxegJznE0"},"outputs":[],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"82SelhLDznE0"},"outputs":[],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jWj2VfvKznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"5N35S_S7znE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xa8-D0wpznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n2sVmxGdznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BpnIX_HjznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XPiy_g5oznE0"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"azSQOq8_znE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nOJk3jtxznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oX-bRxwfznE0"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f9IzvaKcznE0"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OjhZe7LAznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pOxeg5R-znE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FTtx-WTEznE0"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nm3LlijhznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"v8T7HCsRznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rCBj88t3znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"IqZgkBX0znE0"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"3n_oeISCznE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kAiOndRWznE0"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D6mfl16pznE0"},"outputs":[],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zIsY4x87znE0"},"outputs":[],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wOu2FqUgznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FNSg-xESznE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JAhmZr0WznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qFmuaHAOznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0PRsJdEAznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7J3uMDdGznE1"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-B3go7n2znE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yCuHLkI8znE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8hWa-aJmznE1"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5jVryRzDznE1"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9Z4ghTQ5znE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2Z3jNzMFznE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kraH7kCAznE1"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hm7ymwVIznE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2KrfQG6vznE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BFyZ88sQznE1"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"oDNCpIIRD7gz"},"source":["## XGBoost Classifier"]},{"cell_type":"markdown","metadata":{"id":"j2tykuMUzur7"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jqg0nC9EQYwp"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"NfgwRfQvYb8t"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JsLW_31BQYwp"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bLodkCQ_QYwp"},"outputs":[],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RXLNwgL-QYwp"},"outputs":[],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yX4Rcv6hQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"g3KPsQ60YgQm"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RxzUgIo2YgQm"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rsR68pOvYgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7K1nRVGxYgQm"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qHeNXZf2YgQm"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RBCMfcXSYgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZRQ_1B9WYgQm"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hpacKrT3YgQm"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9EUD5_4AYgQm"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qDQJIez_YgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z-mkU6E6YgQn"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1epIp3BNYgQn"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JoJL01LrYgQn"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"b6bf8HGHYgQn"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7y55nYzYYgQn"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Wh2r7aqvQYwq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"PVhR6RhrYjM2"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hxo_eo5IQYwq"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wr7MB0OmQYwq"},"outputs":[],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LQKZiM2UQYwq"},"outputs":[],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_M0E115eQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"VDgQXkvRYogs"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VIkd9Qu2Yogs"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OvM-Fvb3Yogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iUk0ifWiYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PHgkhMkOYogs"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AHTtZ-8fYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z9HpvbW3Yogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l5gaVnt6Yogs"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a3zuz6rrYogs"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cW3BKU5wYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ancDGUAjYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LFXL4CazYogs"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E4x6WM0SYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8guPYbmSYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tg598195Yogs"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AGYcf92VQYwq"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dk6vZ3MYYqf_"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RyTE9hZoQYwq"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gak6l1CXQYwq"},"outputs":[],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0rxn8OrlQYwq"},"outputs":[],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2BQXvF4KQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Io2FlXTHYt3K"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bI2jZQ7FYt3K"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"he-l5p-SYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uy8sRZwLYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A8qBvhgVYt3K"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-dgZAbImYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"m3bDkAUgYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dfF2wiF7Yt3K"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nLTq2VfkYt3K"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rC72bI8rYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"otMnNNBJYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iz34DmjlYt3K"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GWhpQqdCYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eljr226pYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BrLIGAzbYt3K"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"1O6rD9RLQYwq"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"RIQdan6pYvOX"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h5xA-bMkQYwq"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HOQsRZ_8QYwq"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aHQhKc--QYwq"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eseZcKAoJ__G"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"yLZCsP0eY1pQ"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7kKF19DY1pQ"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KWcoIkfCY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jnyaRlzsY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9NgKsUKFY1pQ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zueJZ-5YY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PP9j9jbzY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HwbywwFEY1pQ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zR8v_IjfY1pQ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O_LHVRPTY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SnRWttBqY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S8E5UdVMY1pQ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iSNXFoQYY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZDu2p-FDY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mliqJis0Y1pQ"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uqoeswDMnyci"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"JAynU_HI0PBY"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"vgrN6ot60PBY"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"O48noycN0PBY"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jDpeFtN80PBY"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QnV8vzRh0PBY"},"outputs":[],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HJzjh4ga0PBY"},"outputs":[],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IE2N7VHD0PBY"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"YSJmQn2_0PBY"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B9OPp_sT0PBY"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7UF8Fh0r0PBY"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LHHSq-ze0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NU2etCDh0PBZ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vzs-oG2Q0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Y5LNQ2Im0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zWt5dGZS0PBZ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R9R3q8lF0PBZ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uuD97M-r0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QWUwvFh-0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vEfN1lmG0PBZ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0srZvvEV0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ugLG-QXc0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F6Eu517e0PBa"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"90su4wIc0PBa"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"MJ4OmTw50PBa"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vJnjTODu0PBa"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NgcVhOm00PBa"},"outputs":[],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aEo-v5Sh0PBa"},"outputs":[],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z1CdrcR-0PBa"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ss4KdVSQ0PBa"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SC7I2If40PBa"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6DhduOKd0PBa"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wDo0HinI0PBa"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6DDy143g0PBa"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o-nojkLm0PBa"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7W4s6Znt0PBa"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GbdcHa7A0PBb"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VzBE8UbC0PBb"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YFf8uy7j0PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s0Qet-vx0PBb"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G1pViHjW0PBb"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HngwE8vS0PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wcsNamsp0PBb"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"480rGKpC0PBb"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AbL7-dbc0PBb"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"tnN0ijSs0PBb"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Tx_6QIyU0PBb"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iJrhBHOb0PBb"},"outputs":[],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IkkX2HRP0PBb"},"outputs":[],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tqiloYtR0PBb"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Ropu3-tW0PBb"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"k0e0jkDZ0PBb"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bIeTuXR00PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QSQ-6v460PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sj8Sha_x0PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4yc-2qz10PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"neS6G0C10PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7MXe6xRr0PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ct3yEerV0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iSfJeL230PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kojZ2SUM0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A_CcH-Ql0PBc"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Tn152nR0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tRSdT7Wx0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BLyOKveN0PBc"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Oq6LsPJw0PBc"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"eUk34NiQ0PBc"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7tnmONbH0PBc"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"45KiYK090PBc"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G2tlj00W0PBc"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AFtm3Nt40PBc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"1X2T4ocQ0PBc"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mOdemmuz0PBc"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0IbOynDY0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mWi1QK860PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zz1UZyb90PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pc4AEhkH0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IZONW9Eg0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J0yH0nP80PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f_XTLXOd0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ejufwDue0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f0rOZsMN0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MLvMmLOC0PBd"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tMpVsZzS0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"13om3syO0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9kuC5h0B0PBd"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55_ocXPFoH8Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wzk61CezoI2E"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YUIZoGclSNMr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n4DB9nM9WS_I"},"outputs":[],"source":[""]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Machine Learning Computation - quadratic - full","provenance":[{"file_id":"1wV98L2ux7aXgacLTPCET4rezuozEXbNB","timestamp":1606814445981},{"file_id":"1FKzRRIZhxD6H3s8wEXUtnoGk7FOlng8M","timestamp":1605987313010},{"file_id":"https://github.com/fastai/fastai/blob/master/nbs/44_tutorial.tabular.ipynb","timestamp":1605742460785}],"toc_visible":true,"version":""},"jupytext":{"split_at_heading":true},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"}},"nbformat":4,"nbformat_minor":0}