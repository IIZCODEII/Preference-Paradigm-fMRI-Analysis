{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"0q0cnNSixB9u"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MRb0FZftSf1k"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tKtiW9P0o7fM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Cs4vCXzHXrFL"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from numpy import array\n","import matplotlib.pyplot as plt\n","\n","from sklearn.feature_selection import f_classif, mutual_info_classif, SelectFdr\n","\n","from sklearn.feature_selection import GenericUnivariateSelect\n","from sklearn.svm import LinearSVC, NuSVC\n","from sklearn.model_selection import train_test_split\n","from sklearn.ensemble import RandomForestClassifier \n","\n","from scipy.stats import uniform, randint\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from sklearn.naive_bayes import GaussianNB\n","from sklearn.svm import SVC\n","from sklearn.datasets import load_digits\n","from sklearn.model_selection import learning_curve\n","from sklearn.model_selection import ShuffleSplit\n","from sklearn.model_selection import cross_val_score\n","\n","import xgboost as xgb\n","from sklearn.metrics import auc, accuracy_score, confusion_matrix, mean_squared_error\n","from sklearn.model_selection import cross_val_score, GridSearchCV, KFold, RandomizedSearchCV, train_test_split\n","\n","from warnings import filterwarnings\n","filterwarnings('ignore')\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F9rXqu8pJW8o"},"outputs":[],"source":["\n","def plot_learning_curve(estimator, title, X, y, axes=None, ylim=None, cv=None,\n","                        n_jobs=None, train_sizes=np.linspace(.1, 1.0, 5)):\n","    \"\"\"\n","    Generate 3 plots: the test and training learning curve, the training\n","    samples vs fit times curve, the fit times vs score curve.\n","\n","    Parameters\n","    ----------\n","    estimator : object type that implements the \"fit\" and \"predict\" methods\n","        An object of that type which is cloned for each validation.\n","\n","    title : string\n","        Title for the chart.\n","\n","    X : array-like, shape (n_samples, n_features)\n","        Training vector, where n_samples is the number of samples and\n","        n_features is the number of features.\n","\n","    y : array-like, shape (n_samples) or (n_samples, n_features), optional\n","        Target relative to X for classification or regression;\n","        None for unsupervised learning.\n","\n","    axes : array of 3 axes, optional (default=None)\n","        Axes to use for plotting the curves.\n","\n","    ylim : tuple, shape (ymin, ymax), optional\n","        Defines minimum and maximum yvalues plotted.\n","\n","    cv : int, cross-validation generator or an iterable, optional\n","        Determines the cross-validation splitting strategy.\n","        Possible inputs for cv are:\n","\n","          - None, to use the default 5-fold cross-validation,\n","          - integer, to specify the number of folds.\n","          - :term:`CV splitter`,\n","          - An iterable yielding (train, test) splits as arrays of indices.\n","\n","        For integer/None inputs, if ``y`` is binary or multiclass,\n","        :class:`StratifiedKFold` used. If the estimator is not a classifier\n","        or if ``y`` is neither binary nor multiclass, :class:`KFold` is used.\n","\n","        Refer :ref:`User Guide \u003ccross_validation\u003e` for the various\n","        cross-validators that can be used here.\n","\n","    n_jobs : int or None, optional (default=None)\n","        Number of jobs to run in parallel.\n","        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.\n","        ``-1`` means using all processors. See :term:`Glossary \u003cn_jobs\u003e`\n","        for more details.\n","\n","    train_sizes : array-like, shape (n_ticks,), dtype float or int\n","        Relative or absolute numbers of training examples that will be used to\n","        generate the learning curve. If the dtype is float, it is regarded as a\n","        fraction of the maximum size of the training set (that is determined\n","        by the selected validation method), i.e. it has to be within (0, 1].\n","        Otherwise it is interpreted as absolute sizes of the training sets.\n","        Note that for classification the number of samples usually have to\n","        be big enough to contain at least one sample from each class.\n","        (default: np.linspace(0.1, 1.0, 5))\n","    \"\"\"\n","    if axes is None:\n","        _, axes = plt.subplots(1, 3, figsize=(20, 5))\n","\n","    axes[0].set_title(title)\n","    if ylim is not None:\n","        axes[0].set_ylim(*ylim)\n","    axes[0].set_xlabel(\"Training examples\")\n","    axes[0].set_ylabel(\"Score\")\n","\n","    train_sizes, train_scores, test_scores, fit_times, _ = \\\n","        learning_curve(estimator, X, y, cv=cv, n_jobs=n_jobs,\n","                       train_sizes=train_sizes,\n","                       return_times=True)\n","    train_scores_mean = np.mean(train_scores, axis=1)\n","    train_scores_std = np.std(train_scores, axis=1)\n","    test_scores_mean = np.mean(test_scores, axis=1)\n","    test_scores_std = np.std(test_scores, axis=1)\n","    fit_times_mean = np.mean(fit_times, axis=1)\n","    fit_times_std = np.std(fit_times, axis=1)\n","\n","    # Plot learning curve\n","    axes[0].grid()\n","    axes[0].fill_between(train_sizes, train_scores_mean - train_scores_std,\n","                         train_scores_mean + train_scores_std, alpha=0.1,\n","                         color=\"r\")\n","    axes[0].fill_between(train_sizes, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1,\n","                         color=\"g\")\n","    axes[0].plot(train_sizes, train_scores_mean, 'o-', color=\"r\",\n","                 label=\"Training score\")\n","    axes[0].plot(train_sizes, test_scores_mean, 'o-', color=\"g\",\n","                 label=\"Cross-validation score\")\n","    axes[0].legend(loc=\"best\")\n","\n","    # Plot n_samples vs fit_times\n","    axes[1].grid()\n","    axes[1].plot(train_sizes, fit_times_mean, 'o-')\n","    axes[1].fill_between(train_sizes, fit_times_mean - fit_times_std,\n","                         fit_times_mean + fit_times_std, alpha=0.1)\n","    axes[1].set_xlabel(\"Training examples\")\n","    axes[1].set_ylabel(\"fit_times\")\n","    axes[1].set_title(\"Scalability of the model\")\n","\n","    # Plot fit_time vs score\n","    axes[2].grid()\n","    axes[2].plot(fit_times_mean, test_scores_mean, 'o-')\n","    axes[2].fill_between(fit_times_mean, test_scores_mean - test_scores_std,\n","                         test_scores_mean + test_scores_std, alpha=0.1)\n","    axes[2].set_xlabel(\"fit_times\")\n","    axes[2].set_ylabel(\"Score\")\n","    axes[2].set_title(\"Performance of the model\")\n","\n","    return plt"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0KzSKSrn_INa"},"outputs":[],"source":["def hyper_opt_procedure(model_object,params,cv,perf_df,X,y):\n","\n","\n","  model = model_object()\n","\n","  # Initial Model Fit with stock hyper_params\n","\n","  init_score = np.mean(cross_val_score(model,X,y,cv=cv))\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Stock Params',\n","                              'Score':init_score}, ignore_index=True)\n","\n","  print('Initial Model with Stock Params Score : {}'.format(init_score))\n","\n","  # Random Search Cross Validation\n","\n","\n","  search_model = RandomizedSearchCV(model,\n","                                         param_distributions=params,\n","                                         random_state=42, \n","                                         n_iter=300, \n","                                         cv=cv, \n","                                         verbose=1, \n","                                         n_jobs=1, \n","                                         return_train_score=True)\n","\n","  search_model.fit(X,y)\n","\n","  best_search_model = search_model.best_estimator_\n","\n","  best_search_model_score = search_model.best_score_\n","\n","  perf_df = perf_df.append({'Model Iteration': 'Random HP Search Best Model',\n","                      'Score':best_search_model_score}, ignore_index=True)\n","\n","  rd_score_improv = ((best_search_model_score - init_score)/init_score) * 100\n","\n","  print('Random HP Search Best Model Score : {}'.format(best_search_model_score))\n","\n","  print('Improvement of {}% relative to the initial model'.format(rd_score_improv))\n","  \n","  \n","\n","\n","  return model, best_search_model\n","   \n","\n","\n","\n","class hyper_model:\n","    \n","    def __init__(self,model_name,validation_approach,X,y):\n","        \n","        self.model_name = model_name\n","        self.X = X\n","        self.y = y\n","        self.validation_approach= validation_approach\n","        self.best_model = None\n","        self.best_params = None\n","        self.all_models_perf = pd.DataFrame(None,columns=['Model Iteration','Score'])\n","        self.stock_model = None\n","        self.rd_model = None\n","\n","\n","    def fit(self):\n","\n","\n","      if self.validation_approach == 'leave-one-run-out':\n","\n","        cv = KFold(n_splits=8, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-run-out-shuffled':\n","\n","        cv = KFold(n_splits=8, shuffle=True, random_state=42)\n","\n","      elif self.validation_approach == 'leave-one-task-out':\n","\n","        cv = KFold(n_splits=4, shuffle=False)\n","\n","      elif self.validation_approach == 'leave-one-task-out-shuffled':\n","\n","        cv = KFold(n_splits=4, shuffle=True, random_state=42)    \n","\n","\n"," \n","        \n","        # Linear SVM\n","\n","      if self.model_name == 'linear_svm':\n","\n","        params = {'C': [0.1, 1, 10, 100, 1000]} \n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=LinearSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","         \n","\n","      # Non Linear SVM\n","\n","\n","      elif self.model_name == 'non_linear_svm':\n","\n","        params = {'nu': [0.01, 0.3, 0.5, 0.7, 1],  \n","                        'gamma': [1, 0.1, 0.01, 0.001, 0.0001], \n","                        'kernel': ['rbf','poly','sigmoid']\n","                       }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=NuSVC,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","\n","          \n","      # Random Forest Classifier\n","\n","\n","      elif self.model_name == 'random_forest_classifier':\n","\n","\n","        params = {'bootstrap': [True, False],\n","                    'max_depth': [50, 60, 70, 80, 90, 100],\n","                    'max_features': ['auto', 'sqrt'],\n","                    'min_samples_leaf': [1, 2, 4],\n","                    'min_samples_split': [2, 5, 10],\n","                    'n_estimators': [1000, 1200, 1400, 1600, 1800, 2000]\n","                   }\n","\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=RandomForestClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)\n","          \n","\n","\n","\n","      # XG Boost Classifier\n","\n","\n","      elif self.model_name == 'xg_boost':\n","\n","        params = {\n","              \"colsample_bytree\": uniform(0.7, 0.3),\n","              \"gamma\": uniform(0, 0.5),\n","              \"learning_rate\": uniform(0.03, 0.3), \n","              \"max_depth\": randint(2, 6), \n","              \"n_estimators\": randint(100, 150),\n","              \"subsample\": uniform(0.6, 0.4)\n","              }\n","\n","        self.stock_model, self.rd_model = hyper_opt_procedure(model_object=xgb.XGBClassifier,\n","                                                                                                 params=params,cv=cv,\n","                                                                                                 perf_df=self.all_models_perf,\n","                                                                                                 X=self.X,y=self.y)  \n","\n","                \n","                "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21587,"status":"ok","timestamp":1606853646165,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hO1Z8nwls9_Y","outputId":"87916643-95a1-43ba-9812-19ea7418e2ff"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive/\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive/',force_remount=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":974,"status":"ok","timestamp":1606853646166,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AU6YvpHup87A","outputId":"6bd3511a-1ad3-4dab-f1eb-8483df1e9ad9"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[0m\u001b[01;34mdrive\u001b[0m/  \u001b[01;34msample_data\u001b[0m/\n"]}],"source":["ls"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1042,"status":"ok","timestamp":1606853646650,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jtOjcM89tPUT","outputId":"eda5e03f-dd88-4563-efa3-a1385560b0cf"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/CEA\n"]}],"source":["cd drive/MyDrive/CEA/"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mK0bYtMjvknM"},"outputs":[],"source":["X = np.load('data/X_pref_lss_shift_constant_vmpfc.npy')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":649,"status":"ok","timestamp":1606853672649,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uqbxJx6gxbey","outputId":"51986603-2781-4f2c-f469-d69dc287c5b5"},"outputs":[{"data":{"text/plain":["(480, 419)"]},"execution_count":8,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Iojp3abFv1W0"},"outputs":[],"source":["y = np.load('data/y_pref_lss_shift_constant_vmpfc.npy')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":412,"status":"ok","timestamp":1606853678553,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HRfd5YRExl6M","outputId":"4b464958-7a3d-4bae-e5ef-7c51000ba982"},"outputs":[{"data":{"text/plain":["(480, 1)"]},"execution_count":10,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["y.shape"]},{"cell_type":"markdown","metadata":{"id":"-eDis182XeSE"},"source":["## Features Selection"]},{"cell_type":"markdown","metadata":{"id":"G7d7JTJmXgwj"},"source":["### Filter"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Kexq1fnyXkRY"},"outputs":[],"source":["transformer = GenericUnivariateSelect(mutual_info_classif, mode='k_best', param=419)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FAZkKRmhXnPo"},"outputs":[],"source":["X_trans = transformer.fit_transform(X, y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2327,"status":"ok","timestamp":1606853692728,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BKKN66taXoz0","outputId":"ff8425ed-1f2c-4929-fc9a-36e73355f2ce"},"outputs":[{"data":{"text/plain":["(480, 419)"]},"execution_count":13,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["X_trans.shape"]},{"cell_type":"markdown","metadata":{"id":"cC_RDtVZYwG0"},"source":["### Data Preparation"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8OmeM2TuYzDd"},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10, random_state=42)"]},{"cell_type":"markdown","metadata":{"id":"3rxGDdS1Y2A6"},"source":["## Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"3e6kNyHGxE_w"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"oK0OX_9xnzWv"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"P0slq_QtT_P1"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"url-dxiyoJsT"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20824,"status":"ok","timestamp":1606854556897,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"MATeUxpJo9DC","outputId":"b8025aec-5a6b-4c2c-8b64-cd2735a4e2b2"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48333333333333334\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    8.6s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5\n","Improvement of 3.448275862068965% relative to the initial model\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":20791,"status":"ok","timestamp":1606854556898,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-LuUfzJYuZ5c","outputId":"48cdb518-63e5-401f-b62e-767ace0ee029"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":20,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hlwfN3l9XDr-"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"WnDMByUhXMfO"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"obSzi-BEXMfO"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22444,"status":"ok","timestamp":1606854558588,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aPPDOaCxXMfO","outputId":"f17905ec-c4fc-4ab8-edf0-e6370e018415"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.45833333, 0.525     , 0.51666667])"]},"execution_count":22,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22433,"status":"ok","timestamp":1606854558589,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9l85G4epXMfO","outputId":"0ef1ef33-eea8-4a31-a6e0-464599b8434b"},"outputs":[{"data":{"text/plain":["0.5"]},"execution_count":23,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nZiTeY6mXMfO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":23911,"status":"ok","timestamp":1606854560092,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Imp-qfZeXMfO","outputId":"cb9f37c5-9000-47d6-b824-c912ee7098ef"},"outputs":[{"data":{"text/plain":["array([0.2       , 0.20833333, 0.15833333, 0.14166667])"]},"execution_count":25,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":23899,"status":"ok","timestamp":1606854560092,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y6HNpYl_XMfO","outputId":"b4c51c84-709b-4350-c552-1a6299651ff5"},"outputs":[{"data":{"text/plain":["0.17708333333333331"]},"execution_count":26,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"osKpbfvyXMfO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w2SlhLffXMfO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":27968,"status":"ok","timestamp":1606854564196,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FqjIqTD1XMfO","outputId":"5de1cfb6-d44b-4f6a-f0a5-16bb3c787500"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.56666667, 0.48333333, 0.45      , 0.46666667,\n","       0.5       , 0.53333333, 0.48333333])"]},"execution_count":28,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":27957,"status":"ok","timestamp":1606854564197,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yZVtOibiXMfO","outputId":"41632733-ce50-4365-d4ca-4651413a2328"},"outputs":[{"data":{"text/plain":["0.49375"]},"execution_count":29,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oajU1LQ3XMfP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":31779,"status":"ok","timestamp":1606854568046,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ADNditLZXMfP","outputId":"05ffc880-f651-47e9-b2ba-b967f2664589"},"outputs":[{"data":{"text/plain":["array([0.1       , 0.13333333, 0.06666667, 0.13333333, 0.1       ,\n","       0.08333333, 0.08333333, 0.1       ])"]},"execution_count":31,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":31765,"status":"ok","timestamp":1606854568046,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"goo-B_3cXMfP","outputId":"c76e2125-48f2-421e-c123-df5eb475668c"},"outputs":[{"data":{"text/plain":["0.1"]},"execution_count":32,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"P-5MwWHhXMfP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Gb-Qqwn8oJ7d"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"R4mMDLPsWAmE"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Cee0jzzPIFx"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":42329,"status":"ok","timestamp":1606854578646,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JGJS_yz6PIFy","outputId":"50d286aa-4fea-4fb4-eca8-c9561b6c9e41"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.17083333333333334\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    8.0s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.20625\n","Improvement of 20.731707317073162% relative to the initial model\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":42318,"status":"ok","timestamp":1606854578647,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JAf3le69PIFy","outputId":"4b3df13a-d313-4682-ab9d-09106fe79784"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":36,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WIsSLawaoR-_"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"CMPrOUDoWFWr"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Vd_umY9HWFWr"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":43896,"status":"ok","timestamp":1606854580260,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tpxUGequWFWr","outputId":"80130456-955f-430e-fca5-2c4a675c01c7"},"outputs":[{"data":{"text/plain":["array([0.56666667, 0.44166667, 0.5       , 0.48333333])"]},"execution_count":38,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":43885,"status":"ok","timestamp":1606854580261,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LCzQufNtWFWr","outputId":"f93d58c3-c1e7-4caf-aea9-64f285c72537"},"outputs":[{"data":{"text/plain":["0.4979166666666667"]},"execution_count":39,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pSmKo3hZWFWr"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":45340,"status":"ok","timestamp":1606854581740,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7hn8vbGCWFWr","outputId":"dd479351-9cc2-41ef-eff3-d5bc0f806c8f"},"outputs":[{"data":{"text/plain":["array([0.20833333, 0.2       , 0.15833333, 0.14166667])"]},"execution_count":41,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":45328,"status":"ok","timestamp":1606854581740,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PxVtKHfUWFWr","outputId":"deb6dc6f-9b5f-4d4d-9831-f57acc440ab4"},"outputs":[{"data":{"text/plain":["0.17708333333333331"]},"execution_count":42,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ChZvGrkeWFWr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3uCFUnE0WFWr"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":49366,"status":"ok","timestamp":1606854585814,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"8CGhPtsfWFWr","outputId":"d88661ff-2d3f-4c32-9ad9-681588fd48e7"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.55      , 0.38333333, 0.51666667, 0.55      ,\n","       0.55      , 0.53333333, 0.45      ])"]},"execution_count":44,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":49355,"status":"ok","timestamp":1606854585814,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"D0iWmziUWFWr","outputId":"db6f4e55-c458-4299-8059-69df9e2adfd9"},"outputs":[{"data":{"text/plain":["0.5083333333333334"]},"execution_count":45,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xdhCavSlWFWr"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":52980,"status":"ok","timestamp":1606854589486,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1JmYYZIwWFWr","outputId":"fc109d0a-c3b6-4a86-9ff4-5f3f09622af8"},"outputs":[{"data":{"text/plain":["array([0.1       , 0.16666667, 0.03333333, 0.15      , 0.11666667,\n","       0.08333333, 0.08333333, 0.06666667])"]},"execution_count":47,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":52970,"status":"ok","timestamp":1606854589487,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"9JDZ-36UWFWr","outputId":"650e68e0-4010-4327-c23e-fc9b5faaaf60"},"outputs":[{"data":{"text/plain":["0.09999999999999999"]},"execution_count":48,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nbRpu_f0WFWr"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"yk1VAnOFoSCu"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qK7ud6-dWV9T"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BjBXz_jRPPJO"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":77555,"status":"ok","timestamp":1606854614106,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CnbTertnPPJO","outputId":"edfe0b11-6bf3-4abb-f26c-6461f899aca5"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.49583333333333335\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:   19.9s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5458333333333334\n","Improvement of 10.084033613445387% relative to the initial model\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":77544,"status":"ok","timestamp":1606854614107,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sHMdRLUsPPJP","outputId":"7f8a1bcf-7204-40ba-9ac6-f60dc5835fae"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":52,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VhkTeBlsoSGf"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ffRmE2HzXfw2"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xjJzKwpEXfw2"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":79161,"status":"ok","timestamp":1606854615758,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"FfqjXtzaXfw2","outputId":"b5d25c9d-160d-4a32-c640-3bbda96e4765"},"outputs":[{"data":{"text/plain":["array([0.525     , 0.45833333, 0.5       , 0.44166667])"]},"execution_count":54,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":79151,"status":"ok","timestamp":1606854615759,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XCi4tf0uXfw2","outputId":"8f9d1605-aced-407a-d63c-cde02c6b69ad"},"outputs":[{"data":{"text/plain":["0.48125"]},"execution_count":55,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f4rrkYJUXfw2"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":80754,"status":"ok","timestamp":1606854617384,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ldUaBM8oXfw2","outputId":"361b90f4-5e5b-433c-f16e-97b039b2b5e5"},"outputs":[{"data":{"text/plain":["array([0.2       , 0.18333333, 0.15833333, 0.15      ])"]},"execution_count":57,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":80743,"status":"ok","timestamp":1606854617384,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kiw1b1y8Xfw2","outputId":"28769de2-9456-4a81-9707-41083bbb7e78"},"outputs":[{"data":{"text/plain":["0.17291666666666666"]},"execution_count":58,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bNAQZX5ZXfw2"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RYc1l8DXXfw2"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":84818,"status":"ok","timestamp":1606854621494,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"69s38be1Xfw2","outputId":"38d5d08d-a11d-4ca3-d6ab-c1bb1713e5c3"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.53333333, 0.46666667, 0.48333333, 0.5       ,\n","       0.48333333, 0.51666667, 0.56666667])"]},"execution_count":60,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":84808,"status":"ok","timestamp":1606854621495,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"nVk4MjlQXfw2","outputId":"fa216b24-7782-4140-e763-d3e03b2a1fa3"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":61,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"88KOXS3VXfw2"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":88543,"status":"ok","timestamp":1606854625254,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"bImXksWpXfw2","outputId":"3043b60c-9e7d-4cbb-dddd-dceb0cd82f26"},"outputs":[{"data":{"text/plain":["array([0.11666667, 0.13333333, 0.06666667, 0.11666667, 0.08333333,\n","       0.06666667, 0.1       , 0.1       ])"]},"execution_count":63,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":88532,"status":"ok","timestamp":1606854625254,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QWbqk81KXfw2","outputId":"b17b1a93-37a9-41a4-cecb-a4c61907a99e"},"outputs":[{"data":{"text/plain":["0.09791666666666667"]},"execution_count":64,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gvhldUdEXfw2"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ryKXIhosWkY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LuqDNEUVXem2"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8Z7a-FGHoSKO"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Wjkj4swhXhgq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eWJfI5YnPPzE"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":112647,"status":"ok","timestamp":1606854649429,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-QFW2J0HPPzE","outputId":"489c05c4-7549-4be2-fd6f-cae80a209033"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.09791666666666667\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:   19.5s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.13541666666666669\n","Improvement of 38.297872340425556% relative to the initial model\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":112636,"status":"ok","timestamp":1606854649430,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Diwlgrr6PPzE","outputId":"81f9274d-6103-4d93-f2bb-4a56896439c2"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":68,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p_zezBW2SWjz"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"rjvf3p9eXkKN"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Nic0nOPtXkKN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":114248,"status":"ok","timestamp":1606854651076,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"J-OqyJx4XkKO","outputId":"35ffa8de-de20-4d16-cfb3-6951af29dfb3"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.44166667, 0.53333333, 0.45833333])"]},"execution_count":70,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":114238,"status":"ok","timestamp":1606854651077,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"I2V919yeXkKO","outputId":"29d9855e-532a-4cfc-f867-1c2aed1b851e"},"outputs":[{"data":{"text/plain":["0.475"]},"execution_count":71,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CQo-9ubKXkKO"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":115744,"status":"ok","timestamp":1606854652605,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YTzKNz4rXkKO","outputId":"81e5d969-c4ad-4549-8918-d202cdf34e42"},"outputs":[{"data":{"text/plain":["array([0.2       , 0.19166667, 0.15      , 0.15      ])"]},"execution_count":73,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":115733,"status":"ok","timestamp":1606854652606,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"2GWAFm_6XkKO","outputId":"54daa340-90bc-4e42-8685-d7f66bf9f95d"},"outputs":[{"data":{"text/plain":["0.1729166666666667"]},"execution_count":74,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-c5IHn17XkKO"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Okf-45vIXkKO"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":119862,"status":"ok","timestamp":1606854656769,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"HfQ03o7aXkKO","outputId":"c35febba-7455-4c58-e313-83c80ae30003"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.51666667, 0.46666667, 0.5       , 0.51666667,\n","       0.51666667, 0.53333333, 0.46666667])"]},"execution_count":76,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":119851,"status":"ok","timestamp":1606854656769,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5XRG6jEEXkKO","outputId":"dec6572d-8fdc-4f8e-d0e9-ac7fc0a00c99"},"outputs":[{"data":{"text/plain":["0.5"]},"execution_count":77,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7-0CnEaYXkKO"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":123808,"status":"ok","timestamp":1606854660749,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-0quuBcgXkKO","outputId":"cdd924e9-ce0b-4c48-f9d7-d9c601208ac7"},"outputs":[{"data":{"text/plain":["array([0.1       , 0.13333333, 0.05      , 0.15      , 0.11666667,\n","       0.08333333, 0.1       , 0.06666667])"]},"execution_count":79,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":123798,"status":"ok","timestamp":1606854660750,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"X16n6fn-XkKO","outputId":"20cd117f-9152-4fbb-c0bf-8c146d7246d8"},"outputs":[{"data":{"text/plain":["0.1"]},"execution_count":80,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UDRY8j-5XkKO"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Lja4q_wLTg0R"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"stZ6DO2sThIc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"TTW32YjnxcFK"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"mvKVuHmJxcFL"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"JYV5csm3xcFL"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OzOIKjnrxcFL"},"outputs":[],"source":["hm_linear_svm_to = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":134536,"status":"ok","timestamp":1606854671544,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ugzTVwdBxcFL","outputId":"0092dc84-1060-4746-b6e0-e4b14ebe91ad"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.48125\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    8.5s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5291666666666667\n","Improvement of 9.956709956709956% relative to the initial model\n"]}],"source":["hm_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":134526,"status":"ok","timestamp":1606854671545,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"BcoF6XGAxcFL","outputId":"357928bb-5cc1-437a-9ada-2cb81e8d0100"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":84,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gz3DAOnAxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"MU1PmbLuxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R_IY4nR0xcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":136341,"status":"ok","timestamp":1606854673394,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LXgqGhMMxcFM","outputId":"9d57b995-c808-4395-cd6b-d8f7f4910f0a"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.53333333, 0.55      , 0.525     ])"]},"execution_count":86,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":136330,"status":"ok","timestamp":1606854673394,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cQSax0c_xcFM","outputId":"a910989f-f678-492c-d8a7-a11cffe1ca7e"},"outputs":[{"data":{"text/plain":["0.5270833333333333"]},"execution_count":87,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B6QFFuZoxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":138048,"status":"ok","timestamp":1606854675134,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jpdF-f29xcFM","outputId":"d6acb517-bac7-43f0-9406-9e85b80ee89d"},"outputs":[{"data":{"text/plain":["array([0.20833333, 0.225     , 0.175     , 0.15833333])"]},"execution_count":89,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":138037,"status":"ok","timestamp":1606854675135,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tWt6NvLnxcFM","outputId":"45beba7d-9c74-45ad-8434-7a1afe33b4a7"},"outputs":[{"data":{"text/plain":["0.19166666666666668"]},"execution_count":90,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mrvkWQG2xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f6ono8bWxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":141655,"status":"ok","timestamp":1606854678786,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"opbGpr4qxcFM","outputId":"76bd3cd4-64a8-4105-eacc-5f5d14bce963"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.53333333, 0.55      , 0.5       , 0.48333333,\n","       0.41666667, 0.53333333, 0.58333333])"]},"execution_count":92,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":141644,"status":"ok","timestamp":1606854678787,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"K1ZpmNBAxcFM","outputId":"02dc10f7-c963-4a4c-9eae-f79cc12b73c4"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":93,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jm7mkIIdxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":145705,"status":"ok","timestamp":1606854682870,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"pvspMz5zxcFM","outputId":"666ec8df-6290-40be-967f-7137c485dd24"},"outputs":[{"data":{"text/plain":["array([0.11666667, 0.13333333, 0.11666667, 0.15      , 0.13333333,\n","       0.11666667, 0.1       , 0.08333333])"]},"execution_count":95,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":145695,"status":"ok","timestamp":1606854682871,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xBjz_G5TxcFM","outputId":"ee75c4cb-8216-4df9-908c-11249840c273"},"outputs":[{"data":{"text/plain":["0.11875"]},"execution_count":96,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dC9pWR3WxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"XedkRZHwxcFM"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"9HiVDnozxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uwuuHEYlxcFM"},"outputs":[],"source":["hm_linear_svm_tos = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":155710,"status":"ok","timestamp":1606854692920,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"l-XinugXxcFM","outputId":"6844a6d1-f0c4-4931-dd4a-31dd70e1795c"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.175\n","Fitting 4 folds for each of 5 candidates, totalling 20 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  20 out of  20 | elapsed:    8.0s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.20833333333333331\n","Improvement of 19.047619047619044% relative to the initial model\n"]}],"source":["hm_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":155701,"status":"ok","timestamp":1606854692921,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7tvjFgLoxcFM","outputId":"a5896c39-f516-417c-9dcf-dc492bf0f043"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":100,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EbZRWXTwxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qEfs8n21xcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QGT0CuzPxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":157852,"status":"ok","timestamp":1606854695106,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"O65IF5P6xcFM","outputId":"d33415b1-5e7c-413f-ce9e-3e709aa96932"},"outputs":[{"data":{"text/plain":["array([0.49166667, 0.475     , 0.525     , 0.525     ])"]},"execution_count":102,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":157842,"status":"ok","timestamp":1606854695107,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"g135jDm3xcFM","outputId":"f300e1dd-9de1-47df-d08f-0dc9682110d5"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":103,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"U4ZzCpkwxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":159020,"status":"ok","timestamp":1606854696308,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ghEGnajnxcFM","outputId":"73622d30-ec89-4f22-dd14-d2c6503906da"},"outputs":[{"data":{"text/plain":["array([0.23333333, 0.21666667, 0.18333333, 0.16666667])"]},"execution_count":105,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":159010,"status":"ok","timestamp":1606854696309,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1dQIJEXixcFM","outputId":"8f3b1e12-490c-4e34-9149-0ddc255c931a"},"outputs":[{"data":{"text/plain":["0.19999999999999998"]},"execution_count":106,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Bx9r41ixcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_PSdLsDqxcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":162862,"status":"ok","timestamp":1606854700194,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"r1C0gBd-xcFM","outputId":"c2338678-d056-48fc-ed0c-201aff462e31"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.55      , 0.48333333, 0.56666667, 0.48333333,\n","       0.48333333, 0.51666667, 0.51666667])"]},"execution_count":108,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":162850,"status":"ok","timestamp":1606854700194,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sd_600a3xcFM","outputId":"e08a8914-5ab0-4480-f8cf-ded7b0166ccf"},"outputs":[{"data":{"text/plain":["0.50625"]},"execution_count":109,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NTsPzbnSxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":167113,"status":"ok","timestamp":1606854704480,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"jb5RMb-pxcFM","outputId":"575fe479-8903-49ce-e3cc-304ddaf0a8a4"},"outputs":[{"data":{"text/plain":["array([0.15      , 0.15      , 0.06666667, 0.18333333, 0.18333333,\n","       0.11666667, 0.13333333, 0.08333333])"]},"execution_count":111,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":167102,"status":"ok","timestamp":1606854704480,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"sdOno854xcFM","outputId":"d1a91737-5cef-42f4-f9cc-f6c6fdfa4acc"},"outputs":[{"data":{"text/plain":["0.13333333333333333"]},"execution_count":112,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"awfIV9pZxcFM"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"3Km95QOvxcFM"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"4HGGgdeIxcFM"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oaYNByAsxcFM"},"outputs":[],"source":["hm_linear_svm_ro = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":191085,"status":"ok","timestamp":1606854728498,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"G63hlZ4kxcFM","outputId":"dd7cebed-b713-41aa-85ab-9e9bbbc6648d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4791666666666667\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:   19.7s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 14.782608695652177% relative to the initial model\n"]}],"source":["hm_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":191074,"status":"ok","timestamp":1606854728499,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"PpMulicsxcFM","outputId":"1bcd6635-3a80-4835-9ba2-1cfe576cc072"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":116,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gtkUY73bxcFM"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"4ad7FRzfxcFM"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5Pi0us0CxcFM"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":192828,"status":"ok","timestamp":1606854730289,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"P2ReLTMmxcFM","outputId":"cc85b5a1-74f5-4335-fd3f-f51a2d6fad47"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.49166667, 0.23333333])"]},"execution_count":118,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":192817,"status":"ok","timestamp":1606854730290,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zQe_P4vtxcFM","outputId":"5c70e7b5-0a67-4bb7-f431-e74ee8320b91"},"outputs":[{"data":{"text/plain":["0.41250000000000003"]},"execution_count":119,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-fLvGqsBxcFM"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":194377,"status":"ok","timestamp":1606854731874,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vH6BJYeCxcFM","outputId":"751933aa-56e4-4d66-87c9-50744e0a60fc"},"outputs":[{"data":{"text/plain":["array([0.15833333, 0.18333333, 0.15833333, 0.125     ])"]},"execution_count":121,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":194365,"status":"ok","timestamp":1606854731874,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"iWKygSBFxcFM","outputId":"cfb621e6-f4db-4280-c3b4-a35651845901"},"outputs":[{"data":{"text/plain":["0.15625"]},"execution_count":122,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H89-Ubk1xcFM"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jystqc68xcFM"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":198372,"status":"ok","timestamp":1606854735913,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"me7J6W3jxcFM","outputId":"a8d15332-d2de-4ec9-f1d8-4839754e29a8"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":124,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":198362,"status":"ok","timestamp":1606854735913,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"b4GFz5MExcFM","outputId":"99a85af8-369e-46bb-da59-9822b7b0e165"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":125,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xuQVuhiQxcFM"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":202463,"status":"ok","timestamp":1606854740036,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"laTiM7yyxcFM","outputId":"b09bf71a-e0c5-4a7e-c45f-5b56aebb59e0"},"outputs":[{"data":{"text/plain":["array([0.08333333, 0.11666667, 0.05      , 0.11666667, 0.08333333,\n","       0.08333333, 0.06666667, 0.03333333])"]},"execution_count":127,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":202452,"status":"ok","timestamp":1606854740036,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5YEpQA8MxcFM","outputId":"dd586d91-1807-4f98-f3e0-69d7d0a3cffb"},"outputs":[{"data":{"text/plain":["0.07916666666666666"]},"execution_count":128,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e9j2dV-0xcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"In9JIEELxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QBdhZ-WaxcFN"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"M_bDhah3xcFN"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"SB0mgXXvxcFN"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BqKnbg_JxcFN"},"outputs":[],"source":["hm_linear_svm_ros = hyper_model(model_name='linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":226466,"status":"ok","timestamp":1606854764108,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DdLP80jqxcFN","outputId":"83c882b3-2fd8-432e-b17e-aaa14eb91c71"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.09166666666666667\n","Fitting 8 folds for each of 5 candidates, totalling 40 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done  40 out of  40 | elapsed:   19.5s finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.13958333333333334\n","Improvement of 52.27272727272726% relative to the initial model\n"]}],"source":["hm_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":226456,"status":"ok","timestamp":1606854764109,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"O-pGzTR8xcFN","outputId":"3ff3343c-324f-4d5e-9d58-be6dfcb69110"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":132,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mm_UBr-JxcFN"},"outputs":[],"source":["\n"]},{"cell_type":"markdown","metadata":{"id":"37SLrvJMxcFN"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UOiflGaYxcFN"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":228322,"status":"ok","timestamp":1606854766008,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"uSGfcU8QxcFN","outputId":"027314fb-ff15-4310-aa46-3559a57ab051"},"outputs":[{"data":{"text/plain":["array([0.49166667, 0.50833333, 0.48333333, 0.53333333])"]},"execution_count":134,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":228313,"status":"ok","timestamp":1606854766008,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xoi4Bd7NxcFN","outputId":"a3b6a543-72ef-4ff7-8728-73e7f3c9ceab"},"outputs":[{"data":{"text/plain":["0.5041666666666667"]},"execution_count":135,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wNJLv2rYxcFN"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":229543,"status":"ok","timestamp":1606854767262,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"V7rgWJWOxcFN","outputId":"bf6cd1f2-27fb-49e0-ebd0-2c0f4691a9c4"},"outputs":[{"data":{"text/plain":["array([0.225     , 0.23333333, 0.19166667, 0.16666667])"]},"execution_count":137,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":229533,"status":"ok","timestamp":1606854767263,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VDh6BucmxcFN","outputId":"5b0867b5-e4c6-4035-c2dd-40b20e50c564"},"outputs":[{"data":{"text/plain":["0.20416666666666666"]},"execution_count":138,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HUaF3tqAxcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EuutIIFXxcFN"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":233441,"status":"ok","timestamp":1606854771203,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RAi3g167xcFN","outputId":"40c4f1b7-f2dd-442f-f8d1-51aebf8e93b1"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.48333333, 0.46666667, 0.4       , 0.45      ,\n","       0.53333333, 0.56666667, 0.5       ])"]},"execution_count":140,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":233431,"status":"ok","timestamp":1606854771204,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"qRf2KlHuxcFN","outputId":"a8f27d70-bbdc-4d1e-d497-b1be686a55f6"},"outputs":[{"data":{"text/plain":["0.48541666666666666"]},"execution_count":141,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vc_-n4csxcFN"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":237880,"status":"ok","timestamp":1606854775675,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Jln-g212xcFN","outputId":"1fe3e5f0-28bd-4e56-ea10-df1dcea8f91a"},"outputs":[{"data":{"text/plain":["array([0.11666667, 0.11666667, 0.1       , 0.2       , 0.16666667,\n","       0.1       , 0.16666667, 0.08333333])"]},"execution_count":143,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":237870,"status":"ok","timestamp":1606854775676,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tlOVYKDCxcFN","outputId":"7bd79e59-75d6-434a-9c18-49d353c8b8d6"},"outputs":[{"data":{"text/plain":["0.13125"]},"execution_count":144,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VIaGLGWLxcFN"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"i80BGb95xcFN"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eo8YKpR5ThY_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oqugS205TiTt"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"qeEgWCblzQnP"},"source":["## Non Linear Support Vector Machine"]},{"cell_type":"markdown","metadata":{"id":"5GSv6mzky38n"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"7oULTVbEPi_U"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"0Cne7taDXqB-"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dq07br9mPi_U"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":276216,"status":"ok","timestamp":1606854814087,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1V8keujMPi_U","outputId":"4936843e-15fb-441f-d449-0219c1acadd6"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4395833333333333\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5541666666666667\n","Improvement of 26.066350710900483% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:   38.3s finished\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":276207,"status":"ok","timestamp":1606854814089,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0gD5AkJMPi_U","outputId":"a0b09083-abfa-4795-c955-aca00aa15753"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":148,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XxxGNCDDPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"R-4wu13DXt7S"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2zxO36oNXt7S"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":276982,"status":"ok","timestamp":1606854814904,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fsWhol8YXt7S","outputId":"b1c7c8ff-ca63-4fb2-8be1-53eb32a225e5"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.38333333, 0.475     , 0.45      ])"]},"execution_count":150,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":276971,"status":"ok","timestamp":1606854814904,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"ymPirDLmXt7S","outputId":"80317bf0-3315-42bb-dad7-1ce027e558b8"},"outputs":[{"data":{"text/plain":["0.4395833333333333"]},"execution_count":151,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"T0ta4ssHXt7S"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":277786,"status":"ok","timestamp":1606854815740,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1RjKwn0pXt7S","outputId":"5b436d73-d831-4b5d-8c4b-2c90d2564060"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.34166667, 0.29166667, 0.35833333])"]},"execution_count":153,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":277775,"status":"ok","timestamp":1606854815740,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CIBOvXeDXt7S","outputId":"ead27c15-408a-41c2-b023-9ac9394db28f"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":154,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1aTV6PZfXt7S"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NNnTNmeiXt7S"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":278238,"status":"ok","timestamp":1606854816237,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"XPMCwPjQXt7S","outputId":"1a36c748-5c89-4965-cd0f-4bae11509482"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.46666667, 0.31666667, 0.4       , 0.36666667,\n","       0.46666667, 0.56666667, 0.51666667])"]},"execution_count":156,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":278227,"status":"ok","timestamp":1606854816238,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DRVwsyQLXt7S","outputId":"a45d84e6-9981-4ffd-d004-428931bd7a72"},"outputs":[{"data":{"text/plain":["0.44375"]},"execution_count":157,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vinSE87gXt7S"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":280037,"status":"ok","timestamp":1606854818071,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xOuNRJLdXt7S","outputId":"892a1544-9b34-44db-94dd-316bbf23ebbe"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.35      , 0.33333333, 0.35      , 0.3       ,\n","       0.4       , 0.4       , 0.28333333])"]},"execution_count":159,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":280025,"status":"ok","timestamp":1606854818071,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"d4xnl7FcXt7S","outputId":"30c200a0-3ed3-412f-98b3-ac2f3680fac8"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":160,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eFy5EJT0Xt7S"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l0KvHb0QXogu"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0Zs6BKtdPi_U"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"8EAYpz-HXvUg"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CL0ybWLcPi_U"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":318803,"status":"ok","timestamp":1606854856898,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IktxzifQPi_U","outputId":"ee3af0ea-a1bc-4120-e1b6-4db87cc7ccde"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.35625\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 54.385964912280706% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:   38.6s finished\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":318793,"status":"ok","timestamp":1606854856899,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_P-nox5XPi_U","outputId":"e4ea763c-dfc5-43d1-a462-b7d326f71f09"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":164,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tWvOHDWQPi_U"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"0198Uz5fXzwU"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RyahliyLXzwU"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":319235,"status":"ok","timestamp":1606854857376,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zehjkRXnXzwU","outputId":"bc8543ec-7bb4-4a1e-9a02-a3f39d0b912c"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.38333333, 0.475     , 0.45      ])"]},"execution_count":166,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":319225,"status":"ok","timestamp":1606854857377,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WuJ2osi6XzwU","outputId":"592d3a0c-8199-4139-b033-a578816315db"},"outputs":[{"data":{"text/plain":["0.4395833333333333"]},"execution_count":167,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ci44W-T2XzwU"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":320476,"status":"ok","timestamp":1606854858649,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"vK4IjAABXzwU","outputId":"426aa40e-a184-47d4-ecf6-f5e8a1704e1c"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.34166667, 0.29166667, 0.35833333])"]},"execution_count":169,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":320465,"status":"ok","timestamp":1606854858649,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"xhWy-ohdXzwU","outputId":"10710574-62e5-4375-e616-cb4099746306"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":170,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CF7JcIMjXzwU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2oIQ_WXQXzwU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":321142,"status":"ok","timestamp":1606854859359,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"UzV889JxXzwU","outputId":"cbc967a7-a2a2-4c48-94c2-82f4560e144e"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.46666667, 0.31666667, 0.4       , 0.36666667,\n","       0.46666667, 0.56666667, 0.51666667])"]},"execution_count":172,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":321131,"status":"ok","timestamp":1606854859359,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yL2hPRGYXzwU","outputId":"3406a723-acb5-48ac-9082-8385e0b13702"},"outputs":[{"data":{"text/plain":["0.44375"]},"execution_count":173,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-66NgtuSXzwU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":322689,"status":"ok","timestamp":1606854860939,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WuB0T_n2XzwU","outputId":"9ee3a0e5-c73c-47d8-9adb-06f1f5975cb0"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.35      , 0.33333333, 0.35      , 0.3       ,\n","       0.4       , 0.4       , 0.28333333])"]},"execution_count":175,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":322678,"status":"ok","timestamp":1606854860939,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tKTaDJrDXzwU","outputId":"ae42d9dc-c959-4321-b51c-5f5088686526"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":176,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cn3af9g-XzwU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uDs9TYKhPi_U"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"egAIdkvWX28i"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TC4Zs4C_Pi_U"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":419075,"status":"ok","timestamp":1606854957369,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"yYH5CASnPi_U","outputId":"c2da991a-2790-4ebd-8a15-b468c030d083"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.44375\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 23.943661971831002% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  1.6min finished\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":419068,"status":"ok","timestamp":1606854957373,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Gew_wB7pPi_U","outputId":"91a415af-c6d1-42fe-f255-8a49e7964432"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":180,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"unaQIpFcPi_V"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"nwAyHju5X6vP"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZPOKqFjRX6vP"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":419631,"status":"ok","timestamp":1606854957970,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fupMQc6EX6vP","outputId":"9f450fd7-622a-4910-9238-0ea0afac1d48"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.38333333, 0.475     , 0.45      ])"]},"execution_count":182,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":419620,"status":"ok","timestamp":1606854957971,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"M1CThpvVX6vP","outputId":"c2bad37b-e786-4c35-88a6-b3c5a02ee04f"},"outputs":[{"data":{"text/plain":["0.4395833333333333"]},"execution_count":183,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9_gWEv7sX6vP"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":420041,"status":"ok","timestamp":1606854958414,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"fiy7W5ffX6vP","outputId":"3ee229f1-4ef6-4eca-9ad7-33b28362a4f7"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.34166667, 0.29166667, 0.35833333])"]},"execution_count":185,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":420030,"status":"ok","timestamp":1606854958414,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"lkjknhMeX6vP","outputId":"962e5967-941d-4912-d1e7-2563c0fc10b2"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":186,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FTXiBdQLX6vP"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"t1r-sdlxX6vP"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":421428,"status":"ok","timestamp":1606854959846,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"CWGMzyK-X6vP","outputId":"f8874d84-0c51-44fd-bd1e-b86540f1b843"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.46666667, 0.31666667, 0.4       , 0.36666667,\n","       0.46666667, 0.56666667, 0.51666667])"]},"execution_count":188,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":421417,"status":"ok","timestamp":1606854959846,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"H0zLw18oX6vP","outputId":"5d1ee8d9-0e8b-4585-dc8a-f2a83b6b3342"},"outputs":[{"data":{"text/plain":["0.44375"]},"execution_count":189,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A8T5rsMmX6vP"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":422504,"status":"ok","timestamp":1606854960955,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"M_t4UF1DX6vP","outputId":"e420de28-2e72-4f69-ef2a-ec837c5d74d2"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.35      , 0.33333333, 0.35      , 0.3       ,\n","       0.4       , 0.4       , 0.28333333])"]},"execution_count":191,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":422493,"status":"ok","timestamp":1606854960955,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"0fJTTwT7X6vP","outputId":"84aa8deb-784a-4968-8911-6ddd60ddf80b"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":192,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1jmvoITgX6vP"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"9GrSc9C_Pi_V"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"kD81hURuX8Gq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VvTPL3JlPi_V"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":520523,"status":"ok","timestamp":1606855059018,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VrRmVRDrPi_V","outputId":"0ff37e1d-5744-452f-9589-e8255f72f75c"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.35625\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5708333333333334\n","Improvement of 60.233918128654985% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  1.6min finished\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":520514,"status":"ok","timestamp":1606855059020,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"T_4U6bROPi_V","outputId":"4932f57a-6203-41d9-ae33-ebb99b73ecee"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":196,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jvvT0I2zA-tR"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"NBFCHmpSX_fT"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FpOCGtljX_fT"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":520926,"status":"ok","timestamp":1606855059464,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7Qyp61qCX_fT","outputId":"a5eb837a-3d87-49fb-e54f-a9f479b3a14e"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.38333333, 0.475     , 0.45      ])"]},"execution_count":198,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":520917,"status":"ok","timestamp":1606855059465,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"aIXn6G0DX_fT","outputId":"4ac9a96d-38eb-476b-adfb-9ea4c64fd4f4"},"outputs":[{"data":{"text/plain":["0.4395833333333333"]},"execution_count":199,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Cd88yjZ2X_fT"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":521786,"status":"ok","timestamp":1606855060355,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TBGK1CCwX_fT","outputId":"35bdccf4-dda4-4322-8749-14308b5e2df9"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.34166667, 0.29166667, 0.35833333])"]},"execution_count":201,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":521775,"status":"ok","timestamp":1606855060356,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"YrWrvhkgX_fT","outputId":"21000230-c1bd-42b3-cbfa-e58e4c7627a5"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":202,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AxSU-XfPX_fU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AmBIkKpYX_fU"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":523149,"status":"ok","timestamp":1606855061766,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"_V5IbN68X_fU","outputId":"72136e1c-c4bb-488b-a3f9-deade960eb99"},"outputs":[{"data":{"text/plain":["array([0.45      , 0.46666667, 0.31666667, 0.4       , 0.36666667,\n","       0.46666667, 0.56666667, 0.51666667])"]},"execution_count":204,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":523137,"status":"ok","timestamp":1606855061766,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"TWaCN8l7X_fU","outputId":"345fc192-9e19-4622-9319-369604e2caad"},"outputs":[{"data":{"text/plain":["0.44375"]},"execution_count":205,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"syrzAL9rX_fU"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":523691,"status":"ok","timestamp":1606855062345,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"NsiBn2glX_fU","outputId":"40a16954-6891-4d3e-fbdf-bed3b0f3c8b2"},"outputs":[{"data":{"text/plain":["array([0.43333333, 0.35      , 0.33333333, 0.35      , 0.3       ,\n","       0.4       , 0.4       , 0.28333333])"]},"execution_count":207,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":523681,"status":"ok","timestamp":1606855062346,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"LtMnsPToX_fU","outputId":"1f8fc728-cd66-468e-fc8a-2ce92889bf01"},"outputs":[{"data":{"text/plain":["0.35625"]},"execution_count":208,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0DqFlfKnX_fU"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"8XqHy9Y-zFbi"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"7JuJVcluzKap"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"nDanBmu2zKap"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"vXdh3OxCzKap"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pMbR3zyvzKap"},"outputs":[],"source":["hm_non_linear_svm_to = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563022,"status":"ok","timestamp":1606855101720,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"RQK687eXzKap","outputId":"cd5d4f2a-e842-4e59-ab0d-6579dfa12bd2"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.4395833333333333\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5541666666666667\n","Improvement of 26.066350710900483% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:   38.3s finished\n"]}],"source":["hm_non_linear_svm_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":563013,"status":"ok","timestamp":1606855101721,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"1GyuhQOqzKap","outputId":"d6459558-7b31-4c50-b588-88294774069c"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":212,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hsydl9nEzKap"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"dZufsYMWzKap"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gYJcPYkvzKap"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":562989,"status":"ok","timestamp":1606855101730,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"zwggFtqFzKap","outputId":"f0c4832b-4845-495c-821d-3d446d2eb0e3"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.4       , 0.50833333, 0.75833333])"]},"execution_count":214,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":562978,"status":"ok","timestamp":1606855101731,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"170biW6UzKap","outputId":"db4e48f0-dfe8-4513-bd80-f588feaedb46"},"outputs":[{"data":{"text/plain":["0.5541666666666667"]},"execution_count":215,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BuJajI8CzKap"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563897,"status":"ok","timestamp":1606855102672,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"y9sBxOW3zKap","outputId":"708685ed-4383-42c4-916d-21dc7dc33aeb"},"outputs":[{"data":{"text/plain":["array([0.50833333, 0.53333333, 0.55833333, 0.525     ])"]},"execution_count":217,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563887,"status":"ok","timestamp":1606855102673,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Tu78PjDEzKap","outputId":"2444ef58-d0b5-46c4-a398-b93106d25b97"},"outputs":[{"data":{"text/plain":["0.53125"]},"execution_count":218,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p5O7LCZUzKaq"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"170jqf1TzKaq"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563855,"status":"ok","timestamp":1606855102674,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"4TBwzEPazKaq","outputId":"781f71d4-0a48-490f-fad1-5be8197a23d6"},"outputs":[{"data":{"text/plain":["array([0.66666667, 0.46666667, 0.38333333, 0.45      , 0.48333333,\n","       0.51666667, 0.61666667, 0.65      ])"]},"execution_count":220,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563845,"status":"ok","timestamp":1606855102675,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"AHSEfnC1zKaq","outputId":"90bc5930-7a16-4885-8ac3-af7034818874"},"outputs":[{"data":{"text/plain":["0.5291666666666667"]},"execution_count":221,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ObGDJizAzKaq"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563826,"status":"ok","timestamp":1606855102678,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"j_N2tqWwzKaq","outputId":"ecf2638c-8c2a-4e82-b586-f25d8482099c"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.46666667, 0.5       , 0.55      , 0.55      ,\n","       0.56666667, 0.55      , 0.51666667])"]},"execution_count":223,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":563815,"status":"ok","timestamp":1606855102679,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IASR2chPzKaq","outputId":"143d1cf5-f54d-4b20-a30e-bf38825d2dc3"},"outputs":[{"data":{"text/plain":["0.53125"]},"execution_count":224,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DgeJt--bzKaq"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TD-U3cR1zKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ARh3tG3HzKaq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"wN2hsHGBzKaq"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"skUAhYgczKaq"},"outputs":[],"source":["hm_non_linear_svm_tos = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":602633,"status":"ok","timestamp":1606855141541,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"cwJeDc5FzKaq","outputId":"774c5e40-3c6d-4ae1-c847-bf4d85103f2d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.35625\n","Fitting 4 folds for each of 75 candidates, totalling 300 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 54.385964912280706% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 300 out of 300 | elapsed:   38.7s finished\n"]}],"source":["hm_non_linear_svm_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":602624,"status":"ok","timestamp":1606855141543,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"7T6L3cEMzKaq","outputId":"eabf394d-5a32-4664-d3cb-9dfd8360e1c7"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":228,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s-0TYEKRzKaq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Q-8Wu0mFzKaq"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1JuAwv7xzKar"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":603246,"status":"ok","timestamp":1606855142198,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"3vVCBJB-zKar","outputId":"4cf2f3e1-c121-4a9a-e91b-f3bb1192277a"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":230,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":603236,"status":"ok","timestamp":1606855142199,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VMeANNU5zKar","outputId":"c67f0704-2a50-43be-e55b-7448a8031a19"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":231,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S1WpU5CMzKar"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5890,"status":"ok","timestamp":1606855181054,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"5TeGAl1HzKar","outputId":"ab69267f-9d91-4ea8-8812-647083457761"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.61666667, 0.53333333])"]},"execution_count":234,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5880,"status":"ok","timestamp":1606855181055,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"6YnwjHF0zKar","outputId":"c04ea854-a7ae-4b1a-86ad-69362ab6b375"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":235,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lq8oWJXFzKar"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_BRFekOUzKar"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7041,"status":"ok","timestamp":1606855182251,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"toTnrmmlzKar","outputId":"e516fdac-5533-49cd-ca9a-bc5f4a070677"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":237,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7031,"status":"ok","timestamp":1606855182252,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"kKc0nDGCzKar","outputId":"f484afeb-3ef6-4a87-a716-169d32ab12a1"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":238,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OOMuvs-pzKar"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8374,"status":"ok","timestamp":1606855183617,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"wjRpb8NBzKar","outputId":"dfa2cdc7-cc00-4846-e5c0-50101b2056a5"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.5       , 0.56666667, 0.63333333,\n","       0.6       , 0.53333333, 0.53333333])"]},"execution_count":240,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8365,"status":"ok","timestamp":1606855183618,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"r53hIRRXzKar","outputId":"76c5f582-0e0a-4966-b3b7-59ae36f3ecd4"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":241,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VRxmvc-wzKar"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"LL4QioxhzKar"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dsa5s6NCzKar"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YhmSCPQKzKar"},"outputs":[],"source":["hm_non_linear_svm_ro = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":105055,"status":"ok","timestamp":1606855280340,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"x3s1ZBelzKas","outputId":"1dddf5a2-971e-44c4-966d-f6d99a4c9d3c"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.44375\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.55\n","Improvement of 23.943661971831002% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  1.6min finished\n"]}],"source":["hm_non_linear_svm_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":105045,"status":"ok","timestamp":1606855280341,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"-_TCEZH-zKas","outputId":"ff8dd8fc-a231-41ee-a72c-7c040c2dd2bb"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":245,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oSYzxqW7zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"8vgsOGsMzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YROEJvQ5zKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":105849,"status":"ok","timestamp":1606855281182,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"VAcVTmDZzKas","outputId":"58ebda7c-7c5d-4e0f-c141-2fc0f98afc13"},"outputs":[{"data":{"text/plain":["array([0.55833333, 0.36666667, 0.50833333, 0.23333333])"]},"execution_count":247,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":105839,"status":"ok","timestamp":1606855281182,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"JTR8dtFxzKas","outputId":"cdc40958-225a-4395-8004-37baf8217024"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":248,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AphSBh3YzKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":106165,"status":"ok","timestamp":1606855281533,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"c1VcemIGzKas","outputId":"636715a8-33bf-4471-8cb0-6f9445bde099"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.53333333, 0.61666667, 0.53333333])"]},"execution_count":250,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":106156,"status":"ok","timestamp":1606855281534,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Mw8VKeX8zKas","outputId":"c838f463-77f4-4c07-f712-6e0a4d0f1f6a"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":251,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F81q7WTjzKas"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WJ_jCgPzzKas"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":107329,"status":"ok","timestamp":1606855282738,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"DQYfT2OlzKas","outputId":"7fecc672-c18d-457a-b91d-05876b33dfe0"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.48333333, 0.35      , 0.38333333, 0.5       ,\n","       0.51666667, 0.8       , 0.73333333])"]},"execution_count":253,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":107319,"status":"ok","timestamp":1606855282739,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Tc_SstgszKas","outputId":"b8da47bf-1cae-4be1-a799-2c63a2b91c9d"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":254,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IoF9LLnOzKas"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":108432,"status":"ok","timestamp":1606855283875,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"a1wNxq3PzKas","outputId":"62bf09ae-d0e0-4b2e-d8c6-cadd23eddc09"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.48333333, 0.5       , 0.56666667, 0.63333333,\n","       0.6       , 0.53333333, 0.53333333])"]},"execution_count":256,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":108423,"status":"ok","timestamp":1606855283876,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"N9f3ydSCzKas","outputId":"08d235e7-70c8-4ab3-a733-7dc620baa2bf"},"outputs":[{"data":{"text/plain":["0.55"]},"execution_count":257,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F0bMKlgozKas"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"RSJKARRAzKas"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"mBL6Eax3zKas"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iVOzO1_-zKas"},"outputs":[],"source":["hm_non_linear_svm_ros = hyper_model(model_name='non_linear_svm',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":206810,"status":"ok","timestamp":1606855382295,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"Z765IlZJzKas","outputId":"0149cd68-cd87-42c6-ebea-8e0c9429ffa5"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.35625\n","Fitting 8 folds for each of 75 candidates, totalling 600 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.5708333333333334\n","Improvement of 60.233918128654985% relative to the initial model\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Done 600 out of 600 | elapsed:  1.6min finished\n"]}],"source":["hm_non_linear_svm_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":206802,"status":"ok","timestamp":1606855382296,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"S3UewluXzKas","outputId":"118585f9-df40-4dee-c595-2cd68b0706c3"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":261,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["hm_non_linear_svm_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_-LO0Fa5zKas"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FY_4P1stzKas"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JtDObYhuzKas"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":206773,"status":"ok","timestamp":1606855382298,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"hs5e3gDezKas","outputId":"6f060746-dc31-460c-b3b0-acc5bb8afa5c"},"outputs":[{"data":{"text/plain":["array([0.49166667, 0.54166667, 0.49166667, 0.51666667])"]},"execution_count":263,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":206762,"status":"ok","timestamp":1606855382298,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"V3t-_ciTzKas","outputId":"3e0bf4e9-6f44-4fa3-83bf-3329f5d3d3c0"},"outputs":[{"data":{"text/plain":["0.5104166666666666"]},"execution_count":264,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Vj9bEfC_zKas"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":207113,"status":"ok","timestamp":1606855382670,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"GrtGNjnnzKat","outputId":"28f37339-776c-45aa-fb6d-f425c98a42f5"},"outputs":[{"data":{"text/plain":["array([0.54166667, 0.45833333, 0.58333333, 0.575     ])"]},"execution_count":266,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":207103,"status":"ok","timestamp":1606855382671,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"tFlJd6qAzKat","outputId":"8661f55d-8b4a-47b8-ecde-944bd807db3d"},"outputs":[{"data":{"text/plain":["0.5395833333333333"]},"execution_count":267,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VdR_va-kzKat"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mbAbJmqlzKat"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":207454,"status":"ok","timestamp":1606855383054,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"IEV9F0VPzKat","outputId":"2dc3ded9-d308-4148-daf6-fd11779acc42"},"outputs":[{"data":{"text/plain":["array([0.53333333, 0.5       , 0.53333333, 0.5       , 0.51666667,\n","       0.46666667, 0.45      , 0.48333333])"]},"execution_count":269,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":207444,"status":"ok","timestamp":1606855383055,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"j9nKepwezKat","outputId":"e0a200b1-ab3e-4d65-df17-1915429f4c8a"},"outputs":[{"data":{"text/plain":["0.4979166666666667"]},"execution_count":270,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_GK6yAx_zKat"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_non_linear_svm_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":208251,"status":"ok","timestamp":1606855383888,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"d05_H12ezKat","outputId":"f39b4b2c-94f6-435a-b4f0-5e08f711e7b1"},"outputs":[{"data":{"text/plain":["array([0.65      , 0.55      , 0.46666667, 0.5       , 0.66666667,\n","       0.53333333, 0.65      , 0.55      ])"]},"execution_count":272,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":208240,"status":"ok","timestamp":1606855383888,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"QJaiqkrezKat","outputId":"eecd9246-7323-4156-c6d3-55b1be3f7bd1"},"outputs":[{"data":{"text/plain":["0.5708333333333334"]},"execution_count":273,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KKwvhkyMzKat"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"gh0gtRO-D2F-"},"source":["## Random Forest Classifier"]},{"cell_type":"markdown","metadata":{"id":"8cap-uouzQCQ"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jr2mEagmPuxy"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"ZGtZPgTLYETt"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"le2W3NO8Puxy"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":276,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1579938,"status":"ok","timestamp":1606866169454,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"gmkK8kiPPuxy"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.46249999999999997\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 179.5min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.48125000000000007\n","Improvement of 4.054054054054076% relative to the initial model\n"]}],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":277,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":47,"status":"ok","timestamp":1606866169457,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"WXLhC5g3Puxy"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":277,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27,"status":"ok","timestamp":1606866169460,"user":{"displayName":"Zakaria Bekkar","photoUrl":"","userId":"11013878220604787588"},"user_tz":-60},"id":"OSua_O1KPuxy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"uMyaSHdOYGtk"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cWwrGaApYGtk"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cJUw5awvYGtk"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.41666667, 0.53333333, 0.41666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7JkBGvC5YGtk"},"outputs":[{"data":{"text/plain":["0.4708333333333334"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Xz6kWFe4YGtk"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"EXee_GspYGtk"},"outputs":[{"data":{"text/plain":["array([0.46666667, 0.40833333, 0.375     , 0.41666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"h7X0yp_8YGtk"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"VDD1dk-_YGtk"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jmXtWQZ_YGtk"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NRc_AIPLYGtk"},"outputs":[{"data":{"text/plain":["array([0.63333333, 0.43333333, 0.4       , 0.43333333, 0.53333333,\n","       0.58333333, 0.61666667, 0.51666667])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"s1ZyRf3iYGtk"},"outputs":[{"data":{"text/plain":["0.51875"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"6wY5DeGLYGtk"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uraK4ZFyYGtk"},"outputs":[{"data":{"text/plain":["array([0.5       , 0.43333333, 0.33333333, 0.46666667, 0.51666667,\n","       0.36666667, 0.38333333, 0.33333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"rlDNMoS2YGtk"},"outputs":[{"data":{"text/plain":["0.4166666666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Pi53d5suYGtk"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"E57mYUJwPuxz"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dm3nwjv8YIB7"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uhgJDujzPuxz"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7HXXuw1YPuxz"},"outputs":[{"name":"stdout","output_type":"stream","text":["Initial Model with Stock Params Score : 0.40625\n","Fitting 4 folds for each of 300 candidates, totalling 1200 fits\n"]},{"name":"stderr","output_type":"stream","text":["[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n","[Parallel(n_jobs=1)]: Done 1200 out of 1200 | elapsed: 167.8min finished\n"]},{"name":"stdout","output_type":"stream","text":["Random HP Search Best Model Score : 0.4395833333333333\n","Improvement of 8.205128205128204% relative to the initial model\n"]}],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SQT2v3dWPuxz"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eModel Iteration\u003c/th\u003e\n","      \u003cth\u003eScore\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["Empty DataFrame\n","Columns: [Model Iteration, Score]\n","Index: []"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZZPh5InUPuxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"fgncv-YAYKgH"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uQC7n2_9YKgH"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZOyWUPf7YKgH"},"outputs":[{"data":{"text/plain":["array([0.51666667, 0.35833333, 0.55833333, 0.35833333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"PNiZaiTAYKgH"},"outputs":[{"data":{"text/plain":["0.4479166666666667"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uMEfoU2_YKgH"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"SImpkdfFYKgH"},"outputs":[{"data":{"text/plain":["array([0.41666667, 0.46666667, 0.40833333, 0.4       ])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"8pwpVigDYKgH"},"outputs":[{"data":{"text/plain":["0.4229166666666666"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Z-fMf-cOYKgH"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ySiVyU7sYKgH"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"RqIaYT5rYKgH"},"outputs":[{"data":{"text/plain":["array([0.55      , 0.4       , 0.35      , 0.43333333, 0.51666667,\n","       0.4       , 0.58333333, 0.48333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gvbv0PiHYKgH"},"outputs":[{"data":{"text/plain":["0.46458333333333335"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"p6Ku1ByOYKgH"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dY3402jGYKgH"},"outputs":[{"data":{"text/plain":["array([0.48333333, 0.48333333, 0.36666667, 0.43333333, 0.45      ,\n","       0.46666667, 0.43333333, 0.28333333])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wregmdqtYKgI"},"outputs":[{"data":{"text/plain":["0.425"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"fyJpUwLIYKgI"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Tg_rwd0APuxz"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"FSZ6dmiZYLgS"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"39lY7LhiPuxz"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NOqOwG1nPuxz"},"outputs":[],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3PmUdS5nPuxz"},"outputs":[],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MN42Rb16Puxz"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"F_F96mTXYOPF"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"H6IzjxLBYOPF"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4bWY8XZXYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"62f0GR1bYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8g0yaA4qYOPF"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uAdBpkk1YOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zMfVwgjNYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zGUXp9auYOPF"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7FB4DfFYOPF"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dSwDndEiYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fGLMhla2YOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lZMclYLSYOPF"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vk3ptRjWYOPF"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qkV7RDrQYOPF"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IvwQ0DcnYOPF"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"USGMYRvkPuxz"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"HvXfbULIYP0S"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IvpM4efCPuxz"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AosKXbMnPuxz"},"outputs":[],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Uo1epUM6Puxz"},"outputs":[],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LEbVr7kID3lP"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Z3pVdFRIYS_Y"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O1mSEfhvYS_Y"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QcLc93iFYS_Y"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sKcAejjvYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mQ_K8f1GYS_Z"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Ni0XQ4MYS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"14dpGt4HYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SlABUIa1YS_Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XcqEawTMYS_Z"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2sVRpDV0YS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WUapXFgsYS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"njxWLC9cYS_Z"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fOjDRVdiYS_Z"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bN5MWN21YS_Z"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zRMQjaF0YS_Z"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"ym_PcB2Bzhy5"},"source":["### Hyper_optimized Model"]},{"cell_type":"markdown","metadata":{"id":"gLRQegMuznEx"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"UYtPQW5lznEx"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"qzMbiN63znEx"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"brq7F45MznEx"},"outputs":[],"source":["hm_rf_to = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"deNrrmvfznEx"},"outputs":[],"source":["hm_rf_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DuwWXLzCznEx"},"outputs":[],"source":["hm_rf_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D_bWM63AznEx"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Dw0u6K5fznEx"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"r0bX_XinznEx"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jQQ7xE6FznEx"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q8uJkiSgznEx"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E_WvyhCkznEx"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gQ77McSEznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CrfcSLr_znEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EN0zehJcznEy"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JZd-GNejznEy"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1tuwbqxBznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2s555K_JznEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55Yt3JxVznEy"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e1uK8AAGznEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vdyH7L3-znEy"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"y1YxHwLWznEy"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Uft0d1hpznEy"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"87fHemV8znEy"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_D-7eBzUznEy"},"outputs":[],"source":["hm_rf_tos = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pUYCZWU8znEy"},"outputs":[],"source":["hm_rf_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_XH1O4gEznEy"},"outputs":[],"source":["hm_rf_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1ZpTLQHPznEy"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"gB5QZVGUznEy"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9DAVY-EmznEy"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dIUnOe4_znEy"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hen4_Lm3znEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hxs44I_mznEz"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ea6nyuG4znEz"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mr_8apUtznEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4MN-hf_WznEz"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D0WAxV0RznEz"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vbEylF0OznEz"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oynC3pGvznEz"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G6C-LGo7znEz"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NOAoGC48znE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"t63ca5zEznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VMZacJ-8znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"VElWFWnwznE0"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"oilXUTU9znE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OrpD379aznE0"},"outputs":[],"source":["hm_rf_ro = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GiGSxegJznE0"},"outputs":[],"source":["hm_rf_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"82SelhLDznE0"},"outputs":[],"source":["hm_rf_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jWj2VfvKznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"5N35S_S7znE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xa8-D0wpznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n2sVmxGdznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BpnIX_HjznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XPiy_g5oznE0"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"azSQOq8_znE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nOJk3jtxznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oX-bRxwfznE0"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f9IzvaKcznE0"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OjhZe7LAznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pOxeg5R-znE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FTtx-WTEznE0"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nm3LlijhznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"v8T7HCsRznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rCBj88t3znE0"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"IqZgkBX0znE0"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"3n_oeISCznE0"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kAiOndRWznE0"},"outputs":[],"source":["hm_rf_ros = hyper_model(model_name='random_forest_classifier',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D6mfl16pznE0"},"outputs":[],"source":["hm_rf_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zIsY4x87znE0"},"outputs":[],"source":["hm_rf_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wOu2FqUgznE0"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"FNSg-xESznE0"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JAhmZr0WznE0"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qFmuaHAOznE0"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0PRsJdEAznE0"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7J3uMDdGznE1"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-B3go7n2znE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yCuHLkI8znE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8hWa-aJmznE1"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5jVryRzDznE1"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9Z4ghTQ5znE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2Z3jNzMFznE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kraH7kCAznE1"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_rf_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hm7ymwVIznE1"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2KrfQG6vznE1"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BFyZ88sQznE1"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"oDNCpIIRD7gz"},"source":["## XGBoost Classifier"]},{"cell_type":"markdown","metadata":{"id":"j2tykuMUzur7"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"Jqg0nC9EQYwp"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"NfgwRfQvYb8t"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JsLW_31BQYwp"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bLodkCQ_QYwp"},"outputs":[],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RXLNwgL-QYwp"},"outputs":[],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yX4Rcv6hQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"g3KPsQ60YgQm"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RxzUgIo2YgQm"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rsR68pOvYgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7K1nRVGxYgQm"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qHeNXZf2YgQm"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RBCMfcXSYgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZRQ_1B9WYgQm"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hpacKrT3YgQm"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9EUD5_4AYgQm"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qDQJIez_YgQm"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z-mkU6E6YgQn"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1epIp3BNYgQn"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JoJL01LrYgQn"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"b6bf8HGHYgQn"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7y55nYzYYgQn"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Wh2r7aqvQYwq"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"PVhR6RhrYjM2"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hxo_eo5IQYwq"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wr7MB0OmQYwq"},"outputs":[],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LQKZiM2UQYwq"},"outputs":[],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_M0E115eQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"VDgQXkvRYogs"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VIkd9Qu2Yogs"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OvM-Fvb3Yogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iUk0ifWiYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PHgkhMkOYogs"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AHTtZ-8fYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z9HpvbW3Yogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"l5gaVnt6Yogs"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a3zuz6rrYogs"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cW3BKU5wYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ancDGUAjYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LFXL4CazYogs"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E4x6WM0SYogs"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8guPYbmSYogs"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tg598195Yogs"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AGYcf92VQYwq"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"Dk6vZ3MYYqf_"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RyTE9hZoQYwq"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gak6l1CXQYwq"},"outputs":[],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0rxn8OrlQYwq"},"outputs":[],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2BQXvF4KQYwq"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Io2FlXTHYt3K"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bI2jZQ7FYt3K"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"he-l5p-SYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uy8sRZwLYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A8qBvhgVYt3K"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-dgZAbImYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"m3bDkAUgYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dfF2wiF7Yt3K"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nLTq2VfkYt3K"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rC72bI8rYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"otMnNNBJYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iz34DmjlYt3K"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GWhpQqdCYt3K"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eljr226pYt3K"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BrLIGAzbYt3K"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"1O6rD9RLQYwq"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"RIQdan6pYvOX"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h5xA-bMkQYwq"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HOQsRZ_8QYwq"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aHQhKc--QYwq"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eseZcKAoJ__G"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"yLZCsP0eY1pQ"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7kKF19DY1pQ"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KWcoIkfCY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jnyaRlzsY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9NgKsUKFY1pQ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zueJZ-5YY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PP9j9jbzY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HwbywwFEY1pQ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zR8v_IjfY1pQ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O_LHVRPTY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SnRWttBqY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"S8E5UdVMY1pQ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.stock_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iSNXFoQYY1pQ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZDu2p-FDY1pQ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mliqJis0Y1pQ"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"uqoeswDMnyci"},"source":["### Hyper_optimized model"]},{"cell_type":"markdown","metadata":{"id":"JAynU_HI0PBY"},"source":["### Stock Model"]},{"cell_type":"markdown","metadata":{"id":"vgrN6ot60PBY"},"source":["#### *leave-one-task-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"O48noycN0PBY"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jDpeFtN80PBY"},"outputs":[],"source":["hm_xgb_to = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QnV8vzRh0PBY"},"outputs":[],"source":["hm_xgb_to.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HJzjh4ga0PBY"},"outputs":[],"source":["hm_xgb_to.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IE2N7VHD0PBY"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"YSJmQn2_0PBY"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B9OPp_sT0PBY"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7UF8Fh0r0PBY"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LHHSq-ze0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NU2etCDh0PBZ"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vzs-oG2Q0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Y5LNQ2Im0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zWt5dGZS0PBZ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"R9R3q8lF0PBZ"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uuD97M-r0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QWUwvFh-0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vEfN1lmG0PBZ"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_to.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0srZvvEV0PBZ"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ugLG-QXc0PBZ"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F6Eu517e0PBa"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"90su4wIc0PBa"},"source":["#### *leave-one-task-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"MJ4OmTw50PBa"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vJnjTODu0PBa"},"outputs":[],"source":["hm_xgb_tos = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-task-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NgcVhOm00PBa"},"outputs":[],"source":["hm_xgb_tos.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aEo-v5Sh0PBa"},"outputs":[],"source":["hm_xgb_tos.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z1CdrcR-0PBa"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"ss4KdVSQ0PBa"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SC7I2If40PBa"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6DhduOKd0PBa"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wDo0HinI0PBa"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6DDy143g0PBa"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o-nojkLm0PBa"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7W4s6Znt0PBa"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GbdcHa7A0PBb"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VzBE8UbC0PBb"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YFf8uy7j0PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s0Qet-vx0PBb"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G1pViHjW0PBb"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_tos.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HngwE8vS0PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wcsNamsp0PBb"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"480rGKpC0PBb"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"AbL7-dbc0PBb"},"source":["#### *leave-one-run-out* cross validation"]},{"cell_type":"markdown","metadata":{"id":"tnN0ijSs0PBb"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Tx_6QIyU0PBb"},"outputs":[],"source":["hm_xgb_ro = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iJrhBHOb0PBb"},"outputs":[],"source":["hm_xgb_ro.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IkkX2HRP0PBb"},"outputs":[],"source":["hm_xgb_ro.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tqiloYtR0PBb"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"Ropu3-tW0PBb"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"k0e0jkDZ0PBb"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bIeTuXR00PBb"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QSQ-6v460PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sj8Sha_x0PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4yc-2qz10PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"neS6G0C10PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7MXe6xRr0PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ct3yEerV0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iSfJeL230PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kojZ2SUM0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A_CcH-Ql0PBc"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ro.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Tn152nR0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tRSdT7Wx0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BLyOKveN0PBc"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Oq6LsPJw0PBc"},"source":["#### *leave-one-run-out-shuffled* cross validation"]},{"cell_type":"markdown","metadata":{"id":"eUk34NiQ0PBc"},"source":["##### Training"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7tnmONbH0PBc"},"outputs":[],"source":["hm_xgb_ros = hyper_model(model_name='xg_boost',\n","                            validation_approach = 'leave-one-run-out-shuffled',\n","                            X=X,\n","                            y=y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"45KiYK090PBc"},"outputs":[],"source":["hm_xgb_ros.fit()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G2tlj00W0PBc"},"outputs":[],"source":["hm_xgb_ros.all_models_perf"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AFtm3Nt40PBc"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"1X2T4ocQ0PBc"},"source":["##### Test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mOdemmuz0PBc"},"outputs":[],"source":["# leave-one-task-out test\n","cv = KFold(n_splits=4,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0IbOynDY0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mWi1QK860PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zz1UZyb90PBc"},"outputs":[],"source":["# leave-one-task-out-shuffed test\n","cv = KFold(n_splits=4,shuffle=True,random_state=42)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pc4AEhkH0PBc"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IZONW9Eg0PBc"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J0yH0nP80PBc"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f_XTLXOd0PBc"},"outputs":[],"source":["# leave-one-run-out test\n","cv = KFold(n_splits=8,shuffle=False)\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ejufwDue0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f0rOZsMN0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MLvMmLOC0PBd"},"outputs":[],"source":["# leave-one-run-out-shuffed test\n","cv = KFold(n_splits=8,shuffle=True,random_state=42)\n","\n","\n","\n","scores = cross_val_score(estimator=hm_xgb_ros.rd_model,cv=cv,X=X,y=y)\n","\n","mean_score = np.mean(scores)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tMpVsZzS0PBd"},"outputs":[],"source":["scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"13om3syO0PBd"},"outputs":[],"source":["mean_score"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9kuC5h0B0PBd"},"outputs":[],"source":["# other metrics + graphs\n","\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"55_ocXPFoH8Z"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Wzk61CezoI2E"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YUIZoGclSNMr"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"n4DB9nM9WS_I"},"outputs":[],"source":[""]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Machine Learning Computation - constant - vmPFC","provenance":[{"file_id":"1wV98L2ux7aXgacLTPCET4rezuozEXbNB","timestamp":1606814445981},{"file_id":"1FKzRRIZhxD6H3s8wEXUtnoGk7FOlng8M","timestamp":1605987313010},{"file_id":"https://github.com/fastai/fastai/blob/master/nbs/44_tutorial.tabular.ipynb","timestamp":1605742460785}],"version":""},"jupytext":{"split_at_heading":true},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"}},"nbformat":4,"nbformat_minor":0}